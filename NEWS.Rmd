---
output:
  md_document:
    variant: gfm # github flavored markdown
header-includes:
   - \usepackage{amsmath}
   - \usepackage{amssymb}
---
<!-- NEWS.md was auto-generated by NEWS.Rmd. Please DO NOT edit by hand!-->

# Changes in version `r RLumBuild::.get_pkg_version()` (`r Sys.Date()`)

**This package version requires R >= 4.4**

## New functions


## Removed functions and deprecations

* The functions `CW2pHMi()`, `CW2pLM()`, `CW2pLMi()` and `CW2pPMi()`
(deprecated since 1.0.0) have been removed, but their functionality remains
in the corresponding `convert_CW2*()` functions (#992).

* Functions `github_commits()`, `github_branches()` and `github_issues()` are
now deprecated and will be removed in a future release (#1026).

* Functions `is.RLum()`, `is.RLum.Data()`, `is.RLum.Data.Curve()`,
`is.RLum.Data.Spectrum()`, `is.RLum.Data.Image()`, `is.RLum.Analysis()` and
`is.RLum.Results()`,  and are now deprecated and will be removed in a future
release. The best way of testing whether an object is of a given type is by
using the `inherits()` function, as in `inherits(object, "RLum.Data.Curve")`
(#1034).

## Bugfixes and changes

### `analyse_Al2O3C_CrossTalk()`

* The function no longer crashes if `dose_point` is misspecified (#1073).

* The function no longer crashes when called on an `RLum.Analysis` object
rather than on a list of them (#1182).

### `analyse_baSAR()`

* The function no longer crashes if all objects in the input list are removed
because empty (#1041).

* The dose response curves are no longer overplotted when there are fewer than
1000 MCMC iterations (#1058).

### `analyse_FadingMeasurement()`

* The function no longer crashes when called on an object with missing
originator (#1130, #1154).

* When called with a list containing object with multiple classes, the message
produced reports the correct number of objects removed from the analysis
(#1132).

* The function no longer crashes if the normalisation term is zero, which
should never happen in real-life analyses, but it may occur if the input data
is somewhat malformed (#1144).

### `analyse_IRSAR.RF()`

* The function no longer crashes when `n.MC = NULL` is used with the `FIT`
method (#1055).

* The function has been optimized to be faster during the bootstrap phase for
the `SLIDE` and `VSLIDE` methods, with speed-ups in the region of 20% (#1210).

### `analyse_pIRIRSequence()`

* The names in the curves legend are no longer cut off (#1206).

* Labels and legend in the rejection criteria plot are better positioned and
no longer cut off (#1208).

* The dashed lines in the summarised DRC plot have been extended to reach the
outer box instead of leaving small white gaps at the extremes (#1215).

* The space around the plots when using `plot_singlePanels = FALSE` has been
reduced, so that plots can be a bit more detailed (#1219).

### `analyse_portableOSL()`

* The size of the contour labels for `mode = "surface"` can now be controlled
with the `...` argument `labcex` and scale with `cex` (#1075).

* The size of the interpolation grid can be controlled via the `...` arguments
`nx` and `ny` (#1077).

* The `coord` argument is now better validated to avoid a crash in case of
misspecification (#1097).

### `analyse_SAR.CWOSL()`

* Insert empty subplots when `onlyLxTxTable = TRUE` is used, to avoid messing
up the usual ordering of plots, which would lead to a crash if the option was
set from `analyse_pIRIRSequence()` (#1186).

* The function crashed when applied to an object generated by
`OSLdecomposition::RLum.OSL_decomposition()` with `plot = TRUE`; this was a
regression introduced in v1.1.0 (#1188; thanks to @DirkMittelstrass for
reporting).

* The visualisation of the 'Checks' (former rejection criteria) was not very
intuitive. To improve the situation, we now display correct inequality symbols,
such as `<=` or `>=` instead of `<>` (which was meant to be understood as a
comparator). Furthermore, the recycling ratio now shows better the threshold
depending on whether the ratio is smaller or larger than one.

* The function crashed if the `rejection.criteria` list specified a `NULL`
value for `recuperation_reference` (#1204).

* The space around the plots when using `plot_onePage = TRUE` has been
reduced, so that plots can be a bit more detailed (#1219).

* The labels in the rejection criteria plot are now shortened only when the
available horizontal space is not wide enough (#1222).

### `bin_RLum.Data()`

* Validation of the `bin_size` (for `RLum.Data.Curve`), `bin_size.row` and
`bin_size.col` (for `RLum.Data.Spectrum`) has been made stricter, so that
invalid values produce an error (#1104).

### `calc_AliquotSize()`

* The function no longer hangs when `grain.size` is set to a small value and
its minimum and maximum values are the same (#1114).

* The number of MC iteration is now correctly reported in the plot subtitle
(#1115).

* The function now validates the `MC.iter` argument to avoid an ugly crash if
a non-positive value is provided (#1124).

* The function now better validates its `grain.size` argument (#1152).

### `calc_CosmicDoseRate()`

* The function is now more robust against `NA` values in its input arguments
(#1101).

### `calc_EED_Model()`

* A crash that occurred with a small number of simulation was fixed (#1051).

* The error message in case of failed surface interpolation is now clearer and
more complete (#1053).

### `calc_FadingCorr()`

* The function produces an error if `g_value` is an `RLum.Results` object with
an unsupported originator instead of returning `NULL` (#1136).

### `calc_FiniteMixture()`

* The function no longer crashes if the De column contains zeros or missing
values (#1146, #1148).

* The legend for the components is positioned consistently also at `cex`
values other than 1 and is drawn also when `pdf.colors = "gray"` (#1175).

### `calc_HomogeneityTest()`

* The function ignores all columns after the first two, as they could lead to
crashes if they contained non-numeric values (#1224).

### `calc_Huntley()`

* A warning raised in rare occasions if the number of Monte Carlo iterations
is very small has been fixed (#1048).

### `calc_OSLLxTxRatio()`

* The `Lx.data` and `Tx.data` arguments are now better validated (#1178).

### `calc_SourceDoseRate()`

* The function returns a clearer error message if dates are specified in an
unexpected or ambiguous format (#1162).

### `calc_Statistics()`

* The function could crash if an error was exactly zero. This affected also
the plotting functions that use `calc_Statistics()` (#1160).

### `combine_De_Dr()`

* It is now possible to control the random seeds used by the JAGS MCMC chains
via the `method_control` argument (#1038).

### `fit_CWCurve()`

* If model fitting failed but an object named `fit` was present in the
workspace, the function tried to use that one, which would lead to a crash
or to unexpected results (#1081).

* The `output.table` field of the `RLum.Results` object returned now contains
only columns corresponding to the components effectively fitted (#1083).

### `fit_EmissionSpectra()`

* The function makes better use of the plot area, leaving smaller margins
around the plot (#1011).

### `fit_OSLLifeTimes()`

* The function throws a warning when the fit fails (#1005).

* The function makes better use of the plot area, leaving smaller margins
around the plot (#1011).

### `install_DevelopmentVersion()`

* The function has been refactored so that it no longer depends on the
deprecated `github_branches()` function (#1079).

### `plot_AbanicoPlot()`

* A warning was raised if the function returned early (for example due to
invalid inputs) and the graphical device was off (#1001).

* The function now validates the `frame` argument in order to avoid crashing
on misspecified values (#1036).

* The function no longer crashes when a small `plot.ratio` value is specified
(#1062).

* The function now validates the `zlim` argument to avoid a crash if negative
values are used with `log.z = TRUE` (#1063).

* The legend text now scales better at high `cex` values (#1066).

* If `summary.pos` contains multiple valid positions, use the first one rather
than generating warnings and not showing the summary (#1093).

### `plot_DoseResponseCurve()`

* The plot symbols are now correctly assigned for `mode = "extrapolation"` and
in the legend. If `reg_points_pch` is specified, it must now be a vector of
3 elements, corresponding to the symbols to use for normal points, point 0 and
repeated points, respectively (#1072).

* The baseline line in the sensitivity plot has been extended to reach the
outer box instead of leaving small white gaps at the extremes (#1213).

* The space around the plots has been reduced, so that plots can be a bit more
detailed (#1219).

### `plot_DRTResponse()`

* Suppress warnings generated by `graphics::arrows()` when multiple datasets
having wildly different distributions are plotted (#1184).

### `plot_Histogram()`

* Since version 1.0.0, setting `summary.pos` to one of "left", "center" or
"right" and `normal_curve = TRUE` resulted in the summary table not being
visible (#1118).

### `plot_KDE()`

* Space at the bottom of the plot is no longer added when the boxplot is not
plotted because `values.cumulative = FALSE` (#1110).

* The plot title and subtitle now respect the `cex` option (#1112).

* The function now better validates its input arguments (#1158).

### `plot_RadialPlot()`

* The function avoids some possible overprinting at the extremes of the z-axis
labels and draws lines at the extremes of the ellipse (#1013).

* The appearance of the y-axis ticks has been improved in the case when the
y-axis is particularly narrow (#1060).

* If `summary.pos` contains multiple valid positions, use the first one rather
than generating warnings and not showing the summary (#1093).

* The functionality of the `stats` argument had regressed in version 1.1.1,
and now has been restored (#1106).

* The function better validates the `zlim` argument, to avoid crashes on
misspecified axis limits if `log.z = TRUE` (#1140).

* The function now always returns invisibly the list of plot parameters,
independently of the value of the `output` argument. This change made that
argument redundant, so it was removed. This should have no impact on users;
if specified, it will be ignored (#1142).

* The function stops with an error instead of crashing if the input contains
only 1 data point (#1150).

* The function reports a message instead of throwing a warning when adding a
line with negative value if `log.z = TRUE` (#1164, #1168).

* The summary text and line labels now scale better at high `cex` values
(#1170).

* The function no lonver crashes if `central.value` is a non-positive value
when `log.z = TRUE` (#1173).

* Some graphical artifacts related to the 2-sigma bar, which would appear for
extreme settings of the `central.value` argument have been fixed (#1194).

### `plot_RLum.Analysis()`

* Setting `records_max` to a value larger than the number of curves no longer
generates spurious legend entries (#1017).

* The function now supports plotting of `RLum.Data.Image` objects contained
in its records (#1028).

### `plot_RLum.Data.Image()`

* The function now supports the `...` argument `mtext` (#1031).

* The positioning of axis ticks and labels in raster and contour plots of
low-resolution images has been improved, and pixel numbering starts
consistently from 1 (#1191).

* The function gained support for the arguments `digits` and `scientific`.
Moreover, it is possible to specify multiple plot titles in `main`. Thanks
to @Zink-Antoine for the contribution (#1197).

### `plot_RLum.Data.Spectrum()`

* The function doesn't crash anymore if `bg.spectrum` is used and `ylim`
specifies an interval that doesn't contain any background channels (#1019).

* The function doesn't crash anymore if the value of `frames` given is too
large when `plot.type = "multiple.lines"` (#1021).

* The legend text now scales better at high `cex` values (#1068).

* The function now makes better use of the plot area by setting better margins
and spacing between axis elements (#1070).

### `read_PSL2R()`

* The function gained a `pattern` argument to refine the list of files to
read when a directory path is specified (#1099).

### `read_SPE2R()`

* The function no longer crashes if `frame.range` is misspecified (#1138).

### `subset.Risoe.BINfileData()`

* The function also updates the `.RESERVED` slot (if present) to keep only the
elements selected (#1089).

### `verify_SingleGrainData()`

* The function crashed on empty `RLum.Analysis-class` objects. Now a warning
and `NULL` is returned. 

## Other changes

* The `ExampleData.portableOSL` file has been updated with surface coordinates
(#1095).

* Documentation for all example data (including synthetic datasets) is now
more easily findable from RStudio (#1166; thanks to @DirkMittelstrass for
reporting).
