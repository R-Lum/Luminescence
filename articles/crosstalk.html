<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Assessing crosstalk in single-grain luminescence detection • Luminescence</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Assessing crosstalk in single-grain luminescence detection">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Assessing crosstalk in single-grain luminescence detection</h1>
                        <h4 data-toc-skip class="author">Luc Steinbuch,
Anna-Maartje de Boer, Wageningen University &amp; Research</h4>
            
            <h4 data-toc-skip class="date">February 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/v1.0.0/vignettes/crosstalk.Rmd" class="external-link"><code>vignettes/crosstalk.Rmd</code></a></small>
      <div class="d-none name"><code>crosstalk.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="crosstalk">Crosstalk<a class="anchor" aria-label="anchor" href="#crosstalk"></a>
</h2>
<p>This vignette explores the crosstalk-related functions in the
“Luminescence” package, related to research paper “A novel tool to
assess crosstalk in single-grain luminescence detection”, by
Anna-Maartje de Boer, Luc Steinbuch, Gerard Heuvelink and Jakob
Wallinga. Crosstalk in single-grain luminescence imaging (EMCCD) is the
overlapping of luminescence signals from adjacent grains on a
single-grain disc. The actual signal on one grain location influences
the observed signal on a neighboring grain location which happens to be
on the same measurement disc (one “position” in the reader). In this
research and the shown functions, we define “neighboring” as rook-wise
(horizontally and vertically) only, and we assume that all measurement
discs have a regular grid of 10x10 grain locations.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-lum.github.io/Luminescence/">Luminescence</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Welcome to the R package Luminescence version 1.0.0 [Built: 2025-02-21 15:22:31 UTC]</span></span>
<span><span class="co">#&gt; Luminescence data to Bayesian process: 'Don't you ever touch me again.'</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="explore-imaged-luminescence-signals-from-a-single-grain-disc-one-position-in-the-reader">Explore imaged luminescence signals from a single-grain disc (one
“position” in the reader)<a class="anchor" aria-label="anchor" href="#explore-imaged-luminescence-signals-from-a-single-grain-disc-one-position-in-the-reader"></a>
</h2>
<p>All grain location observations on one single-grain measurement disc
are represented by a vector of 100 numbers. Here we simulate such a disc
by randomly selecting from two normal distributions. The prefix “vn_”
means: a vector of numbers:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">vn_simulated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">2000</span>, sd <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">70</span>, mean <span class="op">=</span> <span class="fl">20</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vn_simulated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vn_simulated</span><span class="op">)</span> <span class="co"># Because photons are discrete</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">vn_simulated</span>, n <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 1723   23   21   19   21 2175   22   19   21   19 3177   21   18 2985   21</span></span>
<span><span class="co">#&gt; [16]   21   21 2282   21   19   19 2362   20   19   21</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">vn_simulated</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Simulated signal (histogram)"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Photon counts"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Frequency"</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fl">30</span></span>
<span>     <span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/simulate_signal-1.png" width="800px"></p>
<div class="section level3">
<h3 id="plot_singlegraindisc">plot_SingleGrainDisc<a class="anchor" aria-label="anchor" href="#plot_singlegraindisc"></a>
</h3>
<p>Let’s visualize the disc/position:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_SingleGrainDisc.html">plot_SingleGrainDisc</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>          main <span class="op">=</span> <span class="st">"Simulated signal (measurement disc)"</span></span>
<span>          <span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/show_disc_basic-1.png" width="800px"></p>
<p>Let’s calculate Moran’s I, and the associated pseudo-p, of our
randomly ordered simulated disc:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.002584057</span></span>
<span></span>
<span><span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>, compute_pseudo_p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.447</span></span></code></pre></div>
<p>what changes if we add a serious amount, say 10%, of crosstalk?</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">vn_simulated_with_crosstalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_Crosstalk.html">apply_Crosstalk</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>                                              n_crosstalk <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vn_simulated_with_crosstalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vn_simulated_with_crosstalk</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">vn_simulated_with_crosstalk</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Simulated signal with crosstalk (histogram)"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Photon counts"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Frequency"</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fl">30</span></span>
<span>     <span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/add_crosstalk-1.png" width="800px"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_SingleGrainDisc.html">plot_SingleGrainDisc</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_crosstalk</span>,</span>
<span>          main <span class="op">=</span> <span class="st">"Simulated signal with crosstalk (measurement disc)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/add_crosstalk-2.png" width="800px"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_crosstalk</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.176199</span></span>
<span></span>
<span><span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_crosstalk</span>, compute_pseudo_p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.007</span></span></code></pre></div>
<p>Let’s try several amounts of simulated crosstalk:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">df_MoransI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>crosstalk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                    to <span class="op">=</span> <span class="fl">0.30</span>,</span>
<span>                    length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_MoransI</span><span class="op">$</span><span class="va">MoransI</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">df_MoransI</span><span class="op">$</span><span class="va">pseudo_p</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">old.opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>warn <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="co"># silence warnings from compute_pseudo_p</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df_MoransI</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span></span>
<span>  <span class="va">vn_simulated_with_crosstalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_Crosstalk.html">apply_Crosstalk</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>                                              n_crosstalk <span class="op">=</span> <span class="va">df_MoransI</span><span class="op">$</span><span class="va">crosstalk</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">df_MoransI</span><span class="op">$</span><span class="va">MoransI</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_crosstalk</span><span class="op">)</span></span>
<span>  <span class="va">df_MoransI</span><span class="op">$</span><span class="va">pseudo_p</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_crosstalk</span>, compute_pseudo_p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="va">old.opts</span><span class="op">)</span> <span class="co"># restore the default options</span></span>
<span></span>
<span><span class="va">n_expected_I_no_spatial_autocorr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>                                                 spatial_autocorrelation <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">df_MoransI</span><span class="op">$</span><span class="va">crosstalk</span>,</span>
<span>     y <span class="op">=</span> <span class="va">df_MoransI</span><span class="op">$</span><span class="va">MoransI</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">df_MoransI</span><span class="op">$</span><span class="va">MoransI</span>, <span class="va">n_expected_I_no_spatial_autocorr</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="op">)</span>,</span>
<span>     <span class="co">## Set ylim manually to make sure the value for I for no crosstalk is visible</span></span>
<span>     xlab <span class="op">=</span> <span class="st">"Amount of added crosstalk"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Calculated Moran's I"</span></span>
<span>     <span class="op">)</span></span>
<span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">n_expected_I_no_spatial_autocorr</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topleft"</span>,</span>
<span>       legend <span class="op">=</span> <span class="st">"Expected I if no spatial autocorrelation"</span>,</span>
<span>       lty <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span>       cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/test_different_amounts-1.png" width="800px"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">df_MoransI</span><span class="op">$</span><span class="va">crosstalk</span>,</span>
<span>     y <span class="op">=</span> <span class="va">df_MoransI</span><span class="op">$</span><span class="va">pseudo_p</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Amount of added crosstalk"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Generated pseudo-p of related Moran's I"</span><span class="op">)</span></span>
<span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/test_different_amounts-2.png" width="800px"></p>
<p>Please note that above two plots are subject to randomness; for a
good assessment many simulations have to be performed.</p>
</div>
</div>
<div class="section level2">
<h2 id="moran-scatterplot">Moran scatterplot<a class="anchor" aria-label="anchor" href="#moran-scatterplot"></a>
</h2>
<p>A way to visualise spatial auto-correlation is the Moran
scatterplot:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_MoranScatterplot.html">plot_MoranScatterplot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>           main <span class="op">=</span> <span class="st">"Moran scatterplot, simulated signal without crosstalk"</span><span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/show_%60disc_extended_moran_scatterplot-1.png" width="800px"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">vn_simulated_with_crosstalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_Crosstalk.html">apply_Crosstalk</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>                                              n_crosstalk <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">vn_simulated_with_crosstalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vn_simulated_with_crosstalk</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_MoranScatterplot.html">plot_MoranScatterplot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_crosstalk</span>,</span>
<span>           main <span class="op">=</span> <span class="st">"Moran scatterplot, simulated signal with added crosstalk"</span><span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/show_%60disc_extended_moran_scatterplot-2.png" width="800px"></p>
<p>The plot area is divided into four quadrants using the mean in each
dimension; the South-west and North-east quadrant represent a
contribution to a positive spatial autocorrelation, while the North-west
and South-east quadrants indicate a negative spatial correlation.
Between the point, a least square line (which slopes indicates, but not
exactly represents, Moran’s I) is added, as well as an 1:1 line (which
indicates a Moran’s I of around 1, suggesting a perfect positive spatial
correlation).</p>
<p>The internal function <code>.get_Neighbours()</code> was until now
used on the background, but we can explicitly call it to generate a
dataframe with all positions which are rook connected to each other
(note that we need to use the <code>Luminescence:::</code> prefix as
this function is not exported by the package):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span>    <span class="va">vn_simulated_with_holes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">500</span>, sd <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, times <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span>                              <span class="op">)</span></span>
<span></span>
<span><span class="va">df_Neighbours</span> <span class="op">&lt;-</span> <span class="fu">Luminescence</span><span class="fu">:::</span><span class="fu">.get_Neighbours</span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_holes</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_Neighbours</span><span class="op">)</span></span>
<span><span class="co">#&gt;    location neighbour weight</span></span>
<span><span class="co">#&gt; 11       11         1      1</span></span>
<span><span class="co">#&gt; 12       12         2      1</span></span>
<span><span class="co">#&gt; 13       13         3      1</span></span>
<span><span class="co">#&gt; 14       14         4      1</span></span>
<span><span class="co">#&gt; 15       15         5      1</span></span>
<span><span class="co">#&gt; 16       16         6      1</span></span></code></pre></div>
<p>And we can plot the first disc, while indicating which borders are
taken into account. The corresponding
<code>adjacent_grain_locations</code> is calculated in the
background:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span>    <span class="fu"><a href="../reference/plot_SingleGrainDisc.html">plot_SingleGrainDisc</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_holes</span>,</span>
<span>              show_neighbours <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              show_location_ids <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/adjacent_grain_locations_show_disc-1.png" width="800px">
Also other functions, such as <code><a href="../reference/calc_MoransI.html">calc_MoransI()</a></code>, work as long
as the remaining grid does not become too sparse. Note that in this
context all observations, even “islands” who do not border any other
grains, are used for the calculation of Moran’s I.</p>
</div>
<div class="section level2">
<h2 id="add-borders-with-certain-weight">Add borders with certain weight<a class="anchor" aria-label="anchor" href="#add-borders-with-certain-weight"></a>
</h2>
<p>One can manually change <code>df_Neighbours</code>, for example add
the diagonal borders and attain a certain weight to it, and add it as
argument to almost all functions. Assume that we want to add a few
diagonal borders with weight 1/sqrt(2) to a full disc (note that the
standard relative weight for rook borders is set to one):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df_Neighbours_with_diag</span> <span class="op">&lt;-</span> <span class="fu">Luminescence</span><span class="fu">:::</span><span class="fu">.get_Neighbours</span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">19</span>, <span class="fl">21</span><span class="op">:</span><span class="fl">29</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">df_Neighbours_with_diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_Neighbours_with_diag</span>,</span>
<span>                                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">i</span><span class="op">+</span><span class="fl">11</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>                                          <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">df_Neighbours_with_diag</span><span class="op">)</span></span>
<span><span class="co">#&gt;     location neighbour    weight</span></span>
<span><span class="co">#&gt; 202       24        35 0.7071068</span></span>
<span><span class="co">#&gt; 203       25        36 0.7071068</span></span>
<span><span class="co">#&gt; 204       26        37 0.7071068</span></span>
<span><span class="co">#&gt; 205       27        38 0.7071068</span></span>
<span><span class="co">#&gt; 206       28        39 0.7071068</span></span>
<span><span class="co">#&gt; 207       29        40 0.7071068</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_SingleGrainDisc.html">plot_SingleGrainDisc</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>          df_neighbours <span class="op">=</span> <span class="va">df_Neighbours_with_diag</span>,</span>
<span>          show_neighbours <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          show_location_ids <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/adjacent_grain_locations_add-1.png" width="800px"></p>
<p>To exclude all border effects, we can use the
<code>ignore_borders</code> option available in
<code><a href="../reference/calc_MoransI.html">calc_MoransI()</a></code> and <code><a href="../reference/plot_SingleGrainDisc.html">plot_SingleGrainDisc()</a></code>,
which can take out all border rows and columns when computing the data
frame of neighbours:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">vn_values_to_show</span> <span class="op">&lt;-</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">2000</span>, sd <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">70</span>, mean <span class="op">=</span> <span class="fl">20</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Set the outer rows to NA before adding crosstalk</span></span>
<span><span class="va">vn_disc_border_locations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>                              <span class="fl">91</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">11</span>, to <span class="op">=</span> <span class="fl">81</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">20</span>, to <span class="op">=</span> <span class="fl">90</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>                             <span class="op">)</span></span>
<span><span class="va">vn_values_to_show</span><span class="op">[</span><span class="va">vn_disc_border_locations</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">vn_values_to_show</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_Crosstalk.html">apply_Crosstalk</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_values_to_show</span>,</span>
<span>                                     n_crosstalk <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_values_to_show</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1406872</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_SingleGrainDisc.html">plot_SingleGrainDisc</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_values_to_show</span>,</span>
<span>                     show_neighbours <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     ignore_borders <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/restrict_to_inner_8x8-1.png" width="800px"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_values_to_show</span>,</span>
<span>             ignore_borders <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1406872</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-disc-options">Plot disc options<a class="anchor" aria-label="anchor" href="#plot-disc-options"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_SingleGrainDisc.html">plot_SingleGrainDisc</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>          main <span class="op">=</span> <span class="st">""</span>,</span>
<span>          legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          show_coordinates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          show_location_ids <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          show_positioning_holes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/show_disc_extended-1.png" width="800px"></p>
<p>When there is a wide range in values, it can be helpful to apply a
logarithmic scale in plotting (note that the default is “square
root”):</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_SingleGrainDisc.html">plot_SingleGrainDisc</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>          main <span class="op">=</span> <span class="st">"Linear scale"</span>,</span>
<span>          legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          show_coordinates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          show_location_ids <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          show_positioning_holes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          str_transform <span class="op">=</span> <span class="st">"lin"</span><span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/show_disc_scales-1.png" width="800px"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_SingleGrainDisc.html">plot_SingleGrainDisc</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>          main <span class="op">=</span> <span class="st">"Logarithmic scale"</span>,</span>
<span>          legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          show_coordinates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          show_location_ids <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          show_positioning_holes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          str_transform <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/show_disc_scales-2.png" width="800px"></p>
</div>
<div class="section level2">
<h2 id="moran-scatterplot-options">Moran scatterplot options<a class="anchor" aria-label="anchor" href="#moran-scatterplot-options"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">vn_simulated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">75</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">500</span>, sd <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>  <span class="op">)</span></span>
<span><span class="va">vn_simulated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">100</span>, <span class="va">vn_simulated</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vn_simulated_with_crosstalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_Crosstalk.html">apply_Crosstalk</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>                                               n_crosstalk <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Base use</span></span>
<span><span class="fu"><a href="../reference/plot_MoranScatterplot.html">plot_MoranScatterplot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>                      main <span class="op">=</span> <span class="st">"Without crosstalk"</span><span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/show_scatterplot_options-1.png" width="800px"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_MoranScatterplot.html">plot_MoranScatterplot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_crosstalk</span>,</span>
<span>                      main <span class="op">=</span> <span class="st">"With crosstalk"</span><span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/show_scatterplot_options-2.png" width="800px"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co">## Layout options</span></span>
<span><span class="fu"><a href="../reference/plot_MoranScatterplot.html">plot_MoranScatterplot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_crosstalk</span>,</span>
<span>           pch <span class="op">=</span> <span class="st">"show_location_ids"</span>,</span>
<span>           legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           log <span class="op">=</span> <span class="st">"xy"</span>,</span>
<span>           main <span class="op">=</span> <span class="st">"With location ID's; and with log scales"</span></span>
<span>           <span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/show_scatterplot_options-3.png" width="800px"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_MoranScatterplot.html">plot_MoranScatterplot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_crosstalk</span>,</span>
<span>           pch <span class="op">=</span> <span class="st">"show_n_neighbours"</span>,</span>
<span>           legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           str_y_def <span class="op">=</span> <span class="st">"weighted_sum"</span>,</span>
<span>           main <span class="op">=</span> <span class="st">"With number of neighbours, and other y calculation"</span></span>
<span>           <span class="op">)</span></span></code></pre></div>
<p><img src="crosstalk_files/figure-html/show_scatterplot_options-4.png" width="800px"></p>
</div>
<div class="section level2">
<h2 id="morans-i-function-options">Moran’s I function options<a class="anchor" aria-label="anchor" href="#morans-i-function-options"></a>
</h2>
<p>The function <code><a href="../reference/calc_MoransI.html">calc_MoransI()</a></code> can return many intermediate
calculation numbers:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>             return_intermediate_values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; $n</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_mean</span></span>
<span><span class="co">#&gt; [1] 50.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_population_variance</span></span>
<span><span class="co">#&gt; [1] 833.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_sum_similarities</span></span>
<span><span class="co">#&gt; [1] 133320</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_sum_weights</span></span>
<span><span class="co">#&gt; [1] 180</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_average_auto_correlation</span></span>
<span><span class="co">#&gt; [1] 740.6667</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_moransI</span></span>
<span><span class="co">#&gt; [1] 0.8888889</span></span></code></pre></div>
<p>If the weights (and thus the spatial pattern under investigation) and
the number of observations remain the same, this can be useful to
understand what is happening. For example, if we add crosstalk, we can
see that the population variance in most cases slightly increases (the
values are indeed spatially smoothed, but the average increases) but the
spatial autocorrelation strongly increases:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">vn_simulated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">2000</span>, sd <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">70</span>, mean <span class="op">=</span> <span class="fl">20</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">vn_simulated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vn_simulated</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vn_simulated_with_crosstalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_Crosstalk.html">apply_Crosstalk</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>                                               n_crosstalk <span class="op">=</span> <span class="fl">0.20</span><span class="op">)</span></span>
<span><span class="va">vn_simulated_with_crosstalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vn_simulated_with_crosstalk</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">df_compare</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Case <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Without crosstalk"</span>, <span class="st">"With crosstalk"</span><span class="op">)</span>,</span>
<span>             MoransI <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span><span class="op">)</span>,</span>
<span>                          <span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_crosstalk</span><span class="op">)</span></span>
<span>                          <span class="op">)</span>,</span>
<span>             PopulationVar <span class="op">=</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>                 return_intermediate_values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">n_population_variance</span>,</span>
<span>                 <span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_crosstalk</span>,</span>
<span>                 return_intermediate_values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">n_population_variance</span><span class="op">)</span>,</span>
<span>             SpatialAutoCor <span class="op">=</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated</span>,</span>
<span>                 return_intermediate_values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">n_average_auto_correlation</span>,</span>
<span>                 <span class="fu"><a href="../reference/calc_MoransI.html">calc_MoransI</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">vn_simulated_with_crosstalk</span>,</span>
<span>                 return_intermediate_values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">n_average_auto_correlation</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span><span class="va">df_compare</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">df_compare</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">df_compare</span><span class="op">)</span></span>
<span><span class="co">#&gt;                Case MoransI PopulationVar SpatialAutoCor</span></span>
<span><span class="co">#&gt; 1 Without crosstalk   -0.11      849694.4      -97084.16</span></span>
<span><span class="co">#&gt; 2    With crosstalk    0.34      884920.6      303927.55</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo, Luc Steinbuch, Anna-Maartje de Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
