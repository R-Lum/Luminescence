




<!-- NEWS.md was auto-generated by NEWS.Rmd. Please DO NOT edit by hand!-->

# Changes in version 1.0.1.9000-16 (2025-04-11)

## New functions

- `remove_SignalBackground()`: A user-friendly method to subtract
  background signals from various curves in `RLum.Analysis-class`
  objects without resorting to `lapply()` loops. Depending on the record
  type, the function identifies pairs of curves; for instance, if in a
  sequence, a `TL` curve is followed immediately by another `TL` curve.
  The subsequent curve is recognised as the background signal,
  subtracted using `merge_RLum()` and subsequently removed from the
  object (if desired). Alternatively, a set of potential background
  curves can be specified.

- `remove_RLum()`: This function further completes the set of methods
  that can handle and modify `RLum-class` objects. It operates on
  `RLum.Analysis-class` objects or a `list` of such objects to remove
  unwanted records from datasets. Although the function calls
  `get_RLum()` and relies on its functionality, the new implementation
  facilitates a more logical workflow and analysis pipeline.

## Renamed functions and deprecations

## Breaking changes

- Function `get_Quote()` is no longer exported, but remains available as
  an internal function. This is unlikely to affect any user of the
  package, as the function was only meant to report a random quote at
  startup (#644).

- In the functions `fit_DoseResponseCurve()` and `plot_GrowthCurve()`,
  the `fit.method` option `LambertW` was replaced by the more correct
  term `OTOR`. Nothing else has changed; however, if you run
  `fit.method = 'LambertW'`, it fails because it has to read
  `fit.method = 'OTOR'`. The function does not throw a warning or
  message for this change because the option was likely not yet used
  much.

- The fundamental physical constants used in the package (such as
  Boltzmann constant, Planck constant, etc) have been uniformed to those
  reported in the NIST Reference on Constants, Units and Uncertainty
  (<https://physics.nist.gov/cuu/Constants/>). This may affect the
  numerical results of the following functions: calc_FastRatio(),
  calc_Huntley2006(), calc_SourceDoseRate(), calc_ThermalLifetime(),
  convert_Activity2Concentration(), convert_Wavelength2Energy(),
  fit_CWCurve(), fit_LMCurve(), fit_SurfaceExposure() (#693).

## Bugfixes and changes

### `analyse_SAR.CWOSL()`

- Add support for `fit.method = 'OTORX'` following the changes in
  `fit_DoseResponseCurve()`; this change includes the new argument
  `dose.points.test` that is only of use in combination with the `OTORX`
  fit.

### `analyse_FadingMeasurement()`

- The function crashed if the number of `Lx` and `Tx` curves was not
  equal when `structure = c("Lx", "Tx")`, which is the default. The
  check that the number of points within each pair of curves has also
  been improved, and the function now produces more helpful error
  messages (#616).

### `analyse_portableOSL()`

- The function now returns an error if `mode` is something other than
  `"profile"` or `"surface"`.

- The `mode` argument was not respected when operating over a list of
  objects (#673).

- The function crashed when using `mode = "surface"` if the plotting
  limits were too tight and left only one point (#675).

- The check on the validity of the `signal.integral` argument has been
  improved, and now it occurs only once, so at most one warning is
  raised if the argument is set to a value exceeding the valid range
  (#678, \#680).

- The function returns a clearer message when no x-coordinates were
  measured and `mode = "surface"` was used (#682).

- The `cex` and `type` graphical parameters can now configured via the
  `...` argument (#684).

- The expected sequence pattern of the input object is validated more
  thoroughly to avoid crashes in case of misspecification (#687).

- The graphical `...` argument `contour` never produced a meaningful
  contour plot due to an internal error (#686). Along, arguments
  `contour_nlevels` and `contour_col` are now supported through `...` to
  better control the number and colour of contour lines.

### `calc_AliquotSize()`

- The new argument `sample_carrier.diameter` allows to specify a value
  for the diameter of the sample carrier, which up to now was hardcoded
  to the very common 9.8 mm size (#623).

- Several graphical parameters can now configured via `...` arguments,
  so that the plot appearance can be fully customized (#671).

### `calc_AverageDose()`

- A bug in the implementation prevented the default plot settings from
  being modified via `...` as advertised. Now custom settings are
  respected (#658).

### `calc_FiniteMixture()`

- The function doesn’t crash anymore if the `n.components` argument
  specifies non-consecutive values (#691).

### `calc_Huntley2006()`

- Add support for nls-fitting control arguments `maxiter` and `trace`.
- The fitting of the simulated curve with the GOK model has been made
  more robust: when an initial fit of the model fails, the fit is
  attempted again with 10 different values for `D0` and the best fit is
  used. This should reduce the number of occasions in which the error
  message “Could not fit simulated model curve, check suitability of
  model and parameters” is reported (#660).

### `calc_OSLLxTxRatio()`

- The function returned a warning for wrong integral settings for the
  `Tx` curve even if no `Tx` curve was provided; fixed.
- The function does not check any more of different object types for
  `Lx.data` and `Tx.data` but validate objects for allowed types (this
  should have no user-visible effects)

### `convert_Concentration2DoseRate()`

- The function validates its input values more thoroughly (#613).

### `extract_IrradiationTimes()`

- The function tries a little bit harder to extract the correct duration
  of TL steps, rendering the data output hopefully a little bit more
  intelligible (#651).

### `fit_DoseResponseCurve()`

- The function now allocates less memory for storing intermediate values
  (#610).
- Add initial support for `OTORX` fitting following Lawless and
  Timar-Gabor (2024). In order to use the fit, you have to provide
  information on the test dose in the input object. Please note that
  following the reference, the function is not defined for
  `extrapolation` (#677). The code implementation follows the Python
  reference by
  [jll2](https://github.com/jll2/LumDRC/blob/main/otorx.py).

### `fit_SurfaceExposure()`

- It is now possible to specify different values for the light
  attenuation coefficient `mu` when a list of input data is provided
  (#667).

### `fit_ThermalQuenching()`

- The `trace` option, which can be specified via the `method_control`
  argument, is now respected.

- The model now get internally reformulated into a mathematically
  equivalent expression that is easier to fit. This should reduce the
  number of occasions when the function fails to find a valid solution
  and improve the uncertainty estimation (#696).

### `import_Data()`

- The function uses the most common formats (BINX and XSYG) before
  trying all others.

### `merge_RLum.Data.Curve()`

- The function does no longer stops for differing channel resolutions,
  but it does issue a warning. The user is responsible for the
  consequences.

### `plot_DoseResponseCurve()`

- The response curve always tries to the get the 0 point in the mode
  `interpolation` and `alternate` (#677)

### `plot_DRCSummary()`

- Add support for `fit.method = 'OTORX'` following the change in
  `fit_DoseResponseCurve()` (#677)

### `plot_GrowthCurve()`

- Add support for `OTORX` fit corresponding to the underlying change in
  `fit_DoseReponseCurve()` (#677)

### `plot_KDE()`

- The function validates its input values more thoroughly (#635).

- Setting `summary.pos` to one of “left”, “center” or “right” resulted
  in the summary table not being visible (#642).

### `plot_RadialPlot()`

- The function validates its input values more thoroughly (#639).

### `plot_RLum.Data.Curve()`

- We added comprehensive support for base R plotting arguments utilised
  by `plot.default()` and `par()`. This enhancement ensures that all
  available arguments are fully supported (#646).

- The function gained a new logical argument named `auto_scale`. When
  set in conjunction with either `xlim` or `ylim`, this argument
  automatically adjusts the plot range to align with the corresponding
  settings for `xlim` or `ylim`. For instance, if a user intends to plot
  OSL curves but initially selects the `xlim` range `c(10:30)` to
  examine the background, the initial count values may be excessively
  large, resulting in limited visibility. With the introduction of the
  `auto_scale` option, the `ylim` values are automatically adjusted to
  compensate for this scenario. The `auto_scale` argument is also
  accessible through `plot_RLum.Analysis()` and `plot_RLum()` (#646).

### `sort_RLum()`

- The sorting mechanism for `RLum.Analysis-class` objects has been
  enhanced. It now enables sorting based on multiple parameters,
  including sorting all available `info_elements` in a prioritised
  manner (#606, \#620).
- Sorting now works on a list of `RLum.Analysis-class` objects. If the
  list contains other elements, they are passed through. The output is
  again a list (#620)

### `structure_RLum()`

- The function now returns a less messy data frame because it
  encapsulates `.pid` and `info` as lists within the data frame. The
  function is primarily used internally to facilitate a rapid
  exploration of `RLum.Analysis-class` object structures. However, the
  change may potentially break existing code in extremely rare
  circumstances.

## Internals

- The internal function `create_UID()` has undergone further
  optimisation for speed, resulting in a significant performance
  improvement. Additionally, it now generates a hash value with a
  consistent length instead of a time stamp with a random number.
