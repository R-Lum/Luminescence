




<!-- NEWS.md was auto-generated by NEWS.Rmd. Please DO NOT edit by hand!-->

# Changes in version 0.9.25.9000-6 (2024-09-16)

## New functions

## Bugfixes

### `analyse_pIRIRSequence()`

- The function crashed with a object merge error if run in a loop
  because of a `merge_RLum()` error. This was caused by a regression
  while implementing the `n_N` calculation in `plot_GrowthCurve()`.
  Potentially affected was also `analyse_SAR.CWOSL()`.
- The functions tries to be more soft on the user when plot output on a
  too small device is attempted. Now it shows a warning with
  instructions and set `plot = FALSE`. This should prevent “Figure
  margins too large” errors.
- The function will not crash anymore during the plotting in another
  edge case related to single grain data.

### `analyse_SAR.TL()`

- The function now produces a more correct `rejection.criteria` data
  frame (#245, fixed in \#246).

### `get_RLum()`

- When the function was used on a list of `RLum.Analysis-class` objects
  with the argument `null.rm = TRUE` it would remove all `NULL` objects,
  but not elements that became `list()` (empty list) during the
  selection; fixed.
- Fix an edge case that caused a rather non-expected, more visible
  output problem. When curves were selected via `recordType` on
  `RLum.Analysis-class` objects (or a list of them) and the object
  contained only a single `RLum.Data-class` object, the function
  returned the `RLum.Data.Curve-class` object *regardless* of the
  selection in `recordType`. In other words: If a user tried
  `recordType = "TL"` on an `RLum.Analysis-class` object that contained
  only a single IRSL curve, the function would still return that single
  IRSL curve instead of an empty element. The reason for this behaviour
  was a poor attempt to deal with `NA` in the `recordType` name that led
  to missing values and unexpected behaviour for a logical comparison.
  Now, before the subset happens, `NA` values in `recordType` are
  converted to `"NA"` (a character) and the wiggling around that was
  causing the lousy subsetting was removed.

### `plot_RLum.Data.Spectrum()`

- Add support for `lphi` and `ltheta` light direction arguments for
  `plot.type = "persp"`.
- Fix the reason for the unclear warning
  `In col.unique == col :  longer object length is not a multiple of shorter object length`

## Internals

- Two new internal functions `.throw_warning()` and `.throw_error()`
  sometimes flushed the terminal with messages if call (internally) in
  particular circumstances. Now the functions make only two attempts to
  get the name of their called and then return an `unknown()` as
  function name.
