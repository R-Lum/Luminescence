
R Under development (unstable) (2023-07-21 r84719) -- "Unsuffered Consequences"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> pkgname <- "OSLdecomposition"
> source(file.path(R.home("share"), "R", "examples-header.R"))
> options(warn = 1)
> base::assign(".ExTimings", "OSLdecomposition-Ex.timings", pos = 'CheckExEnv')
> base::cat("name\tuser\tsystem\telapsed\n", file=base::get(".ExTimings", pos = 'CheckExEnv'))
> base::assign(".format_ptime",
+ function(x) {
+   if(!is.na(x[4L])) x[1L] <- x[1L] + x[4L]
+   if(!is.na(x[5L])) x[2L] <- x[2L] + x[5L]
+   options(OutDec = '.')
+   format(x[1L:3L], digits = 7L)
+ },
+ pos = 'CheckExEnv')
> 
> ### * </HEADER>
> library('OSLdecomposition')
> 
> base::assign(".oldSearch", base::search(), pos = 'CheckExEnv')
> base::assign(".old_wd", base::getwd(), pos = 'CheckExEnv')
> cleanEx()
> nameEx("RLum.OSL_correction")
> ### * RLum.OSL_correction
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: RLum.OSL_correction
> ### Title: Check and correct CW-OSL curves in RLum.Analysis data sets
> ### Aliases: RLum.OSL_correction
> 
> ### ** Examples
> 
> 
> # 'FB_10Gy' is a dose recovery test with the Fontainebleau quartz
> # measured with a lexsyg research with green LED stimulation
> data_path <- system.file("examples", "FB_10Gy_SAR.bin", package = "OSLdecomposition")
> data_set <- Luminescence::read_BIN2R(data_path, fastForward = TRUE)

[read_BIN2R()]
	 >> /Users/kreutzer/GitHub/Luminescence/Luminescence.BuildResults/OSLdecomposition.Rcheck/OSLdecomposition/examples/FB_10Gy_SAR.bin
  |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%
	 >> 154 records have been read successfully!

> 
> # To correct for the background signal, subtracted the average curve from the
> # OSL curves of an empty aliquot (list item 11) from all other OSL records:
> data_set_corrected <- RLum.OSL_correction(data_set, background = 11, remove_light_off = FALSE)
CORRECTION STEP 1 ----- Check records for consistency in the detection settings -----
All OSL records have the same detection settings
(time needed: 0.04 s)

CORRECTION STEP 2 ----- Limit measurement duration -----
Reduced length of 154 OSL records from 99.8 s to 20.07988 s
(time needed: 0 s)

CORRECTION STEP 3 ----- Correct for PMT pulse-pair resolution -----
Every channel with a signal higher than  5270  counts/sec will be increased. 
130  of  154   OSL  records contained signal values which needed to be corrected.
Signal statistics or corrected first channels:
Median increase =  0.13  % / Maximum increase =  0.82  %
(time needed: 0.01 s)

CORRECTION STEP 4 ----- Subtract background measurement -----
Built global average curve from arithmetic means from first 201 data points of all 14 OSL records
RLum.Data.Curve@RecordType is changed to OSLbackground for those records
Background saved at @CORRECTION@background_curve
(time needed: 0.01 s)

> 
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("RLum.OSL_correction", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("RLum.OSL_decomposition")
> ### * RLum.OSL_decomposition
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: RLum.OSL_decomposition
> ### Title: Separate CW-OSL components in RLum.Analysis data sets
> ### Aliases: RLum.OSL_decomposition
> 
> ### ** Examples
> 
> 
> #'FB_10Gy' is a dose recovery test with the Fontainebleau quartz
> # measured in a lexsyg research with green LED stimulation
> data_path <- system.file("examples", "FB_10Gy_SAR.bin", package = "OSLdecomposition")
> data_set <- Luminescence::read_BIN2R(data_path, fastForward = TRUE)

[read_BIN2R()]
	 >> /Users/kreutzer/GitHub/Luminescence/Luminescence.BuildResults/OSLdecomposition.Rcheck/OSLdecomposition/examples/FB_10Gy_SAR.bin
  |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%
	 >> 154 records have been read successfully!

> 
> # Separate components
> data_set_decomposed <- RLum.OSL_decomposition(
+ data_set, decay_rates = c(0.8, 0.05))
STEP 2.1 ----- Define signal bin intervals -----
OSL curve template necessary but not given. Obtain and use global average curve:
[sum_OSLcurves()]: Built global average curve from arithmetic means from first 999 data points of all 154 OSL records
(time needed: 0.65 s)

Find intervals with lowest component cross correlation by maximising the denominator determinant in Cramers rule:
Maximum determinant = 0.7728 with interval dividing channels at i = 37 
(time needed: 0.04 s)

STEP 2.2 ----- Decompose each  OSL  curve -----
Calculate signal intensity n in each OSL  by ' det+nls ' algorithm with empiric error estimation
Table of input decay constants and signal bin intervals for [decompose_OSLcurve()]:
         name lambda  t.start     t.end ch.start ch.end
1 Component 1   0.80 0.000000  3.696296        1     37
2 Component 2   0.05 3.696296 99.800003       38    999


...........
Successfully decomposed 154 records
(time needed: 0.19 s)

> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("RLum.OSL_decomposition", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("RLum.OSL_global_fitting")
> ### * RLum.OSL_global_fitting
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: RLum.OSL_global_fitting
> ### Title: Identify CW-OSL signal components in RLum.Analysis data sets
> ### Aliases: RLum.OSL_global_fitting
> 
> ### ** Examples
> 
> 
> # 'FB_10Gy' is a dose recovery test with the Fontainebleau quartz
> # measured in a lexsyg research with green LED stimulation
> data_path <- system.file("examples", "FB_10Gy_SAR.bin", package = "OSLdecomposition")
> data_set <- Luminescence::read_BIN2R(data_path, fastForward = TRUE)

[read_BIN2R()]
	 >> /Users/kreutzer/GitHub/Luminescence/Luminescence.BuildResults/OSLdecomposition.Rcheck/OSLdecomposition/examples/FB_10Gy_SAR.bin
  |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%
	 >> 154 records have been read successfully!

> 
> # Check data set and perform background correction
> data_set_corrected <- RLum.OSL_correction(data_set,
+  background = 11,
+  remove_light_off = FALSE)
CORRECTION STEP 1 ----- Check records for consistency in the detection settings -----
All OSL records have the same detection settings
(time needed: 0.04 s)

CORRECTION STEP 2 ----- Limit measurement duration -----
Reduced length of 154 OSL records from 99.8 s to 20.07988 s
(time needed: 0 s)

CORRECTION STEP 3 ----- Correct for PMT pulse-pair resolution -----
Every channel with a signal higher than  5270  counts/sec will be increased. 
130  of  154   OSL  records contained signal values which needed to be corrected.
Signal statistics or corrected first channels:
Median increase =  0.13  % / Maximum increase =  0.82  %
(time needed: 0.01 s)

CORRECTION STEP 4 ----- Subtract background measurement -----
Built global average curve from arithmetic means from first 201 data points of all 14 OSL records
RLum.Data.Curve@RecordType is changed to OSLbackground for those records
Background saved at @CORRECTION@background_curve
(time needed: 0.01 s)

> 
> # Identify components
> data_set_fitted <- RLum.OSL_global_fitting(
+  data_set_corrected,
+  K_maximum = 2,
+  stimulation_intensity = 50,
+  stimulation_wavelength = 530)
STEP 1.1 ----- Build global average curve from all CW-OSL curves -----
Built global average curve from arithmetic means from first 201 data points of all 140 OSL records
(time needed: 0.12 s)

STEP 1.2 ----- Perform multi-exponential curve fitting -----

Decay rates (s^-1):
Cycle 	    Comp. 1     Comp. 2         RSS     F-value
K = 1 	     0.7702               5.198e+05         Inf 
K = 2 	     0.7921      0.0317   1.231e+05       317.5 
Left loop because maximum number of allowed components K is reached
-> The F-test suggests the K = 2 model 

Photoionisation cross sections (cm^2):
Cycle 	  Comp. 1              Comp. 2             
K = 1 	 5.77e-18             
K = 2 	 5.94e-18             2.38e-19             
(time needed: 0.33 s)

> 
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("RLum.OSL_global_fitting", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("decompose_OSLcurve")
> ### * decompose_OSLcurve
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: decompose_OSLcurve
> ### Title: Multi-exponential CW-OSL decomposition
> ### Aliases: decompose_OSLcurve
> 
> ### ** Examples
> 
> 
> # Set some arbitrary decay parameter for a dim CW-OSL measurement of quartz
> components <- data.frame(name = c("fast", "medium", "slow"),
+                          lambda = c(2, 0.5, 0.02),
+                          n = c(1000, 1000, 10000))
> 
> # Simulate the CW-OSL curve and add some signal noise and some detection background
> curve <- simulate_OSLcomponents(components, simulate.curve = TRUE,
+                                 add.poisson.noise = TRUE, add.background = 40)
> 
> # Decompose the simulated curve
> components <- decompose_OSLcurve(curve, components)
   name          n   n.error  bin.RSS bin.error initial.signal n.residual
   fast  1066.7453  60.09955 1238.967  37.10297         0.7413          0
 medium   859.5255  83.22048 1405.938  37.82332         0.1607          0
   slow 12798.4382 166.23395 4777.909  69.22675         0.0980       5751
> 
> # Display the component separation results
> plot_OSLcurve(curve, components)
> 
> ### Decomposition including signal background fitting:
> 
> # Define optimized integration intervals, including an interval for the background
> components <- optimise_OSLintervals(components, curve, background.component = TRUE)
Maximum determinant = 0.5208 with interval dividing channels at i = 9, 52, 220 
> 
> # Decompose again and view results
> components <- decompose_OSLcurve(curve, components, background.fitting = TRUE)
       name          n n.error bin.RSS bin.error initial.signal n.residual
       fast 1024.10002      NA      NA        NA         0.7159          0
     medium 1038.67406      NA      NA        NA         0.1954          0
       slow 9230.12602      NA      NA        NA         0.0711       4147
 Background   45.71157      NA      NA        NA         0.0176         NA
> plot_OSLcurve(curve, components)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("decompose_OSLcurve", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("fit_OSLcurve")
> ### * fit_OSLcurve
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: fit_OSLcurve
> ### Title: Multi-exponential CW-OSL curve fitting
> ### Aliases: fit_OSLcurve
> 
> ### ** Examples
> 
> 
> # Create a simple curve with just one component
> curve <- data.frame(
+   X = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12),
+   Y = c(377, 244, 163, 93, 59, 28, 17, 13, 10, 8, 9, 5))
> # Perform fitting
> components <- fit_OSLcurve(curve, F.threshold = 3)

Decay rates (s^-1):
Cycle 	    Comp. 1     Comp. 2     Comp. 3     Comp. 4     Comp. 5         RSS     F-value
K = 1 	     0.4594                                                       359.9         Inf 
K = 2 	     0.4594      0.4594                                           359.9  -5.554e-09 
Left loop because F-test value (F = -5.554e-09) fell below threshold value (F = 3)
-> The F-test suggests the K = 1 model 

Photoionisation cross sections (cm^2):
Cycle 	  Comp. 1              Comp. 2              Comp. 3              Comp. 4              Comp. 5             
K = 1 	 6.47e-18 (Medium)    
K = 2 	 6.47e-18 (Medium)    6.47e-18 (Medium.a)  
-> Most known quartz OSL components found in the K = 2 model 
> 
> # Display results
> plot_OSLcurve(curve, components)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("fit_OSLcurve", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("optimise_OSLintervals")
> ### * optimise_OSLintervals
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: optimise_OSLintervals
> ### Title: Find adequate integration intervals for CW-OSL decomposition
> ### Aliases: optimise_OSLintervals
> 
> ### ** Examples
> 
> 
> A <- optimise_OSLintervals(c(2, 0.5, 0.02), channel.width = 0.1, channel.number = 200)
Maximum determinant = 0.09007 with interval dividing channels at i = 9, 54 
> print(A, row.names = FALSE)
        name lambda t.start t.end ch.start ch.end
 Component 1   2.00     0.0   0.9        1      9
 Component 2   0.50     0.9   5.4       10     54
 Component 3   0.02     5.4  20.0       55    200
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("optimise_OSLintervals", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("plot_OSLcurve")
> ### * plot_OSLcurve
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: plot_OSLcurve
> ### Title: Advanced plot function for component resolved CW-OSL curves
> ### Aliases: plot_OSLcurve
> 
> ### ** Examples
> 
> 
> # Set some arbitrary decay parameter for a dim CW-OSL measurement of quartz
> components <- data.frame(name = c("fast", "medium", "slow"),
+                          lambda = c(2, 0.5, 0.02),
+                          n = c(1000, 1000, 10000))
> 
> # Simulate a CW-OSL curve including some signal noise
> curve <- simulate_OSLcomponents(components, simulate.curve = TRUE, add.poisson.noise = TRUE)
> 
> # Display the simulated curve
> plot_OSLcurve(curve, components)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("plot_OSLcurve", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("plot_PhotoCrosssections")
> ### * plot_PhotoCrosssections
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: plot_PhotoCrosssections
> ### Title: Plot comparison of CW-OSL component photoionisation cross
> ###   sections of different models
> ### Aliases: plot_PhotoCrosssections
> 
> ### ** Examples
> 
> 
> # Set some arbitrary decay parameter for a dim CW-OSL measurement of quartz
> name <- c("fast", "slow")
> lambda <- c(2, 0.02)
> n <- c(1e6, 5e7)
> 
> # Build a component table
> components <- data.frame(name, lambda, n)
> 
> # Simulate the CW-OSL curve and add some signal noise
> curve <- simulate_OSLcomponents(components, simulate.curve = TRUE, add.poisson.noise = TRUE)
> 
> # Perform nonlinear regression at the simulated curve
> fit_results <- fit_OSLcurve(curve, K.max = 2, output.complex = TRUE)

Decay rates (s^-1):
Cycle 	    Comp. 1     Comp. 2         RSS     F-value
K = 1 	    0.02635               8.562e+10         Inf 
K = 2 	      2.002     0.02001   2.739e+07   6.187e+05 
Left loop because maximum number of allowed components K is reached
-> The F-test suggests the K = 2 model 

Photoionisation cross sections (cm^2):
Cycle 	  Comp. 1              Comp. 2             
K = 1 	 3.71e-19 (Slow2)     
K = 2 	 2.82e-17 (Fast)      2.82e-19 (Slow2)     
-> Most known quartz OSL components found in the K = 2 model 
> 
> # Plot the fitting iterations and set them into context
> plot_PhotoCrosssections(fit_results)
Warning in rep(1:9, 21) * (10^rep(-25:-15, each = 9)) :
  longer object length is not a multiple of shorter object length
> 
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("plot_PhotoCrosssections", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("simulate_OSLcomponents")
> ### * simulate_OSLcomponents
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: simulate_OSLcomponents
> ### Title: Simulates signal component decay curves and whole CW-OSL curves
> ### Aliases: simulate_OSLcomponents
> 
> ### ** Examples
> 
> 
> # Set some arbitrary decay parameter for a dim CW-OSL measurement of quartz
> components <- data.frame(name = c("fast", "medium", "slow"),
+                          lambda = c(2, 0.5, 0.02),
+                          n = c(1000, 1000, 10000))
> 
> # Simulate the CW-OSL curve and add some signal noise
> curve <- simulate_OSLcomponents(components, simulate.curve = TRUE, add.poisson.noise = TRUE)
> 
> # Display the simulated curve
> plot_OSLcurve(curve, components)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("simulate_OSLcomponents", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("sum_OSLcurves")
> ### * sum_OSLcurves
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: sum_OSLcurves
> ### Title: Combine RLum OSL records to one global average curve
> ### Aliases: sum_OSLcurves
> 
> ### ** Examples
> 
> 
> # 'FB_10Gy' is a dose recovery test with the Fontainebleau quartz
> # measured in a lexsyg research with green LED stimulation
> data_path <- system.file("examples", "FB_10Gy_SAR.bin", package = "OSLdecomposition")
> data_set <- Luminescence::read_BIN2R(data_path, fastForward = TRUE)

[read_BIN2R()]
	 >> /Users/kreutzer/GitHub/Luminescence/Luminescence.BuildResults/OSLdecomposition.Rcheck/OSLdecomposition/examples/FB_10Gy_SAR.bin
  |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%
	 >> 154 records have been read successfully!

> 
> # Give average CW-OSL curve back
> average_curve <- sum_OSLcurves(data_set)
Built global average curve from arithmetic means from first 999 data points of all 154 OSL records
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("sum_OSLcurves", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> ### * <FOOTER>
> ###
> cleanEx()
> options(digits = 7L)
> base::cat("Time elapsed: ", proc.time() - base::get("ptime", pos = 'CheckExEnv'),"\n")
Time elapsed:  4.715 0.323 5.047 0 0 
> grDevices::dev.off()
null device 
          1 
> ###
> ### Local variables: ***
> ### mode: outline-minor ***
> ### outline-regexp: "\\(> \\)?### [*]+" ***
> ### End: ***
> quit('no')
