<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Function to create an Abanico Plot. — plot_AbanicoPlot • Luminescence</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Function to create an Abanico Plot. — plot_AbanicoPlot"><meta property="og:description" content="A plot is produced which allows comprehensive presentation of data precision
and its dispersion around a central value as well as illustration of a
kernel density estimate, histogram and/or dot plot of the dose values."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.19</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/R-Lum/Luminescence/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function to create an Abanico Plot.</h1>
    <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/HEAD/R/plot_AbanicoPlot.R" class="external-link"><code>R/plot_AbanicoPlot.R</code></a></small>
    <div class="hidden name"><code>plot_AbanicoPlot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A plot is produced which allows comprehensive presentation of data precision
and its dispersion around a central value as well as illustration of a
kernel density estimate, histogram and/or dot plot of the dose values.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>
  <span class="va">data</span>,
  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,
  log.z <span class="op">=</span> <span class="cn">TRUE</span>,
  z.0 <span class="op">=</span> <span class="st">"mean.weighted"</span>,
  dispersion <span class="op">=</span> <span class="st">"qr"</span>,
  plot.ratio <span class="op">=</span> <span class="fl">0.75</span>,
  rotate <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">mtext</span>,
  <span class="va">summary</span>,
  <span class="va">summary.pos</span>,
  summary.method <span class="op">=</span> <span class="st">"MCM"</span>,
  <span class="va">legend</span>,
  <span class="va">legend.pos</span>,
  <span class="va">stats</span>,
  rug <span class="op">=</span> <span class="cn">FALSE</span>,
  kde <span class="op">=</span> <span class="cn">TRUE</span>,
  hist <span class="op">=</span> <span class="cn">FALSE</span>,
  dots <span class="op">=</span> <span class="cn">FALSE</span>,
  boxplot <span class="op">=</span> <span class="cn">FALSE</span>,
  y.axis <span class="op">=</span> <span class="cn">TRUE</span>,
  error.bars <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">bar</span>,
  <span class="va">bar.col</span>,
  <span class="va">polygon.col</span>,
  <span class="va">line</span>,
  <span class="va">line.col</span>,
  <span class="va">line.lty</span>,
  <span class="va">line.label</span>,
  <span class="va">grid.col</span>,
  frame <span class="op">=</span> <span class="fl">1</span>,
  bw <span class="op">=</span> <span class="st">"SJ"</span>,
  interactive <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> or <a href="RLum.Results-class.html">RLum.Results</a> object (<strong>required</strong>):
for <code>data.frame</code> two columns: De (<code>data[,1]</code>) and De error (<code>data[,2]</code>).
To plot several data sets in one plot the data sets must be provided as
<code>list</code>, e.g. <code>list(data.1, data.2)</code>.</p></dd>
<dt>na.rm</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
exclude NA values from the data set prior to any further operations.</p></dd>
<dt>log.z</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
Option to display the z-axis in logarithmic scale. Default is <code>TRUE</code>.</p></dd>
<dt>z.0</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> or <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a>:
User-defined central value, used for centring of data. One out of <code>"mean"</code>,
<code>"mean.weighted"</code> and <code>"median"</code> or a numeric value (not its logarithm).
Default is <code>"mean.weighted"</code>.</p></dd>
<dt>dispersion</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
measure of dispersion, used for drawing the scatter polygon. One out of</p><ul><li><p><code>"qr"</code> (quartile range),</p></li>
<li><p><code>"pnn"</code> (symmetric percentile range with <code>nn</code> the lower percentile, e.g.</p></li>
<li><p><code>"p05"</code> depicting the range between 5 and 95 %),</p></li>
<li><p><code>"sd"</code> (standard deviation) and</p></li>
<li><p><code>"2sd"</code> (2 standard deviations),</p></li>
</ul><p>The default is <code>"qr"</code>. Note that <code>"sd"</code> and <code>"2sd"</code> are only meaningful in
combination with <code>"z.0 = 'mean'"</code> because the unweighted mean is used to
centre the polygon.</p></dd>
<dt>plot.ratio</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a>:
Relative space, given to the radial versus the cartesian plot part,
default is <code>0.75</code>.</p></dd>
<dt>rotate</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a>:
Option to turn the plot by 90 degrees.</p></dd>
<dt>mtext</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a>:
additional text below the plot title.</p></dd>
<dt>summary</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>optional</em>):
add statistic measures of centrality and dispersion to the plot.
Can be one or more of several keywords. See details for available keywords.
Results differ depending on the log-option for the z-scale (see details).</p></dd>
<dt>summary.pos</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> or <a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
optional position coordinates or keyword (e.g. <code>"topright"</code>) for the
statistical summary. Alternatively, the keyword <code>"sub"</code> may be
specified to place the summary below the plot header. However, this latter
option in only possible if <code>mtext</code> is not used.</p></dd>
<dt>summary.method</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
keyword indicating the method used to calculate the statistic summary.
One out of</p><ul><li><p><code>"unweighted"</code>,</p></li>
<li><p><code>"weighted"</code> and</p></li>
<li><p><code>"MCM"</code>.</p></li>
</ul><p>See <a href="calc_Statistics.html">calc_Statistics</a> for details.</p></dd>
<dt>legend</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> vector (<em>optional</em>):
legend content to be added to the plot.</p></dd>
<dt>legend.pos</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> or <a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
optional position coordinates or keyword (e.g. <code>"topright"</code>)
for the legend to be plotted.</p></dd>
<dt>stats</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a>:
additional labels of statistically important values in the plot.
One or more out of the following:</p><ul><li><p><code>"min"</code>,</p></li>
<li><p><code>"max"</code>,</p></li>
<li><p><code>"median"</code>.</p></li>
</ul></dd>
<dt>rug</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a>:
Option to add a rug to the KDE part, to indicate the location of individual values.</p></dd>
<dt>kde</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a>:
Option to add a KDE plot to the dispersion part, default is <code>TRUE</code>.</p></dd>
<dt>hist</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a>:
Option to add a histogram to the dispersion part. Only meaningful when not
more than one data set is plotted.</p></dd>
<dt>dots</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a>:
Option to add a dot plot to the dispersion part. If number of dots exceeds
space in the dispersion part, a square indicates this.</p></dd>
<dt>boxplot</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a>:
Option to add a boxplot to the dispersion part, default is <code>FALSE</code>.</p></dd>
<dt>y.axis</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a>: Option to hide standard y-axis labels and show 0 only.
Useful for data with small scatter. If you want to suppress the y-axis entirely
please use <code>yaxt == 'n'</code> (the standard <a href="https://rdrr.io/r/graphics/par.html" class="external-link">graphics::par</a> setting) instead.</p></dd>
<dt>error.bars</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a>:
Option to show De-errors as error bars on De-points. Useful in combination
with <code>y.axis = FALSE, bar.col = "none"</code>.</p></dd>
<dt>bar</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
option to add one or more dispersion bars (i.e., bar showing the 2-sigma range)
centred at the defined values. By default a bar is drawn according to <code>"z.0"</code>.
To omit the bar set <code>"bar = FALSE"</code>.</p></dd>
<dt>bar.col</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> or <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
colour of the dispersion bar. Default is <code>"grey60"</code>.</p></dd>
<dt>polygon.col</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> or <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
colour of the polygon showing the data scatter. Sometimes this
polygon may be omitted for clarity. To disable it use <code>FALSE</code> or
<code>polygon = FALSE</code>. Default is <code>"grey80"</code>.</p></dd>
<dt>line</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a>:
numeric values of the additional lines to be added.</p></dd>
<dt>line.col</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> or <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a>:
colour of the additional lines.</p></dd>
<dt>line.lty</dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a>:
line type of additional lines</p></dd>
<dt>line.label</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a>:
labels for the additional lines.</p></dd>
<dt>grid.col</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> or <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
colour of the grid lines (originating at <code>[0,0]</code> and stretching to
the z-scale). To disable grid lines use <code>FALSE</code>. Default is <code>"grey"</code>.</p></dd>
<dt>frame</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
option to modify the plot frame type. Can be one out of</p><ul><li><p><code>0</code> (no frame),</p></li>
<li><p><code>1</code> (frame originates at 0,0 and runs along min/max isochrons),</p></li>
<li><p><code>2</code> (frame embraces the 2-sigma bar),</p></li>
<li><p><code>3</code> (frame embraces the entire plot as a rectangle).</p></li>
</ul><p>Default is <code>1</code>.</p></dd>
<dt>bw</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
bin-width for KDE, choose a numeric value for manual setting.</p></dd>
<dt>interactive</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
create an interactive abanico plot (requires the <code>'plotly'</code> package)</p></dd>
<dt>...</dt>
<dd><p>Further plot arguments to pass (see <a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">graphics::plot.default</a>). Supported are: <code>main</code>, <code>sub</code>, <code>ylab</code>, <code>xlab</code>, <code>zlab</code>, <code>zlim</code>, <code>ylim</code>, <code>cex</code>, <code>lty</code>, <code>lwd</code>, <code>pch</code>, <code>col</code>, <code>tck</code>, <code>tcl</code>, <code>at</code>, <code>breaks</code>. <code>xlab</code> must be a vector of length two, specifying the upper and lower x-axes labels.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>returns a plot object and, optionally, a list with plot calculus data.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The Abanico Plot is a combination of the classic Radial Plot
(<code>plot_RadialPlot</code>) and a kernel density estimate plot (e.g
<code>plot_KDE</code>). It allows straightforward visualisation of data precision,
error scatter around a user-defined central value and the combined
distribution of the values, on the actual scale of the measured data (e.g.
seconds, equivalent dose, years). The principle of the plot is shown in
Galbraith &amp; Green (1990). The function authors are thankful for the
thought provoking figure in this article.</p>
<p>The semi circle (z-axis) of the classic Radial Plot is bent to a straight
line here, which actually is the basis for combining this polar (radial)
part of the plot with any other Cartesian visualisation method
(KDE, histogram, PDF and so on). Note that the plot allows displaying
two measures of distribution. One is the 2-sigma
bar, which illustrates the spread in value errors, and the other is the
polygon, which stretches over both parts of the Abanico Plot (polar and
Cartesian) and illustrates the actual spread in the values themselves.</p>
<p>Since the 2-sigma-bar is a polygon, it can be (and is) filled with shaded
lines. To change density (lines per inch, default is 15) and angle (default
is 45 degrees) of the shading lines, specify these parameters. See
<code>?polygon()</code> for further help.</p>
<p>The Abanico Plot supports other than the weighted mean as measure of
centrality. When it is obvious that the data
is not (log-)normally distributed, the mean (weighted or not) cannot be a
valid measure of centrality and hence central dose. Accordingly, the median
and the weighted median can be chosen as well to represent a proper measure
of centrality (e.g. <code>centrality = "median.weighted"</code>). Also
user-defined numeric values (e.g. from the central age model) can be used if
this appears appropriate.</p>
<p>The proportion of the polar part and the cartesian part of the Abanico Plot
can be modified for display reasons (<code>plot.ratio = 0.75</code>). By default,
the polar part spreads over 75 \<!-- % and leaves 25 \\% for the part that -->
shows the KDE graph.</p>
<p>A statistic summary, i.e. a collection of statistic measures of
centrality and dispersion (and further measures) can be added by specifying
one or more of the following keywords:</p><ul><li><p><code>"n"</code> (number of samples)</p></li>
<li><p><code>"mean"</code> (mean De value)</p></li>
<li><p><code>"median"</code> (median of the De values)</p></li>
<li><p><code>"sd.rel"</code> (relative standard deviation in percent)</p></li>
<li><p><code>"sd.abs"</code> (absolute standard deviation)</p></li>
<li><p><code>"se.rel"</code> (relative standard error)</p></li>
<li><p><code>"se.abs"</code> (absolute standard error)</p></li>
<li><p><code>"in.2s"</code> (percent of samples in 2-sigma range)</p></li>
<li><p><code>"kurtosis"</code> (kurtosis)</p></li>
<li><p><code>"skewness"</code> (skewness)</p></li>
</ul><p><strong>Note</strong> that the input data for the statistic summary is sent to the function
<code><a href="calc_Statistics.html">calc_Statistics()</a></code> depending on the log-option for the z-scale. If
<code>"log.z = TRUE"</code>, the summary is based on the logarithms of the input
data. If <code>"log.z = FALSE"</code> the linearly scaled data is used.</p>
<p><strong>Note</strong> as well, that <code>"calc_Statistics()"</code> calculates these statistic
measures in three different ways: <code>unweighted</code>, <code>weighted</code> and
<code>MCM-based</code> (i.e., based on Monte Carlo Methods). By default, the
MCM-based version is used. If you wish to use another method, indicate this
with the appropriate keyword using the argument <code>summary.method</code>.</p>
<p>The optional parameter <code>layout</code> allows to modify the entire plot more
sophisticated. Each element of the plot can be addressed and its properties
can be defined. This includes font type, size and decoration, colours and
sizes of all plot items. To infer the definition of a specific layout style
cf. <code><a href="get_Layout.html">get_Layout()</a></code> or type e.g., for the layout type <code>"journal"</code>
<code>get_Layout("journal")</code>. A layout type can be modified by the user by
assigning new values to the list object.</p>
<p>It is possible for the z-scale to specify where ticks are to be drawn
by using the parameter <code>at</code>, e.g. <code>at = seq(80, 200, 20)</code>, cf. function
documentation of <code>axis</code>. Specifying tick positions manually overrides a
<code>zlim</code>-definition.</p>
    </div>
    <div id="function-version">
    <h2>Function version</h2>
    <p>0.1.17</p>
    </div>
    <div id="how-to-cite">
    <h2>How to cite</h2>
    <p>Dietze, M., Kreutzer, S., 2022. plot_AbanicoPlot(): Function to create an Abanico Plot.. Function version 0.1.17. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., 2022. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.19. https://CRAN.R-project.org/package=Luminescence</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Galbraith, R. &amp; Green, P., 1990. Estimating the component ages
in a finite mixture. International Journal of Radiation Applications and
Instrumentation. Part D. Nuclear Tracks and Radiation Measurements, 17 (3),
197-206.</p>
<p>Dietze, M., Kreutzer, S., Burow, C., Fuchs, M.C., Fischer, M., Schmidt, C., 2015.
The abanico plot: visualising chronometric data with individual standard errors.
Quaternary Geochronology. doi:10.1016/j.quageo.2015.09.003</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="plot_RadialPlot.html">plot_RadialPlot</a>, <a href="plot_KDE.html">plot_KDE</a>, <a href="plot_Histogram.html">plot_Histogram</a>, <a href="plot_ViolinPlot.html">plot_ViolinPlot</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Michael Dietze, GFZ Potsdam (Germany)<br>
Sebastian Kreutzer, Geography &amp; Earth Sciences, Aberystwyth University (United Kingdom)<br>
Inspired by a plot introduced by Galbraith &amp; Green (1990)
, RLum Developer Team</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## load example data and recalculate to Gray</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.DeValues</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ExampleData.DeValues</span> <span class="op">&lt;-</span> <span class="va">ExampleData.DeValues</span><span class="op">$</span><span class="va">CA1</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## plot the example data straightforward</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with linear z-scale</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 log.z <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with output of the plot parameters</span></span>
<span class="r-in"><span class="va">plot1</span> <span class="op">&lt;-</span> <span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                          output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">plot1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ xlim         : num [1:2] 0 16.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ ylim         : num [1:2] -36.8 15.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ zlim         : num [1:2] 17.4 132.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ polar.box    : num [1:4] 0 16.1 -20.5 12.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ cartesian.box: num [1:4] 16.6 20.4 -20.5 12.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ plot.ratio   : num 0.788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ data         :List of 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ :'data.frame':	62 obs. of  10 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ De               : num [1:62] 19.7 26.2 31.5 31.9 36.2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ error            : num [1:62] 2.14 2.04 2.34 2.34 2.95 3.15 8.22 3.23 4.43 4.43 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ z                : num [1:62] 2.98 3.27 3.45 3.46 3.59 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ se               : num [1:62] 0.1086 0.0779 0.0743 0.0732 0.0816 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ z.central        : num [1:62] 4.13 4.13 4.13 4.13 4.13 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ precision        : num [1:62] 9.21 12.84 13.45 13.65 12.26 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ std.estimate     : num [1:62] -10.58 -11.1 -9.15 -9.09 -6.64 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ std.estimate.plot: num [1:62] -10.58 -11.1 -9.15 -9.09 -6.64 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ weights          : num [1:62] 0.0161 0.0161 0.0161 0.0161 0.0161 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ data.in.2s       : logi [1:62] FALSE FALSE FALSE FALSE FALSE FALSE ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ data.global  :'data.frame':	62 obs. of  10 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ De               : num [1:62] 19.7 26.2 31.5 31.9 36.2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ error            : num [1:62] 2.14 2.04 2.34 2.34 2.95 3.15 8.22 3.23 4.43 4.43 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ z                : num [1:62] 2.98 3.27 3.45 3.46 3.59 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ se               : num [1:62] 0.1086 0.0779 0.0743 0.0732 0.0816 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ z.central        : num [1:62] 4.13 4.13 4.13 4.13 4.13 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ precision        : num [1:62] 9.21 12.84 13.45 13.65 12.26 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ std.estimate     : num [1:62] -10.58 -11.1 -9.15 -9.09 -6.64 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ std.estimate.plot: num [1:62] -10.58 -11.1 -9.15 -9.09 -6.64 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ weights          : num [1:62] 0.0161 0.0161 0.0161 0.0161 0.0161 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ data set         : num [1:62] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ KDE          :List of 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : num [1:514, 1:2] 2.86 2.86 2.86 2.87 2.87 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ par          :List of 66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ xlog     : logi FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ylog     : logi FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ adj      : num 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ann      : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ask      : logi FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ bg       : chr "transparent"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ bty      : chr "o"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ cex      : num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ cex.axis : num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ cex.lab  : num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ cex.main : num 1.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ cex.sub  : num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ col      : chr "black"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ col.axis : chr "black"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ col.lab  : chr "black"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ col.main : chr "black"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ col.sub  : chr "black"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ crt      : num 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ err      : int 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ family   : chr ""</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ fg       : chr "black"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ fig      : num [1:4] 0 1 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ fin      : num [1:2] 6.67 6.67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ font     : int 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ font.axis: int 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ font.lab : int 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ font.main: int 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ font.sub : int 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ lab      : int [1:3] 5 5 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ las      : int 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ lend     : chr "round"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ lheight  : num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ljoin    : chr "round"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ lmitre   : num 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ lty      : chr "solid"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ lwd      : num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ mai      : num [1:4] 0.9 0.9 0.7 1.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ mar      : num [1:4] 4.5 4.5 3.5 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ mex      : num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ mfcol    : int [1:2] 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ mfg      : int [1:4] 1 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ mfrow    : int [1:2] 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ mgp      : num [1:3] 3 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ mkh      : num 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ new      : logi FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ oma      : num [1:4] 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ omd      : num [1:4] 0 1 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ omi      : num [1:4] 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ pch      : int 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ pin      : num [1:2] 4.37 5.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ plt      : num [1:4] 0.135 0.79 0.135 0.895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ps       : int 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ pty      : chr "m"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ smo      : num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ srt      : num 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ tck      : num NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ tcl      : num -0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ usr      : num [1:4] 0 20.4 -36.8 15.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ xaxp     : num [1:3] 0 20 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ xaxs     : chr "r"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ xaxt     : chr "s"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ xpd      : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ yaxp     : num [1:3] -30 10 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ yaxs     : chr "r"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ yaxt     : chr "s"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ylbias   : num 0.2</span>
<span class="r-in"><span class="va">plot1</span><span class="op">$</span><span class="va">zlim</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  17.41711 132.85700</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with adjusted z-scale limits</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with adjusted x-scale limits</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with rug to indicate individual values in KDE part</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 rug <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-6.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with a smaller bandwidth for the KDE plot</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 bw <span class="op">=</span> <span class="fl">0.04</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-7.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with a histogram instead of the KDE plot</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 hist <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">                 kde <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-8.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with a KDE plot and histogram with manual number of bins</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 hist <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">                 breaks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-9.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with a KDE plot and a dot plot</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 dots <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-10.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with user-defined plot ratio</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 plot.ratio <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co">## now with user-defined central value</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 z.0 <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-12.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with median as central value</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 z.0 <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-13.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with the 17-83 percentile range as definition of scatter</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 z.0 <span class="op">=</span> <span class="st">"median"</span>,</span>
<span class="r-in">                 dispersion <span class="op">=</span> <span class="st">"p17"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-14.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with user-defined green line for minimum age model</span></span>
<span class="r-in"><span class="va">CAM</span> <span class="op">&lt;-</span> <span class="fu"><a href="calc_CentralDose.html">calc_CentralDose</a></span><span class="op">(</span><span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                        plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [calc_CentralDose]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------- meta data ----------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  n:                       62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  log:                     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------- dose estimate ------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  abs. central dose:       65.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  abs. SE:                 3.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rel. SE [%]:             4.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------- overdispersion -----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  abs. OD:                 22.79</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  abs. SE:                 2.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  OD [%]:                  34.69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  SE [%]:                  3.46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 line <span class="op">=</span> <span class="va">CAM</span>,</span>
<span class="r-in">                 line.col <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span class="r-in">                 line.label <span class="op">=</span> <span class="st">"CAM"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-15.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now create plot with legend, colour, different points and smaller scale</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 legend <span class="op">=</span> <span class="st">"Sample 1"</span>,</span>
<span class="r-in">                 col <span class="op">=</span> <span class="st">"tomato4"</span>,</span>
<span class="r-in">                 bar.col <span class="op">=</span> <span class="st">"peachpuff"</span>,</span>
<span class="r-in">                 pch <span class="op">=</span> <span class="st">"R"</span>,</span>
<span class="r-in">                 cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-16.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now without 2-sigma bar, polygon, grid lines and central value line</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 bar.col <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">                 polygon.col <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">                 grid.col <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">                 y.axis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">                 lwd <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-17.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with direct display of De errors, without 2-sigma bar</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 bar.col <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">                 ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span class="r-in">                 y.axis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">                 error.bars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-18.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with user-defined axes labels</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Data error (%)"</span>,</span>
<span class="r-in">                          <span class="st">"Data precision"</span><span class="op">)</span>,</span>
<span class="r-in">                 ylab <span class="op">=</span> <span class="st">"Scatter"</span>,</span>
<span class="r-in">                 zlab <span class="op">=</span> <span class="st">"Equivalent dose [Gy]"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-19.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with minimum, maximum and median value indicated</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"median"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-20.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with a brief statistical summary as subheader</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 summary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"in.2s"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-21.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with another statistical summary</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 summary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean.weighted"</span>, <span class="st">"median"</span><span class="op">)</span>,</span>
<span class="r-in">                 summary.pos <span class="op">=</span> <span class="st">"topleft"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-22.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now a plot with two 2-sigma bars for one data set</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-23.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now the data set is split into sub-groups, one is manipulated</span></span>
<span class="r-in"><span class="va">data.1</span> <span class="op">&lt;-</span> <span class="va">ExampleData.DeValues</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>,<span class="op">]</span></span>
<span class="r-in"><span class="va">data.2</span> <span class="op">&lt;-</span> <span class="va">ExampleData.DeValues</span><span class="op">[</span><span class="fl">31</span><span class="op">:</span><span class="fl">62</span>,<span class="op">]</span> <span class="op">*</span> <span class="fl">1.3</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now a common dataset is created from the two subgroups</span></span>
<span class="r-in"><span class="va">data.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">data.1</span>, <span class="va">data.2</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now the two data sets are plotted in one plot</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data.3</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-24.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with some graphical modification</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data.3</span>,</span>
<span class="r-in">                 z.0 <span class="op">=</span> <span class="st">"median"</span>,</span>
<span class="r-in">                 col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue4"</span>, <span class="st">"orange4"</span><span class="op">)</span>,</span>
<span class="r-in">                 bar.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue3"</span>, <span class="st">"orange3"</span><span class="op">)</span>,</span>
<span class="r-in">                 polygon.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue1"</span>, <span class="st">"orange1"</span><span class="op">)</span>,</span>
<span class="r-in">                 pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span class="r-in">                 angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span class="r-in">                 summary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"in.2s"</span>, <span class="st">"median"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-25.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## create Abanico plot with predefined layout definition</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                 layout <span class="op">=</span> <span class="st">"journal"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-26.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with predefined layout definition and further modifications</span></span>
<span class="r-in"><span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data.3</span>,</span>
<span class="r-in">                 z.0 <span class="op">=</span> <span class="st">"median"</span>,</span>
<span class="r-in">                 layout <span class="op">=</span> <span class="st">"journal"</span>,</span>
<span class="r-in">                 col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue4"</span>, <span class="st">"orange4"</span><span class="op">)</span>,</span>
<span class="r-in">                 bar.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue3"</span>, <span class="st">"orange3"</span><span class="op">)</span>,</span>
<span class="r-in">                                       alpha.f <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span class="r-in">                 polygon.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue3"</span>, <span class="st">"orange3"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-27.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## for further information on layout definitions see documentation</span></span>
<span class="r-in"><span class="co">## of function get_Layout()</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## now with manually added plot content</span></span>
<span class="r-in"><span class="co">## create empty plot with numeric output</span></span>
<span class="r-in"><span class="va">AP</span> <span class="op">&lt;-</span> <span class="fu">plot_AbanicoPlot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span>,</span>
<span class="r-in">                       pch <span class="op">=</span> <span class="cn">NA</span>,</span>
<span class="r-in">                       output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## identify data in 2 sigma range</span></span>
<span class="r-in"><span class="va">in_2sigma</span> <span class="op">&lt;-</span> <span class="va">AP</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data.in.2s</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## restore function-internal plot parameters</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">AP</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## add points inside 2-sigma range</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">AP</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">precision</span><span class="op">[</span><span class="va">in_2sigma</span><span class="op">]</span>,</span>
<span class="r-in">       y <span class="op">=</span> <span class="va">AP</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">std.estimate.plot</span><span class="op">[</span><span class="va">in_2sigma</span><span class="op">]</span>,</span>
<span class="r-in">       pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## add points outside 2-sigma range</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">AP</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">precision</span><span class="op">[</span><span class="op">!</span><span class="va">in_2sigma</span><span class="op">]</span>,</span>
<span class="r-in">       y <span class="op">=</span> <span class="va">AP</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">std.estimate.plot</span><span class="op">[</span><span class="op">!</span><span class="va">in_2sigma</span><span class="op">]</span>,</span>
<span class="r-in">       pch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_AbanicoPlot-28.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze,
Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes
Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin
Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

