<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Combine Dose Rate and Equivalent Dose Distribution — combine_De_Dr • Luminescence</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Combine Dose Rate and Equivalent Dose Distribution — combine_De_Dr"><meta property="og:description" content="A Bayesian statistical analysis of OSL age requiring dose rate sample.
Estimation contains a preliminary step for detecting outliers in the equivalent
dose sample."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.21</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/index.html">
    <span class="fa fa-play"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../news/NEWS_Version0.9.0.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence" class="external-link">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Combine Dose Rate and Equivalent Dose Distribution</h1>
    <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/HEAD/R/combine_De_Dr.R" class="external-link"><code>R/combine_De_Dr.R</code></a></small>
    <div class="hidden name"><code>combine_De_Dr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A Bayesian statistical analysis of OSL age requiring dose rate sample.
Estimation contains a preliminary step for detecting outliers in the equivalent
dose sample.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">combine_De_Dr</span><span class="op">(</span></span>
<span>  <span class="va">De</span>,</span>
<span>  <span class="va">s</span>,</span>
<span>  <span class="va">Dr</span>,</span>
<span>  <span class="va">int_OD</span>,</span>
<span>  Age_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">300</span><span class="op">)</span>,</span>
<span>  outlier_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  outlier_method <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  outlier_analysis_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  method_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  par_local <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>De</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>): a equivalent dose sample</p></dd>


<dt>s</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>): a vector of measurement errors on the equivalent dose</p></dd>


<dt>Dr</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>): a dose rate sample</p></dd>


<dt>int_OD</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>): the intrinsic overdispersion, typically the standard deviation
characterizing a dose-recovery test distribution</p></dd>


<dt>Age_range</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>): the age range to be investigated by the algorithm, the larger
the value the more iterations are needed and the longer it takes. Should not be set too narrow, cut
the algorithm some slack.</p></dd>


<dt>outlier_threshold</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>): the required significance level used
for the outlier detection. If set to <code>1</code>, no outliers are removed. If
<code>outlier_method = "RousseeuwCroux1993"</code>, the median distance is used as outlier threshold.
Please see details for further information.</p></dd>


<dt>outlier_method</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>): select the outlier detection
method, either <code>"default"</code> or <code>"RousseeuwCroux1993"</code>. See details for further information.</p></dd>


<dt>outlier_analysis_plot</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>): enables/disables the outlier analysis plot. Note: the outlier analysis will happen with or without plot output</p></dd>


<dt>method_control</dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> (<em>with default</em>): named <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> of further parameters passed down
to the <a href="https://rdrr.io/pkg/rjags/man/rjags-package.html" class="external-link">rjags::rjags</a> modelling</p></dd>


<dt>par_local</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>): if set to <code>TRUE</code> the function uses its
own <a href="https://rdrr.io/r/graphics/par.html" class="external-link">graphics::par</a> settings (which will end in two plots next to each other)</p></dd>


<dt>verbose</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>): enable/disable terminal feedback</p></dd>


<dt>plot</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>): enable/disable plot output</p></dd>


<dt>...</dt>
<dd><p>a few further arguments to fine-tune the plot output such as
<code>cdf_ADr_quantiles</code> (<code>TRUE</code>/<code>FALSE</code>), <code>legend.pos</code>, <code>legend</code> (<code>TRUE</code>/<code>FALSE</code>)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The function returns a plot if <code>plot = TRUE</code> and an <a href="RLum.Results-class.html">RLum.Results</a></p>


<p>object with the following slots:</p>


<p><code>@data</code><br></p>


<p><code>.. $Ages</code>: a <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> vector with the modelled ages to be further analysed or visualised<br></p>


<p><code>.. $Ages_stats</code>: a <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> with sum HPD, CI 68% and CI 95% for the ages <br></p>


<p><code>.. $outliers_index</code>: the index with the detected outliers<br></p>


<p><code>.. $cdf_ADr_mean</code> : empirical cumulative density distribution A * Dr (mean)<br></p>


<p><code>.. $cdf_ADr_quantiles</code> : empirical cumulative density distribution A * Dr (quantiles .025,.975)<br></p>


<p><code>.. $cdf_De_no_outlier</code> : empirical cumulative density distribution of the De with no outliers<br></p>


<p><code>.. $cdf_De_initial</code> : empirical cumulative density distribution of the initial De<br></p>


<p><code>.. $mcmc_IAM</code> : the MCMC list of the Individual Age Model, only of <code>method_control = list(return_mcmc = TRUE)</code> otherwise <code>NULL</code><br></p>


<p><code>.. $mcmc_BCAM</code> : the MCMC list of the Bayesian Central Age Model, only of <code>method_control = list(return_mcmc = TRUE)</code> otherwise <code>NULL</code><br></p>



<p><code>@info</code><br></p>


<p><code>.. $call</code>: the original function call<br></p>


<p><code>.. $model_IAM</code>: the BUGS model used to derive the individual age<br></p>


<p><code>.. $model_BCAM</code>: the BUGS model used to calculate the Bayesian Central Age<br></p>


    </div>
    <div id="details">
    <h2>Details</h2>
    <p><strong>Outlier detection</strong></p>
<p>Two different outlier detection methods are implemented (full details are given
in the cited literature).</p><ol><li><p>The <em>default</em> and recommend method, uses quantiles to compare prior and
posterior distributions of the individual variances of the equivalent doses.
If the corresponding quantile in the corresponding posterior distribution is larger
than the quantile in the prior distribution, the value is marked
as outlier (cf. Galharret et al., preprint)</p></li>
<li><p>The alternative method employs the method suggested by Rousseeuw and Croux (1993)
using the absolute median distance.</p></li>
</ol><p><strong>Parameters available for <code>method_control</code></strong></p>
<p>The parameters listed below are used to granular control Bayesian modelling using
<a href="https://rdrr.io/pkg/rjags/man/rjags-package.html" class="external-link">rjags::rjags</a>. Internally the functions <code>.calc_IndividualAgeModel()</code> and
<code>.calc_BayesianCentraAgelModel()</code>. The parameter settings affect both models.
Note: <code>method_control</code> expects a <strong>named</strong> list of parameters</p>
<table class="table table"><tr><td><strong>PARAMETER</strong></td><td><strong>TYPE</strong></td><td><strong>DEFAULT</strong></td><td><strong>REMARKS</strong></td></tr><tr><td><code>variable.names_IAM</code></td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td><code>c('A', 'a', 'sig_a')</code></td><td>variables names to be monitored in the modelling process using the internal function <code>.calc_IndividualAgeModel()</code></td></tr><tr><td><code>variable.names_BCAM</code></td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td><code>c('A', 'D_e')</code></td><td>variables names to be monitored in the modelling process using the internal function <code>.calc_BayesianCentraAgelModel()</code></td></tr><tr><td><code>n.chains</code></td><td><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></td><td><code>4</code></td><td>number of MCMC chains</td></tr><tr><td><code>n.adapt</code></td><td><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></td><td><code>1000</code></td><td>number of iterations for the adaptation</td></tr><tr><td><code>n.iter</code></td><td><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></td><td><code>5000</code></td><td>number of iterations to monitor cf. <a href="https://rdrr.io/pkg/rjags/man/coda.samples.html" class="external-link">rjags::coda.samples</a></td></tr><tr><td><code>thin</code></td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td><code>1</code></td><td>thinning interval for the monitoring cf. <a href="https://rdrr.io/pkg/rjags/man/coda.samples.html" class="external-link">rjags::coda.samples</a></td></tr><tr><td><code>diag</code></td><td><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></td><td><code>FALSE</code></td><td>additional terminal convergence diagnostic.
<code>FALSE</code> if <code>verbose = FALSE</code></td></tr><tr><td><code>progress.bar</code></td><td><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></td><td><code>FALSE</code></td><td>enable/disable progress bar. <code>FALSE</code> if <code>verbose = FALSE</code></td></tr><tr><td><code>quiet</code></td><td><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></td><td><code>TRUE</code></td><td>silence terminal output. Set to <code>TRUE</code> if <code>verbose = FALSE</code></td></tr><tr><td><code>return_mcmc</code></td><td><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></td><td><code>FALSE</code></td><td>return additional MCMC diagnostic information</td></tr></table></div>
    <div id="function-version">
    <h2>Function version</h2>
    <p>0.1.0</p>
    </div>
    <div id="how-to-cite">
    <h2>How to cite</h2>
    <p>Philippe, A., Galharret, J., Mercier, N., Kreutzer, S., 2023. combine_De_Dr(): Combine Dose Rate and Equivalent Dose Distribution. Function version 0.1.0. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., 2023. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.21. https://CRAN.R-project.org/package=Luminescence</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Mercier, N., Galharret, J.-M., Tribolo, C., Kreutzer, S., Philippe, A., preprint.
Luminescence age calculation through Bayesian convolution of equivalent dose and
dose-rate distributions: the De_Dr model. Geochronology, 1-22.</p>
<p>Galharret, J-M., Philippe, A., Mercier, N., preprint. Detection of outliers with
a Bayesian hierarchical model: application to the single-grain luminescence dating method.
Electronic Journal of Applied Statistics</p>
<p><strong>Further reading</strong></p>
<p>Rousseeuw, P.J., Croux, C., 1993. Alternatives to the median absolute deviation.
Journal of the American Statistical Association 88, 1273–1283. <a href="https://doi.org/10.2307/2291267" class="external-link">doi:10.2307/2291267</a></p>
<p>Rousseeuw, P.J., Debruyne, M., Engelen, S., Hubert, M., 2006. Robustness and outlier detection in chemometrics.
Critical Reviews in Analytical Chemistry 36, 221–242. <a href="https://doi.org/10.1080/10408340600969403" class="external-link">doi:10.1080/10408340600969403</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="plot_OSLAgeSummary.html">plot_OSLAgeSummary</a>, <a href="https://rdrr.io/pkg/rjags/man/rjags-package.html" class="external-link">rjags::rjags</a>, mclust-package</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Anne Philippe, Université de Nantes (France),
Jean-Michel Galharret, Université de Nantes (France),
Norbert Mercier, IRAMAT-CRP2A, Université Bordeaux Montaigne (France),
Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)
, RLum Developer Team</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## set parameters</span></span></span>
<span class="r-in"><span><span class="va">Dr</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span> <span class="op">(</span><span class="fl">1000</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">De</span> <span class="op">&lt;-</span> <span class="fl">50</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">Dr</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">10</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## run modelling</span></span></span>
<span class="r-in"><span><span class="co">## note: modify parameters for more realistic results</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">combine_De_Dr</span><span class="op">(</span></span></span>
<span class="r-in"><span> Dr <span class="op">=</span> <span class="va">Dr</span>,</span></span>
<span class="r-in"><span> int_OD <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span> <span class="va">De</span>,</span></span>
<span class="r-in"><span> <span class="va">s</span>,</span></span>
<span class="r-in"><span> Age_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> method_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  n.iter <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  n.chains <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## show models used</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">results</span><span class="op">@</span><span class="va">info</span><span class="op">$</span><span class="va">model_IAM</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">results</span><span class="op">@</span><span class="va">info</span><span class="op">$</span><span class="va">model_BCAM</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

