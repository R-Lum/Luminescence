<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Verify single grain data sets and check for invalid grains, i.e.
zero-light level grains — verify_SingleGrainData • Luminescence</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Verify single grain data sets and check for invalid grains, i.e.
zero-light level grains — verify_SingleGrainData" />
<meta property="og:description" content="This function tries to identify automatically zero-light level curves (grains)
from single grain data measurements." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Verify single grain data sets and check for invalid grains, i.e.
zero-light level grains</h1>
    <small class="dont-index">Source: <a href='https://github.com/R-Lum/Luminescence/blob/master/R/verify_SingleGrainData.R'><code>R/verify_SingleGrainData.R</code></a></small>
    <div class="hidden name"><code>verify_SingleGrainData.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function tries to identify automatically zero-light level curves (grains)
from single grain data measurements.</p>
    </div>

    <pre class="usage"><span class='fu'>verify_SingleGrainData</span><span class='op'>(</span>
  <span class='va'>object</span>,
  threshold <span class='op'>=</span> <span class='fl'>10</span>,
  cleanup <span class='op'>=</span> <span class='cn'>FALSE</span>,
  cleanup_level <span class='op'>=</span> <span class='st'>"aliquot"</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p><a href='Risoe.BINfileData-class.html'>Risoe.BINfileData</a> or <a href='RLum.Analysis-class.html'>RLum.Analysis</a> (<strong>required</strong>):
input object. The function also accepts a list with objects of allowed type.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (<em>with default</em>):
numeric threshold value for the allowed difference between the <code>mean</code> and
the <code>var</code> of the count values (see details)</p></td>
    </tr>
    <tr>
      <th>cleanup</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
if set to <code>TRUE</code> curves identified as zero light level curves are
automatically removed. Output is an object as same type as the input, i.e.
either <a href='Risoe.BINfileData-class.html'>Risoe.BINfileData</a> or <a href='RLum.Analysis-class.html'>RLum.Analysis</a></p></td>
    </tr>
    <tr>
      <th>cleanup_level</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (<em>with default</em>):
selects the level for the cleanup of the input data sets.
Two options are allowed: <code>"curve"</code> or <code>"aliquot"</code>:</p><ul>
<li><p>If  <code>"curve"</code> is selected every single curve marked as <code>invalid</code> is removed.</p></li>
<li><p>If <code>"aliquot"</code> is selected, curves of one aliquot (grain or disc) can be
marked as invalid, but will not be removed. An aliquot will be only removed
if all curves of this aliquot are marked as invalid.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
enables or disables the terminal feedback</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
enables or disables the graphical feedback</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns</p>
<p>-----------------------------------<br />
<code>[ NUMERICAL OUTPUT ]</code><br />
-----------------------------------<br /></p>
<p><strong><code>RLum.Results</code></strong>-object</p>
<p><strong>slot:****<code>@data</code></strong></p>
<table class='table'>
<tr><td><strong>Element</strong></td><td><strong>Type</strong></td><td><strong>Description</strong></td></tr>
<tr><td><code>$unique_pairs</code></td><td><code>data.frame</code></td><td>the unique position and grain pairs</td></tr>
<tr><td><code>$selection_id</code></td><td><code>numeric</code></td><td>the selection as record ID</td></tr>
<tr><td><code>$selection_full</code></td><td><code>data.frame</code></td><td>implemented models used in the baSAR-model core</td></tr>
</table>


<p><strong>slot:****<code>@info</code></strong></p>
<p>The original function call</p>
<p><strong>Output variation</strong></p>
<p>For <code>cleanup = TRUE</code> the same object as the input is returned, but cleaned up
(invalid curves were removed). This means: Either an <a href='Risoe.BINfileData-class.html'>Risoe.BINfileData</a>
or an <a href='RLum.Analysis-class.html'>RLum.Analysis</a> object is returned in such cases.
An <a href='Risoe.BINfileData-class.html'>Risoe.BINfileData</a> object can be exported to a BIN-file by
using the function <a href='write_R2BIN.html'>write_R2BIN</a>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><strong>How does the method work?</strong></p>
<p>The function compares the expected values (\(E(X)\)) and the variance
(\(Var(X)\)) of the count values for each curve. Assuming that the
background roughly follows a Poisson distribution the absolute difference
of both values should be zero or at least around zero as</p>
<p>$$E(x) = Var(x) = \lambda$$</p>
<p>Thus the function checks for:</p>
<p>$$abs(E(x) - Var(x)) &gt;= \Theta$$</p>
<p>With \(\Theta\) an arbitrary, user defined, threshold. Values above the
threshold indicating curves comprising a signal.</p>
<p>Note: the absolute difference of \(E(X)\) and \(Var(x)\) instead of the
ratio was chosen as both terms can become 0 which would result in 0 or <code>Inf</code>,
if the ratio is calculated.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function can work with <a href='Risoe.BINfileData-class.html'>Risoe.BINfileData</a> objects or
<a href='RLum.Analysis-class.html'>RLum.Analysis</a> objects (or a list of it). However, the function is
highly optimised for <a href='Risoe.BINfileData-class.html'>Risoe.BINfileData</a> objects as it make sense to
remove identify invalid grains before the conversion to an
<a href='RLum.Analysis-class.html'>RLum.Analysis</a> object.</p>
<p>The function checking for invalid curves works rather robust and it is likely
that Reg0 curves within a SAR cycle are removed as well. Therefore it is
strongly recommended to use the argument <code>cleanup = TRUE</code> carefully.</p>
    <h2 class="hasAnchor" id="function-version"><a class="anchor" href="#function-version"></a>Function version</h2>

    <p>0.2.1</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='Risoe.BINfileData-class.html'>Risoe.BINfileData</a>, <a href='RLum.Analysis-class.html'>RLum.Analysis</a>, <a href='write_R2BIN.html'>write_R2BIN</a>,
<a href='read_BIN2R.html'>read_BIN2R</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastian Kreutzer, Geography &amp; Earth Sciences, Aberystwyth University (United Kingdom)
, RLum Developer Team</p>
    <h2 class="hasAnchor" id="how-to-cite"><a class="anchor" href="#how-to-cite"></a>How to cite</h2>

    <p>Kreutzer, S., 2020. verify_SingleGrainData(): Verify single grain data sets and check for invalid grains, i.e. zero-light level grains. Function version 0.2.1. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Riedesel, S., Autzen, M., Mittelstrass, D., 2020. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.9. https://CRAN.R-project.org/package=Luminescence</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>##01 - basic example I</span>
<span class='co'>##just show how to apply the function</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>ExampleData.XSYG</span>, envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>environment</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>##verify and get data.frame out of it</span>
<span class='fu'>verify_SingleGrainData</span><span class='op'>(</span><span class='va'>OSL.SARMeasurement</span><span class='op'>$</span><span class='va'>Sequence.Object</span><span class='op'>)</span><span class='op'>$</span><span class='va'>selection_full</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: [verify_SingleGrainData()] selection_id is NA, nothing removed, everything selected!</span></div><div class='output co'>#&gt;     POSITION GRAIN      MEAN          VAR       RATIO THRESHOLD VALID
#&gt; 1         NA    NA  23.66271 2.572619e+02   10.872037        10  TRUE
#&gt; 2         NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE
#&gt; 3         NA    NA 146.85632 4.982419e+03   33.927165        10  TRUE
#&gt; 4         NA    NA  23.20000 4.901230e+03  211.259934        10  TRUE
#&gt; 5         NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 6         NA    NA 107.87043 7.125950e+02    6.606027        10 FALSE
#&gt; 7         NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 8         NA    NA  27.06067 3.495743e+02   12.918172        10  TRUE
#&gt; 9         NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 10        NA    NA 111.65882 2.120132e+04  189.875911        10  TRUE
#&gt; 11        NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE
#&gt; 12        NA    NA  94.00808 1.421120e+03   15.117001        10  TRUE
#&gt; 13        NA    NA  14.78800 1.018989e+02    6.890645        10 FALSE
#&gt; 14        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 15        NA    NA 107.90087 7.100111e+02    6.580216        10 FALSE
#&gt; 16        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 17        NA    NA  26.88278 3.521022e+02   13.097686        10  TRUE
#&gt; 18        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 19        NA    NA 203.04576 1.440995e+05  709.689721        10  TRUE
#&gt; 20        NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE
#&gt; 21        NA    NA 147.35434 4.941044e+03   33.531721        10  TRUE
#&gt; 22        NA    NA  18.48800 1.309212e+03   70.814165        10  TRUE
#&gt; 23        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 24        NA    NA 107.37241 7.180268e+02    6.687256        10 FALSE
#&gt; 25        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 26        NA    NA  26.53464 3.569946e+02   13.453909        10  TRUE
#&gt; 27        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 28        NA    NA 149.22647 4.077393e+04  273.235223        10  TRUE
#&gt; 29        NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE
#&gt; 30        NA    NA  93.65100 1.425739e+03   15.223959        10  TRUE
#&gt; 31        NA    NA  15.43400 1.468754e+02    9.516353        10 FALSE
#&gt; 32        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 33        NA    NA 107.74087 7.151408e+02    6.637600        10 FALSE
#&gt; 34        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 35        NA    NA  26.88278 3.521553e+02   13.099660        10  TRUE
#&gt; 36        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 37        NA    NA 437.18390 7.404312e+05 1693.637907        10  TRUE
#&gt; 38        NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE
#&gt; 39        NA    NA 146.74713 4.976541e+03   33.912357        10  TRUE
#&gt; 40        NA    NA  26.99200 8.015916e+03  296.973761        10  TRUE
#&gt; 41        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 42        NA    NA 107.87652 7.046340e+02    6.531857        10 FALSE
#&gt; 43        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 44        NA    NA  26.88079 3.520762e+02   13.097687        10  TRUE
#&gt; 45        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 46        NA    NA 183.18088 6.418055e+04  350.367102        10  TRUE
#&gt; 47        NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE
#&gt; 48        NA    NA  94.05556 1.416457e+03   15.059791        10  TRUE
#&gt; 49        NA    NA  16.43000 2.741815e+02   16.687855        10  TRUE
#&gt; 50        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 51        NA    NA 108.64071 6.910736e+02    6.361093        10 FALSE
#&gt; 52        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 53        NA    NA  27.62109 3.416066e+02   12.367601        10  TRUE
#&gt; 54        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 55        NA    NA 693.53644 1.868981e+06 2694.856789        10  TRUE
#&gt; 56        NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE
#&gt; 57        NA    NA 146.77471 4.985033e+03   33.963838        10  TRUE
#&gt; 58        NA    NA  41.61400 3.277204e+04  787.524417        10  TRUE
#&gt; 59        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 60        NA    NA 107.84087 7.062001e+02    6.548538        10 FALSE
#&gt; 61        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 62        NA    NA  26.89205 3.523737e+02   13.103264        10  TRUE
#&gt; 63        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 64        NA    NA 229.96912 1.033205e+05  449.279678        10  TRUE
#&gt; 65        NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE
#&gt; 66        NA    NA  94.09293 1.419207e+03   15.083033        10  TRUE
#&gt; 67        NA    NA  17.54000 4.446938e+02   25.353124        10  TRUE
#&gt; 68        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 69        NA    NA 107.82348 7.152073e+02    6.633131        10 FALSE
#&gt; 70        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 71        NA    NA  26.88212 3.521107e+02   13.098323        10  TRUE
#&gt; 72        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 73        NA    NA 919.37203 3.298185e+06 3587.432532        10  TRUE
#&gt; 74        NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE
#&gt; 75        NA    NA 146.25829 4.992561e+03   34.135236        10  TRUE
#&gt; 76        NA    NA  55.33200 7.126496e+04 1287.951921        10  TRUE
#&gt; 77        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 78        NA    NA 107.44397 7.226060e+02    6.725422        10 FALSE
#&gt; 79        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 80        NA    NA  26.70197 3.544455e+02   13.274131        10  TRUE
#&gt; 81        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 82        NA    NA 278.14412 1.553639e+05  558.573294        10  TRUE
#&gt; 83        NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE
#&gt; 84        NA    NA  94.03131 1.419523e+03   15.096277        10  TRUE
#&gt; 85        NA    NA  20.75400 7.620376e+02   36.717624        10  TRUE
#&gt; 86        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 87        NA    NA 108.72566 6.921674e+02    6.366182        10 FALSE
#&gt; 88        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 89        NA    NA  27.60612 3.412339e+02   12.360804        10  TRUE
#&gt; 90        NA    NA  15.83136 4.363311e+01    2.756120        10 FALSE
#&gt; 91        NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE
#&gt; 92        NA    NA 146.50230 4.921485e+03   33.593229        10  TRUE
#&gt; 93        NA    NA  13.75400 2.191331e+01    1.593232        10 FALSE
#&gt; 94        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 95        NA    NA 108.25351 6.988567e+02    6.455741        10 FALSE
#&gt; 96        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 97        NA    NA  27.23758 3.468351e+02   12.733694        10  TRUE
#&gt; 98        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 99        NA    NA 296.30735 1.763985e+05  595.322619        10  TRUE
#&gt; 100       NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE
#&gt; 101       NA    NA  93.99192 1.420900e+03   15.117255        10  TRUE
#&gt; 102       NA    NA  19.43600 8.624027e+02   44.371409        10  TRUE
#&gt; 103       NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 104       NA    NA 107.82174 7.110169e+02    6.594375        10 FALSE
#&gt; 105       NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 106       NA    NA  26.88344 3.521723e+02   13.099971        10  TRUE
#&gt; 107       NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 108       NA    NA 532.60085 1.130401e+06 2122.416765        10  TRUE
#&gt; 109       NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE
#&gt; 110       NA    NA 146.72471 4.962003e+03   33.818454        10  TRUE
#&gt; 111       NA    NA  27.52000 7.629970e+03  277.251800        10  TRUE
#&gt; 112       NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 113       NA    NA 107.92696 7.062523e+02    6.543799        10 FALSE
#&gt; 114       NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 115       NA    NA  26.87815 3.520057e+02   13.096354        10  TRUE
#&gt; 116       NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 117       NA    NA 302.94412 1.862969e+05  614.954596        10  TRUE
#&gt; 118       NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE
#&gt; 119       NA    NA  94.41327 1.419383e+03   15.033721        10  TRUE
#&gt; 120       NA    NA  20.19800 8.579387e+02   42.476417        10  TRUE
#&gt; 121       NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE
#&gt; 122       NA    NA 108.15702 6.957128e+02    6.432433        10 FALSE
#&gt; 123       NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE
#&gt; 124       NA    NA  27.24765 3.470933e+02   12.738468        10  TRUE</div><div class='input'>
<span class='co'>##02 - basic example II</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>ExampleData.BINfileData</span>, envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>environment</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>id</span> <span class='op'>&lt;-</span> <span class='fu'>verify_SingleGrainData</span><span class='op'>(</span>object <span class='op'>=</span> <span class='va'>CWOSL.SAR.Data</span>,
cleanup_level <span class='op'>=</span> <span class='st'>"aliquot"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>selection_id</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>##03 - advanced example I</span>
<span class='co'>##importing and exporting a BIN-file</span>

<span class='co'>##select and import file</span>
<span class='va'>file</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.choose.html'>file.choose</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>object</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read_BIN2R.html'>read_BIN2R</a></span><span class='op'>(</span><span class='va'>file</span><span class='op'>)</span>

<span class='co'>##remove invalid aliquots(!)</span>
<span class='va'>object</span> <span class='op'>&lt;-</span> <span class='fu'>verify_SingleGrainData</span><span class='op'>(</span><span class='va'>object</span>, cleanup <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'>##export to new BIN-file</span>
<span class='fu'><a href='write_R2BIN.html'>write_R2BIN</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/basename.html'>dirname</a></span><span class='op'>(</span><span class='va'>file</span><span class='op'>)</span>,<span class='st'>"/"</span>, <span class='fu'><a href='https://rdrr.io/r/base/basename.html'>basename</a></span><span class='op'>(</span><span class='va'>file</span><span class='op'>)</span>, <span class='st'>"_CLEANED.BIN"</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


