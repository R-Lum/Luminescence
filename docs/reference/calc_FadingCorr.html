<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Apply a fading correction according to Huntley &amp; Lamothe (2001) for a given
g-value and a given tc — calc_FadingCorr • Luminescence</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Apply a fading correction according to Huntley &amp; Lamothe (2001) for a given
g-value and a given tc — calc_FadingCorr" />
<meta property="og:description" content="This function solves the equation used for correcting the fading affected age
including the error for a given g-value according to Huntley &amp;amp; Lamothe (2001)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/index.html">
    <span class="fa fa-play"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/NEWS_Version0.9.0.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Apply a fading correction according to Huntley &amp; Lamothe (2001) for a given
g-value and a given tc</h1>
    <small class="dont-index">Source: <a href='https://github.com/R-Lum/Luminescence/blob/master/R/calc_FadingCorr.R'><code>R/calc_FadingCorr.R</code></a></small>
    <div class="hidden name"><code>calc_FadingCorr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function solves the equation used for correcting the fading affected age
including the error for a given g-value according to Huntley &amp; Lamothe (2001).</p>
    </div>

    <pre class="usage"><span class='fu'>calc_FadingCorr</span><span class='op'>(</span>
  <span class='va'>age.faded</span>,
  <span class='va'>g_value</span>,
  tc <span class='op'>=</span> <span class='cn'>NULL</span>,
  tc.g_value <span class='op'>=</span> <span class='va'>tc</span>,
  n.MC <span class='op'>=</span> <span class='fl'>10000</span>,
  seed <span class='op'>=</span> <span class='cn'>NULL</span>,
  interval <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.01</span>, <span class='fl'>500</span><span class='op'>)</span>,
  txtProgressBar <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>age.faded</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> <a href='https://rdrr.io/r/base/vector.html'>vector</a> (<strong>required</strong>):
uncorrected age with error in ka (see example)</p></td>
    </tr>
    <tr>
      <th>g_value</th>
      <td><p><a href='https://rdrr.io/r/base/vector.html'>vector</a> (<strong>required</strong>):
g-value and error obtained from separate fading measurements (see example).
Alternatively an <a href='RLum.Results-class.html'>RLum.Results</a> object can be provided produced by the function
<a href='analyse_FadingMeasurement.html'>analyse_FadingMeasurement</a>, in this case tc is set automatically</p></td>
    </tr>
    <tr>
      <th>tc</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (<strong>required</strong>):
time in seconds between irradiation and the prompt measurement (cf. Huntley &amp; Lamothe 2001).
Argument will be ignored if <code>g_value</code> was an <a href='RLum.Results-class.html'>RLum.Results</a> object</p></td>
    </tr>
    <tr>
      <th>tc.g_value</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (<em>with default</em>):
the time in seconds between irradiation and the prompt measurement used for estimating the g-value.
If the g-value was normalised to, e.g., 2 days, this time in seconds (i.e., 172800) should be given here.
If nothing is provided the time is set to tc, which is usual case for g-values obtained using the
SAR method and g-values that had been not normalised to 2 days.</p></td>
    </tr>
    <tr>
      <th>n.MC</th>
      <td><p><a href='https://rdrr.io/r/base/integer.html'>integer</a> (<em>with default</em>):
number of Monte Carlo simulation runs for error estimation.
If <code>n.MC = 'auto'</code> is used the function tries to find a 'stable' error for the age.
<strong>Note:</strong> This may take a while!</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p><a href='https://rdrr.io/r/base/integer.html'>integer</a> (<em>optional</em>):
sets the seed for the random number generator in R using <a href='https://rdrr.io/r/base/Random.html'>set.seed</a></p></td>
    </tr>
    <tr>
      <th>interval</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (<em>with default</em>):
a vector containing the end-points (age interval) of the interval to be searched for the root in 'ka'.
This argument is passed to the function <a href='https://rdrr.io/r/stats/uniroot.html'>stats::uniroot</a> used for solving the equation.</p></td>
    </tr>
    <tr>
      <th>txtProgressBar</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
enables or disables <a href='https://rdrr.io/r/utils/txtProgressBar.html'>txtProgressBar</a></p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
enables or disables terminal output</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns an S4 object of type <a href='RLum.Results-class.html'>RLum.Results</a>.<br /></p>
<p>Slot: <strong><code>@data</code></strong><br /></p><table class='table'>
<tr><td><strong>Object</strong></td><td><strong>Type</strong></td><td><strong>Comment</strong></td></tr>
<tr><td><code>age.corr</code></td><td><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></td><td>Corrected age</td></tr>
<tr><td><code>age.corr.MC</code></td><td><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></td><td>MC simulation results with all possible ages from that simulation</td></tr>
</table>


<p>Slot: <strong><code>@info</code></strong><br /></p>
<table class='table'>
<tr><td><strong>Object</strong></td><td><strong>Type</strong></td><td><strong>Comment</strong></td></tr>
<tr><td><code>info</code></td><td><a href='https://rdrr.io/r/base/character.html'>character</a></td><td>the original function call</td></tr>
</table>


    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>As the g-value sligthly depends on the time between irradiation and the prompt measurement,
this is tc, always a tc value needs to be provided. If the g-value was normalised to a distinct
time or evaluated with a different tc value (e.g., external irradiation), also the tc value
for the g-value needs to be provided (argument <code>tc.g_value</code> and then the g-value is recalcualted
to tc of the measurement used for estimating the age applying the following equation:</p>
<p>$$\kappa_{tc} = \kappa_{tc.g} / (1 - \kappa_{tc.g} * log(tc/tc.g))$$</p>
<p>where</p>
<p>$$\kappa_{tc.g} = g / 100 / log(10)$$</p>
<p>with <code>log</code> the natural logarithm.</p>
<p>The error of the fading-corrected age is determined using a Monte Carlo
simulation approach. Solving of the equation is realised using
<a href='https://rdrr.io/r/stats/uniroot.html'>uniroot</a>. Large values for <code>n.MC</code> will significantly
increase the computation time.<br /></p>
<p><strong><code>n.MC = 'auto'</code></strong></p>
<p>The error estimation based on a stochastic process, i.e. for a small number of MC runs the calculated
error varies considerably every time the function is called, even with the same input values.
The argument option <code>n.MC = 'auto'</code> tries to find a stable value for the standard error, i.e.
the standard deviation of values calculated during the MC runs (<code>age.corr.MC</code>),
within a given precision (2 digits) by increasing the number of MC runs stepwise and
calculating the corresponding error.</p>
<p>If the determined error does not differ from the 9 values calculated previously
within a precision of (here) 3 digits the calculation is stopped as it is assumed that the error
is stable. Please note that (a) the duration depends on the input values as well as on
the provided computation ressources and it may take a while, (b) the length (size) of the output
vector <code>age.corr.MC</code>, where all the single values produced during the MC runs are stored,
equals the number of MC runs (here termed observations).</p>
<p>To avoid an endless loop the calculation is stopped if the number of observations exceeds 10^7.
This limitation can be overwritten by setting the number of MC runs manually,
e.g. <code>n.MC = 10000001</code>. Note: For this case the function is not checking whether the calculated
error is stable.<br /></p>
<p><strong><code>seed</code></strong></p>
<p>This option allows to recreate previously calculated results by setting the seed
for the R random number generator (see <a href='https://rdrr.io/r/base/Random.html'>set.seed</a> for details). This option
should not be mixed up with the option <strong><code>n.MC = 'auto'</code></strong>. The results may
appear similar, but they are not comparable!<br /></p>
<p><strong>FAQ</strong><br /></p>
<p>Q: Which tc value is expected?<br /></p>
<p>A: tc is the time in seconds between irradiation and the prompt measurement applied during your
De measurement. However, this tc might differ from the tc used for estimating the g-value. In the
case of an SAR measurement tc should be similar, however, if it differs, you have to provide this
tc value (the one used for estimating the g-value) using the argument <code>tc.g_value</code>.<br /></p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Special thanks to Sebastien Huot for his support and clarification via e-mail.</p>
    <h2 class="hasAnchor" id="function-version"><a class="anchor" href="#function-version"></a>Function version</h2>

    <p>0.4.2</p>
    <h2 class="hasAnchor" id="how-to-cite"><a class="anchor" href="#how-to-cite"></a>How to cite</h2>

    <p>Kreutzer, S., 2020. calc_FadingCorr(): Apply a fading correction according to Huntley &amp; Lamothe (2001) for a given g-value and a given tc. Function version 0.4.2. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., 2020. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.7. https://CRAN.R-project.org/package=Luminescence</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Huntley, D.J., Lamothe, M., 2001. Ubiquity of anomalous fading
in K-feldspars and the measurement and correction for it in optical dating.
Canadian Journal of Earth Sciences, 38, 1093-1106.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='RLum.Results-class.html'>RLum.Results</a>, <a href='get_RLum.html'>get_RLum</a>, <a href='https://rdrr.io/r/stats/uniroot.html'>uniroot</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastian Kreutzer, IRAMAT-CRP2A, Universite Bordeaux Montaigne (France)
, RLum Developer Team</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>##run the examples given in the appendix of Huntley and Lamothe, 2001</span>

<span class='co'>##(1) faded age: 100 a</span>
<span class='va'>results</span> <span class='op'>&lt;-</span> <span class='fu'>calc_FadingCorr</span><span class='op'>(</span>
   age.faded <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>,<span class='fl'>0</span><span class='op'>)</span>,
   g_value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5.0</span>, <span class='fl'>1.0</span><span class='op'>)</span>,
   tc <span class='op'>=</span> <span class='fl'>2592000</span>,
   tc.g_value <span class='op'>=</span> <span class='fl'>172800</span>,
   n.MC <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; [calc_FadingCorr()]
#&gt; 
#&gt;  &gt;&gt; Fading correction according to Huntley &amp; Lamothe (2001)
#&gt;  &gt;&gt; g-value re-calculated for the given tc
#&gt; 
#&gt;  .. used g-value:	5.312 ± 1.012 %/decade
#&gt;  .. used tc:		8.214e-05 ka
#&gt;  .. used kappa:		0.0231 ± 0.0044
#&gt;  ----------------------------------------------
#&gt;  seed: 			NA
#&gt;  n.MC: 			100
#&gt;  observations: 		100
#&gt;  ----------------------------------------------
#&gt;  Age (faded):		0.1 ka ± 0 ka
#&gt;  Age (corr.):		0.1168 ka ± 0.004 ka
#&gt;  ---------------------------------------------- </div><div class='input'>
<span class='co'>##(2) faded age: 1 ka</span>
<span class='va'>results</span> <span class='op'>&lt;-</span> <span class='fu'>calc_FadingCorr</span><span class='op'>(</span>
   age.faded <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,
   g_value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5.0</span>, <span class='fl'>1.0</span><span class='op'>)</span>,
   tc <span class='op'>=</span> <span class='fl'>2592000</span>,
   tc.g_value <span class='op'>=</span> <span class='fl'>172800</span>,
   n.MC <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; [calc_FadingCorr()]
#&gt; 
#&gt;  &gt;&gt; Fading correction according to Huntley &amp; Lamothe (2001)
#&gt;  &gt;&gt; g-value re-calculated for the given tc
#&gt; 
#&gt;  .. used g-value:	5.312 ± 1.012 %/decade
#&gt;  .. used tc:		8.214e-05 ka
#&gt;  .. used kappa:		0.0231 ± 0.0044
#&gt;  ----------------------------------------------
#&gt;  seed: 			NA
#&gt;  n.MC: 			100
#&gt;  observations: 		100
#&gt;  ----------------------------------------------
#&gt;  Age (faded):		1 ka ± 0 ka
#&gt;  Age (corr.):		1.2486 ka ± 0.0728 ka
#&gt;  ---------------------------------------------- </div><div class='input'>
<span class='co'>##(3) faded age: 10.0 ka</span>
<span class='va'>results</span> <span class='op'>&lt;-</span> <span class='fu'>calc_FadingCorr</span><span class='op'>(</span>
   age.faded <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>0</span><span class='op'>)</span>,
   g_value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5.0</span>, <span class='fl'>1.0</span><span class='op'>)</span>,
   tc <span class='op'>=</span> <span class='fl'>2592000</span>,
   tc.g_value <span class='op'>=</span> <span class='fl'>172800</span>,
   n.MC <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; [calc_FadingCorr()]
#&gt; 
#&gt;  &gt;&gt; Fading correction according to Huntley &amp; Lamothe (2001)
#&gt;  &gt;&gt; g-value re-calculated for the given tc
#&gt; 
#&gt;  .. used g-value:	5.312 ± 1.012 %/decade
#&gt;  .. used tc:		8.214e-05 ka
#&gt;  .. used kappa:		0.0231 ± 0.0044
#&gt;  ----------------------------------------------
#&gt;  seed: 			NA
#&gt;  n.MC: 			100
#&gt;  observations: 		100
#&gt;  ----------------------------------------------
#&gt;  Age (faded):		10 ka ± 0 ka
#&gt;  Age (corr.):		13.402 ka ± 0.7875 ka
#&gt;  ---------------------------------------------- </div><div class='input'>
<span class='co'>##access the last output</span>
<span class='fu'><a href='get_RLum.html'>get_RLum</a></span><span class='op'>(</span><span class='va'>results</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      AGE AGE.ERROR AGE_FADED AGE_FADED.ERROR  G_VALUE G_VALUE.ERROR      KAPPA
#&gt; 1 13.402    0.7875        10               0 5.312393      1.011901 0.02307143
#&gt;   KAPPA.ERROR           TC   TC.G_VALUE n.MC OBSERVATIONS SEED
#&gt; 1  0.00439463 8.213721e-05 5.475814e-06  100          100   NA</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


