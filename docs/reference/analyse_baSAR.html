<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Bayesian models (baSAR) applied on luminescence data — analyse_baSAR • Luminescence</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian models (baSAR) applied on luminescence data — analyse_baSAR"><meta property="og:description" content="This function allows the application of Bayesian models on luminescence data, measured
with the single-aliquot regenerative-dose (SAR, Murray and Wintle, 2000) protocol. In particular,
it follows the idea proposed by Combès et al., 2015 of using an hierarchical model for estimating
a central equivalent dose from a set of luminescence measurements. This function is (I) the adoption
of this approach for the R environment and (II) an extension and a technical refinement of the
published code."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.24.9000-106</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence" class="external-link">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian models (baSAR) applied on luminescence data</h1>
    <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/HEAD/R/analyse_baSAR.R" class="external-link"><code>R/analyse_baSAR.R</code></a></small>
    <div class="hidden name"><code>analyse_baSAR.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function allows the application of Bayesian models on luminescence data, measured
with the single-aliquot regenerative-dose (SAR, Murray and Wintle, 2000) protocol. In particular,
it follows the idea proposed by Combès et al., 2015 of using an hierarchical model for estimating
a central equivalent dose from a set of luminescence measurements. This function is (I) the adoption
of this approach for the R environment and (II) an extension and a technical refinement of the
published code.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">analyse_baSAR</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  XLS_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  aliquot_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  source_doserate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">signal.integral</span>,</span>
<span>  signal.integral.Tx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">background.integral</span>,</span>
<span>  background.integral.Tx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  irradiation_times <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigmab <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sig0 <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"cauchy"</span>,</span>
<span>  baSAR_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.MCMC <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  fit.method <span class="op">=</span> <span class="st">"EXP"</span>,</span>
<span>  fit.force_through_origin <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fit.includingRepeatedRegPoints <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  distribution_plot <span class="op">=</span> <span class="st">"kde"</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_reduced <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot.single <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p><a href="Risoe.BINfileData-class.html">Risoe.BINfileData</a>, <a href="RLum.Results-class.html">RLum.Results</a>, <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> of <a href="RLum.Analysis-class.html">RLum.Analysis</a>,
<a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> or <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> (<strong>required</strong>):
input object used for the Bayesian analysis. If a <code>character</code> is provided the function
assumes a file connection and tries to import a BIN/BINX-file using the provided path. If a <code>list</code> is
provided the list can only contain either <code>Risoe.BINfileData</code> objects or <code>character</code>s
providing a file connection. Mixing of both types is not allowed. If an <a href="RLum.Results-class.html">RLum.Results</a>
is provided the function directly starts with the Bayesian Analysis (see details)</p></dd>


<dt>XLS_file</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>optional</em>):
XLS_file with data for the analysis. This file must contain 3 columns:
the name of the file, the disc position and the grain position
(the last being 0 for multi-grain measurements).<br>
Alternatively a <code>data.frame</code> of similar structure can be provided.</p></dd>


<dt>aliquot_range</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
allows to limit the range of the aliquots used for the analysis.
This argument has only an effect if the argument <code>XLS_file</code> is used or
the input is the previous output (i.e. is <a href="RLum.Results-class.html">RLum.Results</a>). In this case the
new selection will add the aliquots to the removed aliquots table.</p></dd>


<dt>source_doserate</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> <strong>(required)</strong>:
source dose rate of beta-source used for the measurement and its uncertainty
in Gy/s, e.g., <code>source_doserate = c(0.12, 0.04)</code>. Parameter can be provided
as <code>list</code>, for the case that more than one BIN-file is provided, e.g.,
<code>source_doserate = list(c(0.04, 0.004), c(0.05, 0.004))</code>.</p></dd>


<dt>signal.integral</dt>
<dd><p><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a> (<strong>required</strong>):
vector with the limits for the signal integral used for the calculation,
e.g., <code>signal.integral = c(1:5)</code>. Ignored if <code>object</code> is an <a href="RLum.Results-class.html">RLum.Results</a> object.
The parameter can be provided as <code>list</code>, see <code>source_doserate</code>.</p></dd>


<dt>signal.integral.Tx</dt>
<dd><p><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a> (<em>optional</em>):
vector with the limits for the signal integral for the Tx curve. I
f nothing is provided the value from <code>signal.integral</code> is used and it is ignored
if <code>object</code> is an <a href="RLum.Results-class.html">RLum.Results</a> object.
The parameter can be provided as <code>list</code>, see <code>source_doserate</code>.</p></dd>


<dt>background.integral</dt>
<dd><p><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a> (<strong>required</strong>):
vector with the bounds for the background integral.
Ignored if <code>object</code> is an <a href="RLum.Results-class.html">RLum.Results</a> object.
The parameter can be provided as <code>list</code>, see <code>source_doserate</code>.</p></dd>


<dt>background.integral.Tx</dt>
<dd><p><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a> (<em>optional</em>):
vector with the limits for the background integral for the Tx curve.
If nothing is provided the value from <code>background.integral</code> is used.
Ignored if <code>object</code> is an <a href="RLum.Results-class.html">RLum.Results</a> object.
The parameter can be provided as <code>list</code>, see <code>source_doserate</code>.</p></dd>


<dt>irradiation_times</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>): if set this vector replaces all irradiation
times for one aliquot and one cycle (Lx and Tx curves) and recycles it for all others cycles and aliquots.
Please note that if this argument is used, for every(!) single curve
in the dataset an irradiation time needs to be set.</p></dd>


<dt>sigmab</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
option to set a manual value for the overdispersion (for <code>LnTx</code> and <code>TnTx</code>),
used for the <code>Lx</code>/<code>Tx</code> error calculation. The value should be provided as
absolute squared count values, cf. <a href="calc_OSLLxTxRatio.html">calc_OSLLxTxRatio</a>.
The parameter can be provided as <code>list</code>, see <code>source_doserate</code>.</p></dd>


<dt>sig0</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
allow adding an extra component of error to the final Lx/Tx error value
(e.g., instrumental error, see details is <a href="calc_OSLLxTxRatio.html">calc_OSLLxTxRatio</a>).
The parameter can be provided as <code>list</code>, see <code>source_doserate</code>.</p></dd>


<dt>distribution</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
type of distribution that is used during Bayesian calculations for
determining the Central dose and overdispersion values.
Allowed inputs are <code>"cauchy"</code>, <code>"normal"</code> and <code>"log_normal"</code>.</p></dd>


<dt>baSAR_model</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>optional</em>):
option to provide an own modified or new model for the Bayesian calculation
(see details). If an own model is provided the argument <code>distribution</code> is
ignored and set to <code>'user_defined'</code></p></dd>


<dt>n.MCMC</dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
number of iterations for the Markov chain Monte Carlo (MCMC) simulations</p></dd>


<dt>fit.method</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
equation used for the fitting of the dose-response curve using the function
<a href="plot_GrowthCurve.html">plot_GrowthCurve</a> and then for the Bayesian modelling. Here supported methods: <code>EXP</code>, <code>EXP+LIN</code> and <code>LIN</code></p></dd>


<dt>fit.force_through_origin</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
force fitting through origin</p></dd>


<dt>fit.includingRepeatedRegPoints</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
includes the recycling point (assumed to be measured during the last cycle)</p></dd>


<dt>method_control</dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> (<em>optional</em>):
named list of control parameters that can be directly
passed to the Bayesian analysis, e.g., <code>method_control = list(n.chains = 4)</code>.
See details for further information</p></dd>


<dt>digits</dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
round output to the number of given digits</p></dd>


<dt>distribution_plot</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>): sets the final distribution plot that
shows equivalent doses obtained using the frequentist approach and sets in the central dose
as comparison obtained using baSAR. Allowed input is <code>'abanico'</code> or <code>'kde'</code>. If set to <code>NULL</code> nothing is plotted.</p></dd>


<dt>plot</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enables or disables plot output</p></dd>


<dt>plot_reduced</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enables or disables the advanced plot output</p></dd>


<dt>plot.single</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enables or disables single plots or plots arranged by <code>analyse_baSAR</code></p></dd>


<dt>verbose</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enables or disables verbose mode</p></dd>


<dt>...</dt>
<dd><p>parameters that can be passed to the function <a href="calc_OSLLxTxRatio.html">calc_OSLLxTxRatio</a>
(almost full support), <a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">readxl::read_excel</a> (full support), <a href="read_BIN2R.html">read_BIN2R</a> (<code>n.records</code>,
<code>position</code>, <code>duplicated.rm</code>), see details.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Function returns results numerically and graphically:</p>


<p>-----------------------------------<br></p>


<p><code>[ NUMERICAL OUTPUT ]</code><br></p>


<p>-----------------------------------<br></p>



<p><strong><code>RLum.Results</code></strong>-object</p>


<p><strong>slot:</strong></p>
<p></p>
<p><strong><code>@data</code></strong></p>



<table class="table table"><tr><td><strong>Element</strong></td><td><strong>Type</strong></td><td><strong>Description</strong></td></tr><tr><td><code>$summary</code></td><td><code>data.frame</code></td><td>statistical summary, including the central dose</td></tr><tr><td><code>$mcmc</code></td><td><code>mcmc</code></td><td><a href="https://rdrr.io/pkg/coda/man/mcmc.list.html" class="external-link">coda::mcmc.list</a> object including raw output</td></tr><tr><td><code>$models</code></td><td><code>character</code></td><td>implemented models used in the baSAR-model core</td></tr><tr><td><code>$input_object</code></td><td><code>data.frame</code></td><td>summarising table (same format as the XLS-file) including, e.g., Lx/Tx values</td></tr><tr><td><code>$removed_aliquots</code></td><td><code>data.frame</code></td><td>table with removed aliquots (e.g., <code>NaN</code>, or <code>Inf</code> <code>Lx</code>/<code>Tx</code> values). If nothing was removed <code>NULL</code> is returned</td></tr></table><p><strong>slot:</strong></p>
<p></p>
<p><strong><code>@info</code></strong></p>



<p>The original function call</p>


<p>------------------------<br></p>


<p><code>[ PLOT OUTPUT ]</code><br></p>


<p>------------------------<br></p>


<ul><li><p>(A) Ln/Tn curves with set integration limits,</p></li>
<li><p>(B) trace plots are returned by the baSAR-model, showing the convergence of the parameters (trace)
and the resulting kernel density plots. If <code>plot_reduced = FALSE</code> for every(!) dose a trace and
a density plot is returned (this may take a long time),</p></li>
<li><p>(C) dose plots showing the dose for every aliquot as boxplots and the marked
HPD in within. If boxes are coloured 'orange' or 'red' the aliquot itself should be checked,</p></li>
<li><p>(D) the dose response curve resulting from the monitoring of the Bayesian modelling are
provided along with the Lx/Tx values and the HPD. Note: The amount for curves displayed
is limited to 1000 (random choice) for performance reasons,</p></li>
<li><p>(E) the final plot is the De distribution as calculated using the conventional (frequentist) approach
and the central dose with the HPDs marked within. This figure is only provided for a comparison,
no further statistical conclusion should be drawn from it.</p></li>
</ul><p><strong>Please note: If distribution was set to <code>log_normal</code> the central dose is given as geometric mean!</strong></p>


    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Internally the function consists of two parts: (I) The Bayesian core for the Bayesian calculations
and applying the hierarchical model and (II) a data pre-processing part. The Bayesian core can be run
independently, if the input data are sufficient (see below). The data pre-processing part was
implemented to simplify the analysis for the user as all needed data pre-processing is done
by the function, i.e. in theory it is enough to provide a BIN/BINX-file with the SAR measurement
data. For the Bayesian analysis for each aliquot the following information are needed from the SAR analysis.
<code>LxTx</code>, the <code>LxTx</code> error and the dose values for all regeneration points.</p>
<p><strong>How the systematic error contribution is calculated?</strong></p>
<p>Standard errors (so far) provided with the source dose rate are considered as systematic uncertainties
and added to final central dose by:</p>
<p>$$systematic.error = 1/n \sum SE(source.doserate)$$</p>
<p>$$SE(central.dose.final) = \sqrt{SE(central.dose)^2 + systematic.error^2}$$</p>
<p>Please note that this approach is rather rough and can only be valid if the source dose rate
errors, in case different readers had been used, are similar. In cases where more than
one source dose rate is provided a warning is given.</p>
<p><strong>Input / output scenarios</strong></p>
<p>Various inputs are allowed for this function. Unfortunately this makes the function handling rather
complex, but at the same time very powerful. Available scenarios:</p>
<p><strong>(1) - <code>object</code> is BIN-file or link to a BIN-file</strong></p>
<p>Finally it does not matter how the information of the BIN/BINX file are provided. The function
supports <strong>(a)</strong> either a path to a file or directory or a <code>list</code> of file names or paths or
<strong>(b)</strong> a <a href="Risoe.BINfileData-class.html">Risoe.BINfileData</a> object or a list of these objects. The latter one can
be produced by using the function <a href="read_BIN2R.html">read_BIN2R</a>, but this function is called automatically
if only a file name and/or a path is provided. In both cases it will become the data that can be
used for the analysis.</p>
<p><code>[XLS_file = NULL]</code></p>
<p>If no XLS file (or data frame with the same format) is provided the functions runs an automatic process that
consists of the following steps:</p><ol><li><p>Select all valid aliquots using the function <a href="verify_SingleGrainData.html">verify_SingleGrainData</a></p></li>
<li><p>Calculate <code>Lx/Tx</code> values using the function <a href="calc_OSLLxTxRatio.html">calc_OSLLxTxRatio</a></p></li>
<li><p>Calculate De values using the function <a href="plot_GrowthCurve.html">plot_GrowthCurve</a></p></li>
</ol><p>These proceeded data are subsequently used in for the Bayesian analysis</p>
<p><code>[XLS_file != NULL]</code></p>
<p>If an XLS-file is provided or a <code>data.frame</code> providing similar information the pre-processing
steps consists of the following steps:</p><ol><li><p>Calculate <code>Lx/Tx</code> values using the function <a href="calc_OSLLxTxRatio.html">calc_OSLLxTxRatio</a></p></li>
<li><p>Calculate De values using the function <a href="plot_GrowthCurve.html">plot_GrowthCurve</a></p></li>
</ol><p>Means, the XLS file should contain a selection of the BIN-file names and the aliquots selected
for the further analysis. This allows a manual selection of input data, as the automatic selection
by <a href="verify_SingleGrainData.html">verify_SingleGrainData</a> might be not totally sufficient.</p>
<p><strong>(2) - <code>object</code> <code>RLum.Results object</code></strong></p>
<p>If an <a href="RLum.Results-class.html">RLum.Results</a> object is provided as input and(!) this object was
previously created by the function <code>analyse_baSAR()</code> itself, the pre-processing part
is skipped and the function starts directly the Bayesian analysis. This option is very powerful
as it allows to change parameters for the Bayesian analysis without the need to repeat
the data pre-processing. If furthermore the argument <code>aliquot_range</code> is set, aliquots
can be manually excluded based on previous runs.</p>
<p><strong><code>method_control</code></strong></p>
<p>These are arguments that can be passed directly to the Bayesian calculation core, supported arguments
are:</p>
<table class="table table"><tr><td><strong>Parameter</strong></td><td><strong>Type</strong></td><td><strong>Description</strong></td></tr><tr><td><code>lower_centralD</code></td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>sets the lower bound for the expected De range. Change it only if you know what you are doing!</td></tr><tr><td><code>upper_centralD</code></td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>sets the upper bound for the expected De range. Change it only if you know what you are doing!</td></tr><tr><td><code>n.chains</code></td><td><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></td><td>sets number of parallel chains for the model (default = 3) (cf. <a href="https://rdrr.io/pkg/rjags/man/jags.model.html" class="external-link">rjags::jags.model</a>)</td></tr><tr><td><code>inits</code></td><td><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></td><td>option to set initialisation values (cf. <a href="https://rdrr.io/pkg/rjags/man/jags.model.html" class="external-link">rjags::jags.model</a>)</td></tr><tr><td><code>thin</code></td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>thinning interval for monitoring the Bayesian process (cf. <a href="https://rdrr.io/pkg/rjags/man/jags.model.html" class="external-link">rjags::jags.model</a>)</td></tr><tr><td><code>variable.names</code></td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>set the variables to be monitored during the MCMC run, default:
<code>'central_D'</code>, <code>'sigma_D'</code>, <code>'D'</code>, <code>'Q'</code>, <code>'a'</code>, <code>'b'</code>, <code>'c'</code>, <code>'g'</code>.
Note: only variables present in the model can be monitored.</td></tr></table><p><strong>User defined models</strong><br></p>
<p>The function provides the option to modify and to define own models that can be used for
the Bayesian calculation. In the case the user wants to modify a model, a new model
can be piped into the function via the argument <code>baSAR_model</code> as <code>character</code>.
The model has to be provided in the JAGS dialect of the BUGS language (cf. <a href="https://rdrr.io/pkg/rjags/man/jags.model.html" class="external-link">rjags::jags.model</a>)
and parameter names given with the pre-defined names have to be respected, otherwise the function
will break.</p>
<p><strong>FAQ</strong></p>
<p>Q: How can I set the seed for the random number generator (RNG)?</p>
<p>A: Use the argument <code>method_control</code>, e.g., for three MCMC chains
(as it is the default):</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>method_control <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="at">inits =</span> <span class="fu">list</span>(</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a> <span class="fu">list</span>(<span class="at">.RNG.name =</span> <span class="st">"base::Wichmann-Hill"</span>, <span class="at">.RNG.seed =</span> <span class="dv">1</span>),</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a> <span class="fu">list</span>(<span class="at">.RNG.name =</span> <span class="st">"base::Wichmann-Hill"</span>, <span class="at">.RNG.seed =</span> <span class="dv">2</span>),</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a> <span class="fu">list</span>(<span class="at">.RNG.name =</span> <span class="st">"base::Wichmann-Hill"</span>, <span class="at">.RNG.seed =</span> <span class="dv">3</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>))</span></code></pre><p></p></div>
<p>This sets a reproducible set for every chain separately.<br></p>
<p>Q: How can I modify the output plots?</p>
<p>A: You can't, but you can use the function output to create own, modified plots.</p>
<p>Q: Can I change the boundaries for the central_D?</p>
<p>A: Yes, we made it possible, but we DO NOT recommend it, except you know what you are doing!<br>
Example: <code>method_control = list(lower_centralD = 10))</code></p>
<p>Q: The lines in the baSAR-model appear to be in a wrong logical order?<br></p>
<p>A: This is correct and allowed (cf. JAGS manual)</p>
<p><strong>Additional arguments support via the <code>...</code> argument</strong></p>
<p>This list summarizes the additional arguments that can be passed to the internally used
functions.</p>
<table class="table table"><tr><td><strong>Supported argument</strong></td><td><strong>Corresponding function</strong></td><td><strong>Default</strong></td><td>**Short description **</td></tr><tr><td><code>threshold</code></td><td><a href="verify_SingleGrainData.html">verify_SingleGrainData</a></td><td><code>30</code></td><td>change rejection threshold for curve selection</td></tr><tr><td><code>sheet</code></td><td><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">readxl::read_excel</a></td><td><code>1</code></td><td>select XLS-sheet for import</td></tr><tr><td><code>col_names</code></td><td><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">readxl::read_excel</a></td><td><code>TRUE</code></td><td>first row in XLS-file is header</td></tr><tr><td><code>col_types</code></td><td><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">readxl::read_excel</a></td><td><code>NULL</code></td><td>limit import to specific columns</td></tr><tr><td><code>skip</code></td><td><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">readxl::read_excel</a></td><td><code>0</code></td><td>number of rows to be skipped during import</td></tr><tr><td><code>n.records</code></td><td><a href="read_BIN2R.html">read_BIN2R</a></td><td><code>NULL</code></td><td>limit records during BIN-file import</td></tr><tr><td><code>duplicated.rm</code></td><td><a href="read_BIN2R.html">read_BIN2R</a></td><td><code>TRUE</code></td><td>remove duplicated records in the BIN-file</td></tr><tr><td><code>pattern</code></td><td><a href="read_BIN2R.html">read_BIN2R</a></td><td><code>TRUE</code></td><td>select BIN-file by name pattern</td></tr><tr><td><code>position</code></td><td><a href="read_BIN2R.html">read_BIN2R</a></td><td><code>NULL</code></td><td>limit import to a specific position</td></tr><tr><td><code>background.count.distribution</code></td><td><a href="calc_OSLLxTxRatio.html">calc_OSLLxTxRatio</a></td><td><code>"non-poisson"</code></td><td>set assumed count distribution</td></tr><tr><td><code>fit.weights</code></td><td><a href="plot_GrowthCurve.html">plot_GrowthCurve</a></td><td><code>TRUE</code></td><td>enables / disables fit weights</td></tr><tr><td><code>fit.bounds</code></td><td><a href="plot_GrowthCurve.html">plot_GrowthCurve</a></td><td><code>TRUE</code></td><td>enables / disables fit bounds</td></tr><tr><td><code>NumberIterations.MC</code></td><td><a href="plot_GrowthCurve.html">plot_GrowthCurve</a></td><td><code>100</code></td><td>number of MC runs for error calculation</td></tr><tr><td><code>output.plot</code></td><td><a href="plot_GrowthCurve.html">plot_GrowthCurve</a></td><td><code>TRUE</code></td><td>enables / disables dose response curve plot</td></tr><tr><td><code>output.plotExtended</code></td><td><a href="plot_GrowthCurve.html">plot_GrowthCurve</a></td><td><code>TRUE</code></td><td>enables / disables extended dose response curve plot</td></tr></table></div>
    <div id="note">
    <h2>Note</h2>
    <p><strong>If you provide more than one BIN-file</strong>, it is <strong>strongly</strong> recommended to provide
a <code>list</code> with the same number of elements for the following parameters:</p>
<p><code>source_doserate</code>, <code>signal.integral</code>, <code>signal.integral.Tx</code>, <code>background.integral</code>,
<code>background.integral.Tx</code>, <code>sigmab</code>, <code>sig0</code>.</p>
<p>Example for two BIN-files: <code>source_doserate = list(c(0.04, 0.006), c(0.05, 0.006))</code></p>
<p><strong>The function is currently limited to work with standard Risoe BIN-files only!</strong></p>
    </div>
    <div id="function-version">
    <h2>Function version</h2>
    <p>0.1.33</p>
    </div>
    <div id="how-to-cite">
    <h2>How to cite</h2>
    <p>Mercier, N., Kreutzer, S., 2024. analyse_baSAR(): Bayesian models (baSAR) applied on luminescence data. Function version 0.1.33. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., 2024. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.24.9000-106. https://CRAN.R-project.org/package=Luminescence</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Combès, B., Philippe, A., Lanos, P., Mercier, N., Tribolo, C., Guerin, G., Guibert, P., Lahaye, C., 2015.
A Bayesian central equivalent dose model for optically stimulated luminescence dating.
Quaternary Geochronology 28, 62-70. doi:10.1016/j.quageo.2015.04.001</p>
<p>Mercier, N., Kreutzer, S., Christophe, C., Guerin, G., Guibert, P., Lahaye, C., Lanos, P., Philippe, A.,
Tribolo, C., 2016. Bayesian statistics in luminescence dating: The 'baSAR'-model and its implementation
in the R package 'Luminescence'. Ancient TL 34, 14-21.</p>
<p><strong>Further reading</strong></p>
<p>Gelman, A., Carlin, J.B., Stern, H.S., Dunson, D.B., Vehtari, A., Rubin, D.B., 2013.
Bayesian Data Analysis, Third Edition. CRC Press.</p>
<p>Murray, A.S., Wintle, A.G., 2000. Luminescence dating of quartz using an improved single-aliquot
regenerative-dose protocol. Radiation Measurements 32, 57-73. doi:10.1016/S1350-4487(99)00253-X</p>
<p>Plummer, M., 2017. JAGS Version 4.3.0 user manual. <code>https://sourceforge.net/projects/mcmc-jags/files/Manuals/4.x/jags_user_manual.pdf/download</code></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="read_BIN2R.html">read_BIN2R</a>, <a href="calc_OSLLxTxRatio.html">calc_OSLLxTxRatio</a>, <a href="plot_GrowthCurve.html">plot_GrowthCurve</a>,
<a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">readxl::read_excel</a>, <a href="verify_SingleGrainData.html">verify_SingleGrainData</a>,
<a href="https://rdrr.io/pkg/rjags/man/jags.model.html" class="external-link">rjags::jags.model</a>, <a href="https://rdrr.io/pkg/rjags/man/coda.samples.html" class="external-link">rjags::coda.samples</a>, <a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot.default</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Norbert Mercier, IRAMAT-CRP2A, Université Bordeaux Montaigne (France) <br>
Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany) <br>
The underlying Bayesian model based on a contribution by Combès et al., 2015.
, RLum Developer Team</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(1) load package test data set</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.BINfileData</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(2) selecting relevant curves, and limit dataset</span></span></span>
<span class="r-in"><span><span class="va">CWOSL.SAR.Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">CWOSL.SAR.Data</span>,</span></span>
<span class="r-in"><span>  subset <span class="op">=</span> <span class="va">POSITION</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">LTYPE</span> <span class="op">==</span> <span class="st">"OSL"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">##(3) run analysis</span></span></span>
<span class="r-in"><span><span class="co">##please not that the here selected parameters are</span></span></span>
<span class="r-in"><span><span class="co">##choosen for performance, not for reliability</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">analyse_baSAR</span><span class="op">(</span></span></span>
<span class="r-in"><span>  object <span class="op">=</span> <span class="va">CWOSL.SAR.Data</span>,</span></span>
<span class="r-in"><span>  source_doserate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.04</span>, <span class="fl">0.001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  signal.integral <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  background.integral <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  fit.method <span class="op">=</span> <span class="st">"LIN"</span>,</span></span>
<span class="r-in"><span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  n.MCMC <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##XLS_file template</span></span></span>
<span class="r-in"><span><span class="co">##copy and paste this the code below in the terminal</span></span></span>
<span class="r-in"><span><span class="co">##you can further use the function write.csv() to export the example</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">XLS_file</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> BIN_FILE <span class="op">=</span> <span class="cn">NA_character_</span>,</span></span>
<span class="r-in"><span> DISC <span class="op">=</span> <span class="cn">NA_real_</span>,</span></span>
<span class="r-in"><span> GRAIN <span class="op">=</span> <span class="cn">NA_real_</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   .Names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BIN_FILE"</span>, <span class="st">"DISC"</span>, <span class="st">"GRAIN"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   class <span class="op">=</span> <span class="st">"data.frame"</span>,</span></span>
<span class="r-in"><span>   row.names <span class="op">=</span> <span class="fl">1L</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

