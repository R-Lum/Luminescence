<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Visualise natural/regenerated signal ratios — plot_NRt • Luminescence</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Visualise natural/regenerated signal ratios — plot_NRt"><meta property="og:description" content="This function creates a Natural/Regenerated signal vs. time (NR(t)) plot
as shown in Steffen et al. 2009"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.24.9000-106</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence" class="external-link">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Visualise natural/regenerated signal ratios</h1>
    <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/HEAD/R/plot_NRt.R" class="external-link"><code>R/plot_NRt.R</code></a></small>
    <div class="hidden name"><code>plot_NRt.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function creates a Natural/Regenerated signal vs. time (NR(t)) plot
as shown in Steffen et al. 2009</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_NRt</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  smooth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"spline"</span>, <span class="st">"rmean"</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legend.pos <span class="op">=</span> <span class="st">"topright"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a>, <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a>, <a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a> or <a href="RLum.Analysis-class.html">RLum.Analysis</a> (<strong>required</strong>):
X,Y data of measured values (time and counts). See details on individual data structure.</p></dd>


<dt>log</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>optional</em>):
logarithmic axes (<code>c("x", "y", "xy")</code>).</p></dd>


<dt>smooth</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>optional</em>):
apply data smoothing. Use <code>"rmean"</code> to calculate the rolling where <code>k</code>
determines the width of the rolling window (see rollmean). <code>"spline"</code>
applies a smoothing spline to each curve (see <a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline</a>)</p></dd>


<dt>k</dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
integer width of the rolling window.</p></dd>


<dt>legend</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
show or hide the plot legend.</p></dd>


<dt>legend.pos</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
keyword specifying the position of the legend (see <a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a>).</p></dd>


<dt>...</dt>
<dd><p>further parameters passed to <a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a> (also see <a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a>).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns a plot and <a href="RLum.Analysis-class.html">RLum.Analysis</a> object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function accepts the individual curve data in many different formats. If
<code>data</code> is a <code>list</code>, each element of the list must contain a two
column <code>data.frame</code> or <code>matrix</code> containing the <code>XY</code> data of the curves
(time and counts). Alternatively, the elements can be objects of class
<a href="RLum.Data.Curve-class.html">RLum.Data.Curve</a>.</p>
<p>Input values can also be provided as a <code>data.frame</code> or <code>matrix</code> where
the first column contains the time values and each following column contains
the counts of each curve.</p>
    </div>
    <div id="how-to-cite">
    <h2>How to cite</h2>
    <p>Burow, C., 2024. plot_NRt(): Visualise natural/regenerated signal ratios. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., 2024. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.24.9000-106. https://CRAN.R-project.org/package=Luminescence</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Steffen, D., Preusser, F., Schlunegger, F., 2009. OSL quartz underestimation due to
unstable signal components. Quaternary Geochronology, 4, 353-362.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Christoph Burow, University of Cologne (Germany)
, RLum Developer Team</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## load example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ExampleData.BINfileData"</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## EXAMPLE 1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## convert Risoe.BINfileData object to RLum.Analysis object</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="Risoe.BINfileData2RLum.Analysis.html">Risoe.BINfileData2RLum.Analysis</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">CWOSL.SAR.Data</span>, pos <span class="op">=</span> <span class="fl">8</span>, ltype <span class="op">=</span> <span class="st">"OSL"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## extract all OSL curves</span></span></span>
<span class="r-in"><span><span class="va">allCurves</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## keep only the natural and regenerated signal curves</span></span></span>
<span class="r-in"><span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">curves</span> <span class="op">&lt;-</span> <span class="va">allCurves</span><span class="op">[</span><span class="va">pos</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## plot a standard NR(t) plot</span></span></span>
<span class="r-in"><span><span class="fu">plot_NRt</span><span class="op">(</span><span class="va">curves</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_NRt-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## re-plot with rolling mean data smoothing</span></span></span>
<span class="r-in"><span><span class="fu">plot_NRt</span><span class="op">(</span><span class="va">curves</span>, smooth <span class="op">=</span> <span class="st">"rmean"</span>, k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_NRt-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## re-plot with a logarithmic x-axis</span></span></span>
<span class="r-in"><span><span class="fu">plot_NRt</span><span class="op">(</span><span class="va">curves</span>, log <span class="op">=</span> <span class="st">"x"</span>, smooth <span class="op">=</span> <span class="st">"rmean"</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_NRt-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## re-plot with custom axes ranges</span></span></span>
<span class="r-in"><span><span class="fu">plot_NRt</span><span class="op">(</span><span class="va">curves</span>, smooth <span class="op">=</span> <span class="st">"rmean"</span>, k <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>         xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">1.6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         legend.pos <span class="op">=</span> <span class="st">"bottomleft"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_NRt-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## re-plot with smoothing spline on log scale</span></span></span>
<span class="r-in"><span><span class="fu">plot_NRt</span><span class="op">(</span><span class="va">curves</span>, smooth <span class="op">=</span> <span class="st">"spline"</span>, log <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>         legend.pos <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_NRt-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## EXAMPLE 2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># you may also use this function to check whether all</span></span></span>
<span class="r-in"><span><span class="co"># TD curves follow the same shape (making it a TnTx(t) plot).</span></span></span>
<span class="r-in"><span><span class="va">posTD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">14</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">curves</span> <span class="op">&lt;-</span> <span class="va">allCurves</span><span class="op">[</span><span class="va">posTD</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_NRt</span><span class="op">(</span><span class="va">curves</span>, main <span class="op">=</span> <span class="st">"TnTx(t) Plot"</span>,</span></span>
<span class="r-in"><span>         smooth <span class="op">=</span> <span class="st">"rmean"</span>, k <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>         ylab <span class="op">=</span> <span class="st">"TD natural / TD regenerated"</span>,</span></span>
<span class="r-in"><span>         xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_NRt-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## EXAMPLE 3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># extract data from all positions</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">24</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">pos</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="Risoe.BINfileData2RLum.Analysis.html">Risoe.BINfileData2RLum.Analysis</a></span><span class="op">(</span><span class="va">CWOSL.SAR.Data</span>, pos <span class="op">=</span> <span class="va">pos</span>, ltype <span class="op">=</span> <span class="st">"OSL"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get individual curve data from each aliquot</span></span></span>
<span class="r-in"><span><span class="va">aliquot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">get_RLum</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># set graphical parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create NR(t) plots for all aliquots</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">aliquot</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="fu">plot_NRt</span><span class="op">(</span><span class="va">aliquot</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">pos</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>            main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Aliquot #"</span>, <span class="va">i</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            smooth <span class="op">=</span> <span class="st">"rmean"</span>, k <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>            xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">0.6</span>, legend.pos <span class="op">=</span> <span class="st">"bottomleft"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="plot_NRt-7.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_NRt-8.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_NRt-9.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_NRt-10.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_NRt-11.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_NRt-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reset graphical parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

