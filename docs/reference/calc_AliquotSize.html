<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate the amount of grains on an aliquot — calc_AliquotSize • Luminescence</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate the amount of grains on an aliquot — calc_AliquotSize"><meta name="description" content="Estimate the number of grains on an aliquot. Alternatively, the packing
density of an aliquot is computed."><meta property="og:description" content="Estimate the number of grains on an aliquot. Alternatively, the packing
density of an aliquot is computed."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.25.9000-51</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate the amount of grains on an aliquot</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/HEAD/R/calc_AliquotSize.R" class="external-link"><code>R/calc_AliquotSize.R</code></a></small>
      <div class="d-none name"><code>calc_AliquotSize.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimate the number of grains on an aliquot. Alternatively, the packing
density of an aliquot is computed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_AliquotSize</span><span class="op">(</span></span>
<span>  <span class="va">grain.size</span>,</span>
<span>  <span class="va">sample.diameter</span>,</span>
<span>  packing.density <span class="op">=</span> <span class="fl">0.65</span>,</span>
<span>  MC <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">grains.counted</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-grain-size">grain.size<a class="anchor" aria-label="anchor" href="#arg-grain-size"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>):
mean grain size (microns) or a range of grain sizes from which the
mean grain size is computed (e.g. <code>c(100,200)</code>).</p></dd>


<dt id="arg-sample-diameter">sample.diameter<a class="anchor" aria-label="anchor" href="#arg-sample-diameter"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>):
diameter (mm) of the targeted area on the sample carrier.</p></dd>


<dt id="arg-packing-density">packing.density<a class="anchor" aria-label="anchor" href="#arg-packing-density"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
empirical value for mean packing density. <br>
If <code>packing.density = "Inf"</code> a hexagonal structure on an infinite plane with
a packing density of \(0.906\ldots\) is assumed.</p></dd>


<dt id="arg-mc">MC<a class="anchor" aria-label="anchor" href="#arg-mc"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>optional</em>):
if <code>TRUE</code> the function performs a Monte Carlo simulation for estimating the
amount of grains on the sample carrier and assumes random errors in grain
size distribution and packing density. Requires a vector with min and max
grain size for <code>grain.size</code>. For more information see details.</p></dd>


<dt id="arg-grains-counted">grains.counted<a class="anchor" aria-label="anchor" href="#arg-grains-counted"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
grains counted on a sample carrier. If a non-zero positive integer is provided this function
will calculate the packing density of the aliquot. If more than one value is
provided the mean packing density and its standard deviation is calculated.
Note that this overrides <code>packing.density</code>.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
plot output (<code>TRUE</code>/<code>FALSE</code>)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments to pass (<code>main, xlab, MC.iter</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a terminal output. In addition an
<a href="RLum.Results-class.html">RLum.Results</a> object is returned containing the
following element:</p>
<dl><dt>.$summary</dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> summary of all relevant calculation results.</p></dd>

<dt>.$args</dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> used arguments</p></dd>

<dt>.$call</dt>
<dd><p><a href="https://rdrr.io/r/base/call.html" class="external-link">call</a> the function call</p></dd>

<dt>.$MC</dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> results of the Monte Carlo simulation</p></dd>


</dl><p>The output should be accessed using the function <a href="get_RLum.html">get_RLum</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function can be used to either estimate the number of grains on an
aliquot or to compute the packing density depending on the the arguments
provided.</p>
<p>The following function is used to estimate the number of grains <code>n</code>:</p>
<p>$$n = (\pi*x^2)/(\pi*y^2)*d$$</p>
<p>where <code>x</code> is the radius of the aliquot size (microns), <code>y</code> is the mean
radius of the mineral grains (mm) and <code>d</code> is the packing density
(value between 0 and 1).</p>
<p><strong>Packing density</strong></p>
<p>The default value for <code>packing.density</code> is 0.65, which is the mean of
empirical values determined by Heer et al. (2012) and unpublished data from
the Cologne luminescence laboratory. If <code>packing.density = "Inf"</code> a maximum
density of  \(\pi/\sqrt12 = 0.9068\ldots\) is used. However, note that
this value is not appropriate as the standard preparation procedure of
aliquots resembles a  PECC (<em>"Packing Equal Circles in a Circle"</em>) problem
where the maximum packing density is asymptotic to about 0.87.</p>
<p><strong>Monte Carlo simulation</strong></p>
<p>The number of grains on an aliquot can be estimated by Monte Carlo simulation
when setting <code>MC = TRUE</code>. Each of the parameters necessary to calculate
<code>n</code> (<code>x</code>, <code>y</code>, <code>d</code>) are assumed to be normally distributed with means
\(\mu_x, \mu_y, \mu_d\) and standard deviations \(\sigma_x, \sigma_y, \sigma_d\).</p>
<p>For the mean grain size random samples are taken first from
\(N(\mu_y, \sigma_y)\), where \(\mu_y = mean.grain.size\) and
\(\sigma_y = (max.grain.size-min.grain.size)/4\) so that 95\<!-- % of all -->
grains are within the provided the grain size range. This effectively takes
into account that after sieving the sample there is still a small chance of
having grains smaller or larger than the used mesh sizes. For each random
sample the mean grain size is calculated, from which random subsamples are
drawn for the Monte Carlo simulation.</p>
<p>The packing density is assumed
to be normally distributed with an empirically determined \(\mu = 0.65\)
(or provided value) and \(\sigma = 0.18\). The normal distribution is
truncated at <code>d = 0.87</code> as this is approximately the maximum packing
density that can be achieved in PECC problem.</p>
<p>The sample diameter has
\(\mu = sample.diameter\) and \(\sigma = 0.2\) to take into account
variations in sample disc preparation (i.e. applying silicon spray to the
disc). A lower truncation point at <code>x = 0.5</code> is used, which assumes
that aliqouts with smaller sample diameters of 0.5 mm are discarded.
Likewise, the normal distribution is truncated at 9.8 mm, which is the
diameter of the sample disc.</p>
<p>For each random sample drawn from the
normal distributions the amount of grains on the aliquot is calculated. By
default, <code>10^5</code> iterations are used, but can be reduced/increased with
<code>MC.iter</code> (see <code>...</code>). The results are visualised in a bar- and
boxplot together with a statistical summary.</p>
    </div>
    <div class="section level2">
    <h2 id="function-version">Function version<a class="anchor" aria-label="anchor" href="#function-version"></a></h2>
    <p>0.31</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Duller, G.A.T., 2008. Single-grain optical dating of Quaternary
sediments: why aliquot size matters in luminescence dating. Boreas 37,
589-612.</p>
<p>Heer, A.J., Adamiec, G., Moska, P., 2012. How many grains
are there on a single aliquot?. Ancient TL 30, 9-16.</p>
<p><strong>Further reading</strong></p>
<p>Chang, H.-C., Wang, L.-C., 2010. A simple proof of Thue's
Theorem on Circle Packing. <a href="https://arxiv.org/pdf/1009.4322v1" class="external-link">https://arxiv.org/pdf/1009.4322v1</a>,
2013-09-13.</p>
<p>Graham, R.L., Lubachevsky, B.D., Nurmela, K.J.,
Oestergard, P.R.J., 1998.  Dense packings of congruent circles in a circle.
Discrete Mathematics 181, 139-154.</p>
<p>Huang, W., Ye, T., 2011. Global
optimization method for finding dense packings of equal circles in a circle.
European Journal of Operational Research 210, 474-481.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Christoph Burow, University of Cologne (Germany)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimate the amount of grains on a small aliquot</span></span></span>
<span class="r-in"><span><span class="fu">calc_AliquotSize</span><span class="op">(</span>grain.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">150</span><span class="op">)</span>, sample.diameter <span class="op">=</span> <span class="fl">1</span>, MC.iter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [calc_AliquotSize]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  mean grain size (microns)  : 125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sample diameter (mm)       : 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  packing density            : 0.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  number of grains           : 42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  --------------- Monte Carlo Estimates -------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  number of iterations (n)     : 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  median                       : 40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  mean                         : 42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  standard deviation (mean)    : 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  standard error (mean)        : 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  95% CI from t-test (mean)    : 38 - 46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  standard error from CI (mean): 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---------------------------------------------------------</span>
<span class="r-plt img"><img src="calc_AliquotSize-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate the mean packing density of large aliquots</span></span></span>
<span class="r-in"><span><span class="fu">calc_AliquotSize</span><span class="op">(</span>grain.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">200</span><span class="op">)</span>, sample.diameter <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>                 grains.counted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2525</span>,<span class="fl">2312</span>,<span class="fl">2880</span><span class="op">)</span>, MC.iter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Monte Carlo simulation is only available for estimating the amount of grains on the sample disc. Automatically set to FALSE.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [calc_AliquotSize]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  mean grain size (microns)  : 150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sample diameter (mm)       : 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  mean counted grains        : 2572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  mean packing density       : 0.904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  standard deviation         : 0.101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---------------------------------------------------------</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

