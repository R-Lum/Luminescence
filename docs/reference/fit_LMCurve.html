<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Nonlinear Least Squares Fit for LM-OSL curves — fit_LMCurve • Luminescence</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Nonlinear Least Squares Fit for LM-OSL curves — fit_LMCurve" />
<meta property="og:description" content="The function determines weighted nonlinear least-squares estimates of the
component parameters of an LM-OSL curve (Bulur 1996) for a given number of
components and returns various component parameters. The fitting procedure
uses the function nls with the port algorithm." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/index.html">
    <span class="fa fa-play"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/NEWS_Version0.9.0.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Nonlinear Least Squares Fit for LM-OSL curves</h1>
    <small class="dont-index">Source: <a href='https://github.com/R-Lum/Luminescence/blob/master/R/fit_LMCurve.R'><code>R/fit_LMCurve.R</code></a></small>
    <div class="hidden name"><code>fit_LMCurve.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function determines weighted nonlinear least-squares estimates of the
component parameters of an LM-OSL curve (Bulur 1996) for a given number of
components and returns various component parameters. The fitting procedure
uses the function <a href='https://rdrr.io/r/stats/nls.html'>nls</a> with the <code>port</code> algorithm.</p>
    </div>

    <pre class="usage"><span class='fu'>fit_LMCurve</span><span class='op'>(</span>
  <span class='va'>values</span>,
  <span class='va'>values.bg</span>,
  n.components <span class='op'>=</span> <span class='fl'>3</span>,
  <span class='va'>start_values</span>,
  input.dataType <span class='op'>=</span> <span class='st'>"LM"</span>,
  fit.method <span class='op'>=</span> <span class='st'>"port"</span>,
  sample_code <span class='op'>=</span> <span class='st'>""</span>,
  sample_ID <span class='op'>=</span> <span class='st'>""</span>,
  LED.power <span class='op'>=</span> <span class='fl'>36</span>,
  LED.wavelength <span class='op'>=</span> <span class='fl'>470</span>,
  fit.trace <span class='op'>=</span> <span class='cn'>FALSE</span>,
  fit.advanced <span class='op'>=</span> <span class='cn'>FALSE</span>,
  fit.calcError <span class='op'>=</span> <span class='cn'>FALSE</span>,
  bg.subtraction <span class='op'>=</span> <span class='st'>"polynomial"</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot.BG <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>values</th>
      <td><p><a href='RLum.Data.Curve-class.html'>RLum.Data.Curve</a> or <a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a> (<strong>required</strong>):
x,y data of measured values (time and counts). See examples.</p></td>
    </tr>
    <tr>
      <th>values.bg</th>
      <td><p><a href='RLum.Data.Curve-class.html'>RLum.Data.Curve</a> or <a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a> (<em>optional</em>):
x,y data of measured values (time and counts) for background subtraction.</p></td>
    </tr>
    <tr>
      <th>n.components</th>
      <td><p><a href='https://rdrr.io/r/base/integer.html'>integer</a> (<em>with default</em>):
fixed number of components that are to be recognised during fitting
(min = 1, max = 7).</p></td>
    </tr>
    <tr>
      <th>start_values</th>
      <td><p><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a> (<em>optional</em>):
start parameters for lm and xm data for the fit. If no start values are given,
an automatic start value estimation is attempted (see details).</p></td>
    </tr>
    <tr>
      <th>input.dataType</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (<em>with default</em>):
alter the plot output depending on the input data: "LM" or "pLM" (pseudo-LM).
See: <a href='CW2pLM.html'>CW2pLM</a></p></td>
    </tr>
    <tr>
      <th>fit.method</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (<em>with default</em>):
select fit method, allowed values: <code>'port'</code> and <code>'LM'</code>. <code>'port'</code> uses the 'port'
routine usint the funtion <a href='https://rdrr.io/r/stats/nls.html'>nls</a> <code>'LM'</code> utilises the function <code>nlsLM</code> from
the package <code>minpack.lm</code> and with that the Levenberg-Marquardt algorithm.</p></td>
    </tr>
    <tr>
      <th>sample_code</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (<em>optional</em>):
sample code used for the plot and the optional output table (mtext).</p></td>
    </tr>
    <tr>
      <th>sample_ID</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (<em>optional</em>):
additional identifier used as column header for the table output.</p></td>
    </tr>
    <tr>
      <th>LED.power</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (<em>with default</em>):
LED power (max.) used forintensity ramping in mW/cm^2.
<strong>Note:</strong> This value is used for the calculation of the absolute
photoionisation cross section.</p></td>
    </tr>
    <tr>
      <th>LED.wavelength</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (<em>with default</em>):
LED wavelength in nm used for stimulation.
<strong>Note:</strong> This value is used for the calculation of the absolute
photoionisation cross section.</p></td>
    </tr>
    <tr>
      <th>fit.trace</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
traces the fitting process on the terminal.</p></td>
    </tr>
    <tr>
      <th>fit.advanced</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
enables advanced fitting attempt for automatic start parameter recognition.
Works only if no start parameters are provided.
<strong>Note:</strong> It may take a while and it is not compatible with <code>fit.method = "LM"</code>.</p></td>
    </tr>
    <tr>
      <th>fit.calcError</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
calculate 1-sigma error range of components using <a href='https://rdrr.io/r/stats/confint.html'>confint</a>.</p></td>
    </tr>
    <tr>
      <th>bg.subtraction</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (<em>with default</em>):
specifies method for background subtraction (<code>polynomial</code>, <code>linear</code>, <code>channel</code>,
see Details). <strong>Note:</strong> requires input for <code>values.bg</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
terminal output with fitting results.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
returns a plot of the fitted curves.</p></td>
    </tr>
    <tr>
      <th>plot.BG</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
returns a plot of the background values with the fit used for the
background subtraction.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments that may be passed to the plot output, e.g.
<code>xlab</code>, <code>xlab</code>, <code>main</code>, <code>log</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Various types of plots are returned. For details see above. Furthermore an
<code>RLum.Results</code> object is returned with the following structure:</p>
<p><strong><code>@data:</code></strong></p>
<p><code>.. $data</code> : <a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a> with fitting results<br />
<code>.. $fit</code> : nls (<a href='https://rdrr.io/r/stats/nls.html'>nls</a> object)<br />
<code>.. $component.contribution.matrix</code> : <a href='https://rdrr.io/r/base/list.html'>list</a> component distribution matrix</p>
<p><strong><code>info:</code></strong></p>
<p><code>.. $call</code> : <a href='https://rdrr.io/r/base/call.html'>call</a> the original function call</p>
<p>Matrix structure for the distribution matrix:</p>
<p>Column 1 and 2: time and <code><a href='https://rdrr.io/r/base/rev.html'>rev(time)</a></code> values<br />
Additional columns are used for the components, two for each component,
containing I0 and n0. The last columns <code>cont.</code> provide information on
the relative component contribution for each time interval including the row
sum for this values.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><strong>Fitting function</strong></p>
<p>The function for the fitting has the general
form:</p>
<p>$$y = (exp(0.5)*Im_1*x/xm_1)*exp(-x^2/(2*xm_1^2)) + ,\ldots, + exp(0.5)*Im_i*x/xm_i)*exp(-x^2/(2*xm_i^2))$$</p>
<p>where \(1 &lt; i &lt; 8\)</p>
<p>This function and the equations for the conversion to b (detrapping probability)
and n0 (proportional to initially trapped charge) have been taken from Kitis
et al. (2008):</p>
<p>$$xm_i=\sqrt{max(t)/b_i}$$
$$Im_i=exp(-0.5)n0/xm_i$$</p>
<p><strong>Background subtraction</strong></p>
<p>Three methods for background subtraction
are provided for a given background signal (<code>values.bg</code>).</p><ul>
<li><p><code>polynomial</code>: default method. A polynomial function is fitted using <a href='https://rdrr.io/r/stats/glm.html'>glm</a>
and the resulting function is used for background subtraction:
$$y = a*x^4 + b*x^3 + c*x^2 + d*x + e$$</p></li>
<li><p><code>linear</code>: a linear function is fitted using <a href='https://rdrr.io/r/stats/glm.html'>glm</a> and the resulting function
is used for background subtraction:
$$y = a*x + b$$</p></li>
<li><p><code>channel</code>: the measured
background signal is subtracted channelwise from the measured signal.</p></li>
</ul>

<p><strong>Start values</strong></p>
<p>The choice of the initial parameters for the <code>nls</code>-fitting is a crucial
point and the fitting procedure may mainly fail due to ill chosen start
parameters. Here, three options are provided:</p>
<p><strong>(a)</strong>
If no start values (<code>start_values</code>) are provided by the user, a cheap guess is made
by using the detrapping values found by Jain et al. (2003) for quartz for a
maximum of 7 components. Based on these values, the pseudo start parameters
xm and Im are recalculated for the given data set. In all cases, the fitting
starts with the ultra-fast component and (depending on <code>n.components</code>)
steps through the following values. If no fit could be achieved, an error
plot (for <code>plot = TRUE</code>) with the pseudo curve (based on the
pseudo start parameters) is provided. This may give the opportunity to
identify appropriate start parameters visually.</p>
<p><strong>(b)</strong>
If start values are provided, the function works like a simple <a href='https://rdrr.io/r/stats/nls.html'>nls</a>
fitting approach.</p>
<p><strong>(c)</strong>
If no start parameters are provided and
the option <code>fit.advanced = TRUE</code> is chosen, an advanced start paramter
estimation is applied using a stochastical attempt. Therefore, the
recalculated start parameters <strong>(a)</strong> are used to construct a normal
distribution. The start parameters are then sampled randomly from this
distribution. A maximum of 100 attempts will be made. <strong>Note:</strong> This
process may be time consuming.</p>
<p><strong>Goodness of fit</strong></p>
<p>The goodness of the fit is given by a pseudoR^2 value (pseudo coefficient of
determination). According to Lave (1970), the value is calculated as:</p>
<p>$$pseudoR^2 = 1 - RSS/TSS$$</p>
<p>where \(RSS = Residual~Sum~of~Squares\)
and \(TSS = Total~Sum~of~Squares\)</p>
<p><strong>Error of fitted component parameters</strong></p>
<p>The 1-sigma error for the components is calculated using
the function <a href='https://rdrr.io/r/stats/confint.html'>confint</a>. Due to considerable calculation time, this
option is deactived by default. In addition, the error for the components
can be estimated by using internal R functions like <a href='https://rdrr.io/r/base/summary.html'>summary</a>. See the
<a href='https://rdrr.io/r/stats/nls.html'>nls</a> help page for more information.</p>
<p><em>For more details on the nonlinear regression in R, see Ritz &amp; Streibig (2008).</em></p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The pseudo-R^2 may not be the best parameter to describe the goodness
of the fit. The trade off between the <code>n.components</code> and the pseudo-R^2
value currently remains unconsidered.</p>
<p>The function <strong>does not</strong> ensure that the fitting procedure has reached a
global minimum rather than a local minimum! In any case of doubt, the use of
manual start values is highly recommended.</p>
    <h2 class="hasAnchor" id="function-version"><a class="anchor" href="#function-version"></a>Function version</h2>

    <p>0.3.2</p>
    <h2 class="hasAnchor" id="how-to-cite"><a class="anchor" href="#how-to-cite"></a>How to cite</h2>

    <p>Kreutzer, S., 2020. fit_LMCurve(): Nonlinear Least Squares Fit for LM-OSL curves. Function version 0.3.2. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., 2020. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.7. https://CRAN.R-project.org/package=Luminescence</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Bulur, E., 1996. An Alternative Technique For Optically
Stimulated Luminescence (OSL) Experiment. Radiation Measurements, 26, 5,
701-709.</p>
<p>Jain, M., Murray, A.S., Boetter-Jensen, L., 2003. Characterisation of
blue-light stimulated luminescence components in different quartz samples:
implications for dose measurement. Radiation Measurements, 37 (4-5),
441-449.</p>
<p>Kitis, G. &amp; Pagonis, V., 2008. Computerized curve deconvolution analysis for
LM-OSL. Radiation Measurements, 43, 737-741.</p>
<p>Lave, C.A.T., 1970. The Demand for Urban Mass Transportation. The Review of
Economics and Statistics, 52 (3), 320-323.</p>
<p>Ritz, C. &amp; Streibig, J.C., 2008. Nonlinear Regression with R. R. Gentleman,
K. Hornik, &amp; G. Parmigiani, eds., Springer, p. 150.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='fit_CWCurve.html'>fit_CWCurve</a>, <a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a>, <a href='https://rdrr.io/r/stats/nls.html'>nls</a>, <a href='https://rdrr.io/pkg/minpack.lm/man/nlsLM.html'>minpack.lm::nlsLM</a>, <a href='get_RLum.html'>get_RLum</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastian Kreutzer, IRAMAT-CRP2A, Universite Bordeaux Montaigne (France)
, RLum Developer Team</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>##(1) fit LM data without background subtraction</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>ExampleData.FittingLM</span>, envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>environment</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>fit_LMCurve</span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>values.curve</span>, n.components <span class='op'>=</span> <span class='fl'>3</span>, log <span class='op'>=</span> <span class='st'>"x"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; [fit_LMCurve()]
#&gt; 
#&gt; Fitting was done using a 3-component function:
#&gt; 
#&gt;        xm1        xm2        xm3        Im1        Im2        Im3 
#&gt;   56.18289 1449.72461 7878.25114  202.76634  367.30226  639.21354 
#&gt; 
#&gt; (equation used for fitting according Kitis &amp; Pagonis, 2008)
#&gt; ------------------------------------------------------------------------------
#&gt; (1) Corresponding values according the equation in Bulur, 1996 for b and n0:
#&gt; 
#&gt; b1 = 1.267219e+00 +/- NA
#&gt; n01 = 1.878223e+04 +/- NA
#&gt; 
#&gt; b2 = 1.90322e-03 +/- NA
#&gt; n02 = 8.779229e+05 +/- NA
#&gt; 
#&gt; b3 = 6.444665e-05 +/- NA
#&gt; n03 = 8.30277e+06 +/- NA
#&gt; 
#&gt; cs from component.1 = 1.488e-17 cm^2	 &gt;&gt; relative: 1
#&gt; cs from component.2 = 2.234e-20 cm^2	 &gt;&gt; relative: 0.0015
#&gt; cs from component.3 = 7.566e-22 cm^2	 &gt;&gt; relative: 1e-04
#&gt; 
#&gt; (stimulation intensity value used for calculation: 8.517726e+16 1/s 1/cm^2)
#&gt; (errors quoted as 1-sigma uncertainties)
#&gt; ------------------------------------------------------------------------------
#&gt; 
#&gt; pseudo-R^2 = 0.9557</div><div class='img'><img src='fit_LMCurve-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##(2) fit LM data with background subtraction and export as JPEG</span>
<span class='co'>## -alter file path for your preferred system</span>
<span class='co'>##jpeg(file = "~/Desktop/Fit_Output\%03d.jpg", quality = 100,</span>
<span class='co'>## height = 3000, width = 3000, res = 300)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>ExampleData.FittingLM</span>, envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>environment</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>fit_LMCurve</span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>values.curve</span>, values.bg <span class='op'>=</span> <span class='va'>values.curveBG</span>,
            n.components <span class='op'>=</span> <span class='fl'>2</span>, log <span class='op'>=</span> <span class='st'>"x"</span>, plot.BG <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [fit_LMCurve] &gt;&gt; Background subtracted (method="polynomial")!</div><div class='img'><img src='fit_LMCurve-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; [fit_LMCurve()]
#&gt; 
#&gt; Fitting was done using a 2-component function:
#&gt; 
#&gt;        xm1        xm2        Im1        Im2 
#&gt;   53.32071 1587.57201  176.74408  406.89925 
#&gt; 
#&gt; (equation used for fitting according Kitis &amp; Pagonis, 2008)
#&gt; ------------------------------------------------------------------------------
#&gt; (1) Corresponding values according the equation in Bulur, 1996 for b and n0:
#&gt; 
#&gt; b1 = 1.406916e+00 +/- NA
#&gt; n01 = 1.553775e+04 +/- NA
#&gt; 
#&gt; b2 = 1.587059e-03 +/- NA
#&gt; n02 = 1.065044e+06 +/- NA
#&gt; 
#&gt; cs from component.1 = 1.652e-17 cm^2	 &gt;&gt; relative: 1
#&gt; cs from component.2 = 1.863e-20 cm^2	 &gt;&gt; relative: 0.0011
#&gt; 
#&gt; (stimulation intensity value used for calculation: 8.517726e+16 1/s 1/cm^2)
#&gt; (errors quoted as 1-sigma uncertainties)
#&gt; ------------------------------------------------------------------------------
#&gt; 
#&gt; pseudo-R^2 = 0.9417</div><div class='img'><img src='fit_LMCurve-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>##dev.off()</span>

<span class='co'>##(3) fit LM data with manual start parameters</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>ExampleData.FittingLM</span>, envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>environment</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>fit_LMCurve</span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>values.curve</span>,
            values.bg <span class='op'>=</span> <span class='va'>values.curveBG</span>,
            n.components <span class='op'>=</span> <span class='fl'>3</span>,
            log <span class='op'>=</span> <span class='st'>"x"</span>,
            start_values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Im <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>170</span>,<span class='fl'>25</span>,<span class='fl'>400</span><span class='op'>)</span>, xm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>56</span>,<span class='fl'>200</span>,<span class='fl'>1500</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [fit_LMCurve] &gt;&gt; Background subtracted (method="polynomial")!
#&gt; 
#&gt; [fit_LMCurve()]
#&gt; 
#&gt; Fitting was done using a 3-component function:
#&gt; 
#&gt;        xm1        xm2        xm3        Im1        Im2        Im3 
#&gt;   49.00643  204.40082 1591.66448  169.44002   23.00741  405.46171 
#&gt; 
#&gt; (equation used for fitting according Kitis &amp; Pagonis, 2008)
#&gt; ------------------------------------------------------------------------------
#&gt; (1) Corresponding values according the equation in Bulur, 1996 for b and n0:
#&gt; 
#&gt; b1 = 1.665536e+00 +/- NA
#&gt; n01 = 1.36904e+04 +/- NA
#&gt; 
#&gt; b2 = 9.574028e-02 +/- NA
#&gt; n02 = 7.753496e+03 +/- NA
#&gt; 
#&gt; b3 = 1.578908e-03 +/- NA
#&gt; n03 = 1.064017e+06 +/- NA
#&gt; 
#&gt; cs from component.1 = 1.955e-17 cm^2	 &gt;&gt; relative: 1
#&gt; cs from component.2 = 1.124e-18 cm^2	 &gt;&gt; relative: 0.0575
#&gt; cs from component.3 = 1.854e-20 cm^2	 &gt;&gt; relative: 9e-04
#&gt; 
#&gt; (stimulation intensity value used for calculation: 8.517726e+16 1/s 1/cm^2)
#&gt; (errors quoted as 1-sigma uncertainties)
#&gt; ------------------------------------------------------------------------------
#&gt; 
#&gt; pseudo-R^2 = 0.9437</div><div class='img'><img src='fit_LMCurve-4.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


