<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply the finite mixture model (FMM) after Galbraith (2005) to a given De distribution — calc_FiniteMixture • Luminescence</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply the finite mixture model (FMM) after Galbraith (2005) to a given De distribution — calc_FiniteMixture"><meta name="description" content="This function fits a k-component mixture to a De distribution with differing
known standard errors. Parameters (doses and mixing proportions) are
estimated by maximum likelihood assuming that the log dose estimates are
from a mixture of normal distributions."><meta property="og:description" content="This function fits a k-component mixture to a De distribution with differing
known standard errors. Parameters (doses and mixing proportions) are
estimated by maximum likelihood assuming that the log dose estimates are
from a mixture of normal distributions."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.25</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Apply the finite mixture model (FMM) after Galbraith (2005) to a given De distribution</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/HEAD/R/calc_FiniteMixture.R" class="external-link"><code>R/calc_FiniteMixture.R</code></a></small>
      <div class="d-none name"><code>calc_FiniteMixture.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function fits a k-component mixture to a De distribution with differing
known standard errors. Parameters (doses and mixing proportions) are
estimated by maximum likelihood assuming that the log dose estimates are
from a mixture of normal distributions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_FiniteMixture</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">sigmab</span>,</span>
<span>  <span class="va">n.components</span>,</span>
<span>  grain.probability <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">dose.scale</span>,</span>
<span>  pdf.weight <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pdf.sigma <span class="op">=</span> <span class="st">"sigmab"</span>,</span>
<span>  pdf.colors <span class="op">=</span> <span class="st">"gray"</span>,</span>
<span>  <span class="va">pdf.scale</span>,</span>
<span>  plot.proportions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><a href="RLum.Results-class.html">RLum.Results</a> or <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<strong>required</strong>):
for <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a>: two columns with De <code>(data[,1])</code> and De error <code>(values[,2])</code></p></dd>


<dt id="arg-sigmab">sigmab<a class="anchor" aria-label="anchor" href="#arg-sigmab"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>):
spread in De values given as a fraction (e.g. 0.2). This value represents the expected
overdispersion in the data should the sample be well-bleached
(Cunningham &amp; Wallinga 2012, p. 100).</p></dd>


<dt id="arg-n-components">n.components<a class="anchor" aria-label="anchor" href="#arg-n-components"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>):
number of components to be fitted. If a vector is provided (e.g. <code>c(2:8)</code>) the
finite mixtures for 2, 3 ... 8 components are calculated and a plot and a
statistical evaluation of the model performance (BIC score and maximum
log-likelihood) is provided.</p></dd>


<dt id="arg-grain-probability">grain.probability<a class="anchor" aria-label="anchor" href="#arg-grain-probability"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
prints the estimated probabilities of which component each grain is in</p></dd>


<dt id="arg-dose-scale">dose.scale<a class="anchor" aria-label="anchor" href="#arg-dose-scale"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a>:
manually set the scaling of the y-axis of the first plot with a vector
in the form of <code>c(min, max)</code></p></dd>


<dt id="arg-pdf-weight">pdf.weight<a class="anchor" aria-label="anchor" href="#arg-pdf-weight"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
weight the probability density functions by the components proportion (applies only
when a vector is provided for <code>n.components</code>)</p></dd>


<dt id="arg-pdf-sigma">pdf.sigma<a class="anchor" aria-label="anchor" href="#arg-pdf-sigma"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
if <code>"sigmab"</code> the components normal distributions are plotted with a common standard
deviation (i.e. <code>sigmab</code>) as assumed by the FFM. Alternatively,
<code>"se"</code> takes the standard error of each component for the sigma
parameter of the normal distribution</p></dd>


<dt id="arg-pdf-colors">pdf.colors<a class="anchor" aria-label="anchor" href="#arg-pdf-colors"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
colour coding of the components in the the plot.
Possible options are <code>"gray"</code>, <code>"colors"</code> and <code>"none"</code></p></dd>


<dt id="arg-pdf-scale">pdf.scale<a class="anchor" aria-label="anchor" href="#arg-pdf-scale"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a>:
manually set the max density value for proper scaling of the x-axis of the first plot</p></dd>


<dt id="arg-plot-proportions">plot.proportions<a class="anchor" aria-label="anchor" href="#arg-plot-proportions"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
plot <a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">graphics::barplot</a> showing the proportions of components if
<code>n.components</code> a vector with a length &gt; 1 (e.g., <code>n.components = c(2:3)</code>)</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):  plot output</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments to pass. See details for their usage.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a plot (<em>optional</em>) and terminal output. In addition an
<a href="RLum.Results-class.html">RLum.Results</a> object is returned containing the
following elements:</p>
<dl><dt>.$summary</dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> summary of all relevant model results.</p></dd>

<dt>.$data</dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> original input data</p></dd>

<dt>.$args</dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> used arguments</p></dd>

<dt>.$call</dt>
<dd><p><a href="https://rdrr.io/r/base/call.html" class="external-link">call</a> the function call</p></dd>

<dt>.$mle</dt>
<dd><p>covariance matrices of the log likelihoods</p></dd>

<dt>.$BIC</dt>
<dd><p>BIC score</p></dd>

<dt>.$llik</dt>
<dd><p>maximum log likelihood</p></dd>

<dt>.$grain.probability</dt>
<dd><p>probabilities of a grain belonging to a component</p></dd>

<dt>.$components</dt>
<dd><p><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a> estimates of the de, de error and proportion for each component</p></dd>

<dt>.$single.comp</dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> single component FFM estimate</p></dd>


</dl><p>If a vector for <code>n.components</code> is provided (e.g.  <code>c(2:8)</code>),
<code>mle</code> and <code>grain.probability</code> are lists containing matrices of the
results for each iteration of the model.</p>
<p>The output should be accessed using the function <a href="get_RLum.html">get_RLum</a></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This model uses the maximum likelihood and Bayesian Information Criterion
(BIC) approaches.</p>
<p>Indications of overfitting are:</p><ul><li><p>increasing BIC</p></li>
<li><p>repeated dose estimates</p></li>
<li><p>covariance matrix not positive definite</p></li>
<li><p>covariance matrix produces <code>NaN</code></p></li>
<li><p>convergence problems</p></li>
</ul><p><strong>Plot</strong></p>
<p>If a vector (<code>c(k.min:k.max)</code>) is provided
for <code>n.components</code> a plot is generated showing the the k components
equivalent doses as normal distributions. By default <code>pdf.weight</code> is
set to <code>FALSE</code>, so that the area under each normal distribution is
always 1. If <code>TRUE</code>, the probability density functions are weighted by
the components proportion for each iteration of k components, so the sum of
areas of each component equals 1. While the density values are on the same
scale when no weights are used, the y-axis are individually scaled if the
probability density are weighted by the components proportion.<br>
The standard deviation (sigma) of the normal distributions is by default
determined by a common <code>sigmab</code> (see <code>pdf.sigma</code>). For
<code>pdf.sigma = "se"</code> the standard error of each component is taken
instead.<br>
The stacked <a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">graphics::barplot</a> shows the proportion of each component (in
per cent) calculated by the FFM. The last plot shows the achieved BIC scores
and maximum log-likelihood estimates for each iteration of k.</p>
    </div>
    <div class="section level2">
    <h2 id="function-version">Function version<a class="anchor" aria-label="anchor" href="#function-version"></a></h2>
    <p>0.4.2</p>
    </div>
    <div class="section level2">
    <h2 id="how-to-cite">How to cite<a class="anchor" aria-label="anchor" href="#how-to-cite"></a></h2>
    <p>Burow, C., 2024. calc_FiniteMixture(): Apply the finite mixture model (FMM) after Galbraith (2005) to a given De distribution. Function version 0.4.2. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., Colombo, M., 2024. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.25. https://r-lum.github.io/Luminescence/</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Galbraith, R.F. &amp; Green, P.F., 1990. Estimating the component
ages in a finite mixture. Nuclear Tracks and Radiation Measurements 17,
197-206.</p>
<p>Galbraith, R.F. &amp; Laslett, G.M., 1993. Statistical models
for mixed fission track ages. Nuclear Tracks Radiation Measurements 4,
459-470.</p>
<p>Galbraith, R.F. &amp; Roberts, R.G., 2012. Statistical aspects of
equivalent dose and error calculation and display in OSL dating: An overview
and some recommendations. Quaternary Geochronology 11, 1-27.</p>
<p>Roberts, R.G., Galbraith, R.F., Yoshida, H., Laslett, G.M. &amp; Olley, J.M., 2000.
Distinguishing dose populations in sediment mixtures: a test of single-grain
optical dating procedures using mixtures of laboratory-dosed quartz.
Radiation Measurements 32, 459-465.</p>
<p>Galbraith, R.F., 2005. Statistics for Fission Track Analysis, Chapman &amp; Hall/CRC, Boca Raton.</p>
<p><strong>Further reading</strong></p>
<p>Arnold, L.J. &amp; Roberts, R.G., 2009. Stochastic
modelling of multi-grain equivalent dose (De) distributions: Implications
for OSL dating of sediment mixtures. Quaternary Geochronology 4,
204-230.</p>
<p>Cunningham, A.C. &amp; Wallinga, J., 2012. Realizing the
potential of fluvial archives using robust OSL chronologies. Quaternary
Geochronology 12, 98-106.</p>
<p>Rodnight, H., Duller, G.A.T., Wintle, A.G. &amp;
Tooth, S., 2006. Assessing the reproducibility and accuracy of optical
dating of fluvial deposits.  Quaternary Geochronology 1, 109-120.</p>
<p>Rodnight, H. 2008. How many equivalent dose values are needed to obtain a
reproducible distribution?. Ancient TL 26, 3-10.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="calc_CentralDose.html">calc_CentralDose</a>, <a href="calc_CommonDose.html">calc_CommonDose</a>,
<a href="calc_FuchsLang2001.html">calc_FuchsLang2001</a>, <a href="calc_MinDose.html">calc_MinDose</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Christoph Burow, University of Cologne (Germany) <br>
Based on a rewritten S script of Rex Galbraith, 2006.
, RLum Developer Team</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## load example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.DeValues</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## (1) apply the finite mixture model</span></span></span>
<span class="r-in"><span><span class="co">## NOTE: the data set is not suitable for the finite mixture model,</span></span></span>
<span class="r-in"><span><span class="co">## which is why a very small sigmab is necessary</span></span></span>
<span class="r-in"><span><span class="fu">calc_FiniteMixture</span><span class="op">(</span><span class="va">ExampleData.DeValues</span><span class="op">$</span><span class="va">CA1</span>,</span></span>
<span class="r-in"><span>                   sigmab <span class="op">=</span> <span class="fl">0.2</span>, n.components <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                   grain.probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [calc_FiniteMixture]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- covariance matrix of mle's ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.002144 0.001821 0.000283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.001821 0.013319 0.000877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.000283 0.000877 0.001118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------- meta data ------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  n:                     62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sigmab:                0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  number of components:  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  llik:                  -20.3938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  BIC:                    53.169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------- components -----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 comp1   comp2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dose (Gy)     31.5299 72.0333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rse(dose)      0.1154  0.0334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> se(dose)(Gy)   3.6387  2.4082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> proportion     0.1096  0.8904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------- grain probability -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 1.00 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 1.00 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 1.00 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.99 0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.94 0.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.91 0.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.29 0.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.13 0.87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.11 0.89</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.10 0.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.09 0.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.06 0.94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 0.04 0.96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 0.03 0.97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.04 0.96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 0.02 0.98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 0.01 0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 0.01 0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 0.01 0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [34,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [35,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [38,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [40,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [42,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [44,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [45,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [47,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [48,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [50,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [51,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [52,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [53,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [54,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [55,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [56,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [57,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [58,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [59,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [60,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [62,] 0.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------- single component --------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  mu:                     65.2273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sigmab:                 0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  llik:                   -44.96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  BIC:                    94.047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## (2) repeat the finite mixture model for 2, 3 and 4 maximum number of fitted</span></span></span>
<span class="r-in"><span><span class="co">## components and save results</span></span></span>
<span class="r-in"><span><span class="co">## NOTE: The following example is computationally intensive. Please un-comment</span></span></span>
<span class="r-in"><span><span class="co">## the following lines to make the example work.</span></span></span>
<span class="r-in"><span><span class="va">FMM</span><span class="op">&lt;-</span> <span class="fu">calc_FiniteMixture</span><span class="op">(</span><span class="va">ExampleData.DeValues</span><span class="op">$</span><span class="va">CA1</span>,</span></span>
<span class="r-in"><span>                         sigmab <span class="op">=</span> <span class="fl">0.2</span>, n.components <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         pdf.weight <span class="op">=</span> <span class="cn">TRUE</span>, dose.scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [calc_FiniteMixture]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------- meta data ------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  n:                     62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sigmab:                0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  number of components:  2-4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------- single component --------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  mu:                     65.2273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sigmab:                 0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  llik:                   -44.96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  BIC:                    94.047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------- k components -----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             2     3     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c1_dose 31.53 29.91 29.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c1_se    3.64  3.97  4.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c1_prop  0.11  0.09  0.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c2_dose 72.03 56.65 56.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c2_se    2.41 13.05 33.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c2_prop  0.89  0.25  0.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c3_dose  &lt;NA&gt; 77.49 56.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c3_se    &lt;NA&gt;  6.37 21.31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c3_prop  &lt;NA&gt;  0.66  0.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c4_dose  &lt;NA&gt;  &lt;NA&gt; 77.49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c4_se    &lt;NA&gt;  &lt;NA&gt;  7.68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c4_prop  &lt;NA&gt;  &lt;NA&gt;  0.66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------- statistical criteria -----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            2       3       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC   53.169  59.719  67.973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> llik -20.394 -19.542 -19.542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Lowest BIC score for k = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  No significant increase in maximum log likelihood estimates. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## show structure of the results</span></span></span>
<span class="r-in"><span><span class="va">FMM</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [RLum.Results-class]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 originator: calc_FiniteMixture()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 data: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  	 .. $summary : data.frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $data : data.frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $args : list</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $call : call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $mle : list</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $BIC : data.frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $llik : data.frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $grain.probability : list</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $components : matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $single.comp : data.frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 additional info elements:  0 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## show the results on equivalent dose, standard error and proportion of</span></span></span>
<span class="r-in"><span><span class="co">## fitted components</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">FMM</span>, data.object <span class="op">=</span> <span class="st">"components"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             2     3     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c1_dose 31.53 29.91 29.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c1_se    3.64  3.97  4.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c1_prop  0.11  0.09  0.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c2_dose 72.03 56.65 56.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c2_se    2.41 13.05 33.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c2_prop  0.89  0.25  0.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c3_dose    NA 77.49 56.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c3_se      NA  6.37 21.31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c3_prop    NA  0.66  0.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c4_dose    NA    NA 77.49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c4_se      NA    NA  7.68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c4_prop    NA    NA  0.66</span>
<span class="r-in"><span></span></span>
<span class="r-plt img"><img src="calc_FiniteMixture-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

