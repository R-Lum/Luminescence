<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot kernel density estimate with statistics — plot_KDE • Luminescence</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot kernel density estimate with statistics — plot_KDE" />
<meta property="og:description" content="Plot a kernel density estimate of measurement values in combination with the
actual values and associated error bars in ascending order. If enabled, the
boxplot will show the usual distribution parameters (median as
bold line, box delimited by the first and third quartile, whiskers defined
by the extremes and outliers shown as points) and also the mean and
standard deviation as pale bold line and pale polygon, respectively." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/index.html">
    <span class="fa fa-play"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/NEWS_Version0.9.0.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot kernel density estimate with statistics</h1>
    <small class="dont-index">Source: <a href='https://github.com/R-Lum/Luminescence/blob/master/R/plot_KDE.R'><code>R/plot_KDE.R</code></a></small>
    <div class="hidden name"><code>plot_KDE.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plot a kernel density estimate of measurement values in combination with the
actual values and associated error bars in ascending order. If enabled, the
boxplot will show the usual distribution parameters (median as
bold line, box delimited by the first and third quartile, whiskers defined
by the extremes and outliers shown as points) and also the mean and
standard deviation as pale bold line and pale polygon, respectively.</p>
    </div>

    <pre class="usage"><span class='fu'>plot_KDE</span><span class='op'>(</span>
  <span class='va'>data</span>,
  na.rm <span class='op'>=</span> <span class='cn'>TRUE</span>,
  values.cumulative <span class='op'>=</span> <span class='cn'>TRUE</span>,
  order <span class='op'>=</span> <span class='cn'>TRUE</span>,
  boxplot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  rug <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>summary</span>,
  <span class='va'>summary.pos</span>,
  summary.method <span class='op'>=</span> <span class='st'>"MCM"</span>,
  bw <span class='op'>=</span> <span class='st'>"nrd0"</span>,
  output <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a> or <a href='RLum.Results-class.html'>RLum.Results</a> object (<strong>required</strong>):
for <code>data.frame</code>: two columns: De (<code>values[,1]</code>) and De error (<code>values[,2]</code>).
For plotting multiple data sets, these must be provided as
<code>list</code> (e.g. <code><a href='https://rdrr.io/r/base/list.html'>list(dataset1, dataset2)</a></code>).</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
exclude NA values from the data set prior to any further operation.</p></td>
    </tr>
    <tr>
      <th>values.cumulative</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
show cumulative individual data.</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a>:
Order data in ascending order.</p></td>
    </tr>
    <tr>
      <th>boxplot</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
optionally show a boxplot (depicting median as thick central line,
first and third quartile as box limits, whiskers denoting +/- 1.5
interquartile ranges and dots further outliers).</p></td>
    </tr>
    <tr>
      <th>rug</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
optionally add rug.</p></td>
    </tr>
    <tr>
      <th>summary</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (<em>optional</em>):
add statistic measures of centrality and dispersion to the plot. Can be one
or more of several keywords. See details for available keywords.</p></td>
    </tr>
    <tr>
      <th>summary.pos</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> or <a href='https://rdrr.io/r/base/character.html'>character</a> (<em>with default</em>):
optional position coordinates or keyword (e.g. <code>"topright"</code>)
for the statistical summary. Alternatively, the keyword <code>"sub"</code> may be
specified to place the summary below the plot header. However, this latter
option in only possible if <code>mtext</code> is not used. In case of coordinate
specification, y-coordinate refers to the right y-axis.</p></td>
    </tr>
    <tr>
      <th>summary.method</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (<em>with default</em>):
keyword indicating the method used to calculate the statistic summary.
One out of <code>"unweighted"</code>, <code>"weighted"</code> and <code>"MCM"</code>.
See <a href='calc_Statistics.html'>calc_Statistics</a> for details.</p></td>
    </tr>
    <tr>
      <th>bw</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (<em>with default</em>):
bin-width, chose a numeric value for manual setting.</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a>:
Optional output of numerical plot parameters. These can be useful to
reproduce similar plots. Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments and graphical parameters passed to <a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function allows passing several plot arguments, such as <code>main</code>,
<code>xlab</code>, <code>cex</code>. However, as the figure is an overlay of two
separate plots, <code>ylim</code> must be specified in the order: c(ymin_axis1,
ymax_axis1, ymin_axis2, ymax_axis2) when using the cumulative values plot
option. See examples for some further explanations. For details on the
calculation of the bin-width (parameter <code>bw</code>) see
<a href='https://rdrr.io/r/stats/density.html'>density</a>.</p>
<p>A statistic summary, i.e. a collection of statistic measures of
centrality and dispersion (and further measures) can be added by specifying
one or more of the following keywords:</p><ul>
<li><p><code>"n"</code> (number of samples)</p></li>
<li><p><code>"mean"</code> (mean De value)</p></li>
<li><p><code>"median"</code> (median of the De values)</p></li>
<li><p><code>"sd.rel"</code> (relative standard deviation in percent)</p></li>
<li><p><code>"sd.abs"</code> (absolute standard deviation)</p></li>
<li><p><code>"se.rel"</code> (relative standard error)</p></li>
<li><p><code>"se.abs"</code> (absolute standard error)</p></li>
<li><p><code>"in.2s"</code> (percent of samples in 2-sigma range)</p></li>
<li><p><code>"kurtosis"</code> (kurtosis)</p></li>
<li><p><code>"skewness"</code> (skewness)</p></li>
</ul>

<p><strong>Note</strong> that the input data for the statistic summary is sent to the function
<code><a href='calc_Statistics.html'>calc_Statistics()</a></code> depending on the log-option for the z-scale. If
<code>"log.z = TRUE"</code>, the summary is based on the logarithms of the input
data. If <code>"log.z = FALSE"</code> the linearly scaled data is used.</p>
<p><strong>Note</strong> as well, that <code>"calc_Statistics()"</code> calculates these statistic
measures in three different ways: <code>unweighted</code>, <code>weighted</code> and
<code>MCM-based</code> (i.e., based on Monte Carlo Methods). By default, the
MCM-based version is used. If you wish to use another method, indicate this
with the appropriate keyword using the argument <code>summary.method</code>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The plot output is no 'probability density' plot (cf. the discussion
of Berger and Galbraith in Ancient TL; see references)!</p>
    <h2 class="hasAnchor" id="function-version"><a class="anchor" href="#function-version"></a>Function version</h2>

    <p>3.6.0</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='https://rdrr.io/r/stats/density.html'>density</a>, <a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Michael Dietze, GFZ Potsdam (Germany)<br />
Sebastian Kreutzer, IRAMAT-CRP2A, UMR 5060, CNRS-Université Bordeaux Montaigne, France
, RLum Developer Team</p>
    <h2 class="hasAnchor" id="how-to-cite"><a class="anchor" href="#how-to-cite"></a>How to cite</h2>

    <p>Dietze, M., Kreutzer, S., 2020. plot_KDE(): Plot kernel density estimate with statistics. Function version 3.6.0. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., 2020. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.7. https://CRAN.R-project.org/package=Luminescence</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## read example data set</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>ExampleData.DeValues</span>, envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>environment</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ExampleData.DeValues</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='Second2Gray.html'>Second2Gray</a></span><span class='op'>(</span><span class='va'>ExampleData.DeValues</span><span class='op'>$</span><span class='va'>BT998</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.0438</span>,<span class='fl'>0.0019</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## create plot straightforward</span>
<span class='fu'>plot_KDE</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ExampleData.DeValues</span><span class='op'>)</span>
</div><div class='img'><img src='plot_KDE-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## create plot with logarithmic x-axis</span>
<span class='fu'>plot_KDE</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ExampleData.DeValues</span>,
         log <span class='op'>=</span> <span class='st'>"x"</span><span class='op'>)</span>
</div><div class='img'><img src='plot_KDE-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## create plot with user-defined labels and axes limits</span>
<span class='fu'>plot_KDE</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ExampleData.DeValues</span>,
         main <span class='op'>=</span> <span class='st'>"Dose distribution"</span>,
         xlab <span class='op'>=</span> <span class='st'>"Dose (s)"</span>,
         ylab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"KDE estimate"</span>, <span class='st'>"Cumulative dose value"</span><span class='op'>)</span>,
         xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>250</span><span class='op'>)</span>,
         ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.08</span>, <span class='fl'>0</span>, <span class='fl'>30</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='plot_KDE-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## create plot with boxplot option</span>
<span class='fu'>plot_KDE</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ExampleData.DeValues</span>,
         boxplot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='plot_KDE-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## create plot with statistical summary below header</span>
<span class='fu'>plot_KDE</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ExampleData.DeValues</span>,
         summary <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"n"</span>, <span class='st'>"median"</span>, <span class='st'>"skewness"</span>, <span class='st'>"in.2s"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='plot_KDE-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## create plot with statistical summary as legend</span>
<span class='fu'>plot_KDE</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ExampleData.DeValues</span>,
         summary <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"n"</span>, <span class='st'>"mean"</span>, <span class='st'>"sd.rel"</span>, <span class='st'>"se.abs"</span><span class='op'>)</span>,
         summary.pos <span class='op'>=</span> <span class='st'>"topleft"</span><span class='op'>)</span>
</div><div class='img'><img src='plot_KDE-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## split data set into sub-groups, one is manipulated, and merge again</span>
<span class='va'>data.1</span> <span class='op'>&lt;-</span> <span class='va'>ExampleData.DeValues</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>15</span>,<span class='op'>]</span>
<span class='va'>data.2</span> <span class='op'>&lt;-</span> <span class='va'>ExampleData.DeValues</span><span class='op'>[</span><span class='fl'>16</span><span class='op'>:</span><span class='fl'>25</span>,<span class='op'>]</span> <span class='op'>*</span> <span class='fl'>1.3</span>
<span class='va'>data.3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>data.1</span>, <span class='va'>data.2</span><span class='op'>)</span>

<span class='co'>## create plot with two subsets straightforward</span>
<span class='fu'>plot_KDE</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>data.3</span><span class='op'>)</span>
</div><div class='img'><img src='plot_KDE-7.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## create plot with two subsets and summary legend at user coordinates</span>
<span class='fu'>plot_KDE</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>data.3</span>,
         summary <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"n"</span>, <span class='st'>"median"</span>, <span class='st'>"skewness"</span><span class='op'>)</span>,
         summary.pos <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>110</span>, <span class='fl'>0.07</span><span class='op'>)</span>,
         col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>, <span class='st'>"orange"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='plot_KDE-8.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## example of how to use the numerical output of the function</span>
<span class='co'>## return plot output to draw a thicker KDE line</span>
<span class='va'>KDE_out</span> <span class='op'>&lt;-</span> <span class='fu'>plot_KDE</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ExampleData.DeValues</span>,
output <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='plot_KDE-9.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


