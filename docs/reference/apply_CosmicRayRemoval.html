<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Function to remove cosmic rays from an RLum.Data.Spectrum S4 class object — apply_CosmicRayRemoval • Luminescence</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Function to remove cosmic rays from an RLum.Data.Spectrum S4 class object — apply_CosmicRayRemoval"><meta property="og:description" content="The function provides several methods for cosmic-ray removal and spectrum
smoothing RLum.Data.Spectrum objects and such objects embedded in list or
RLum.Analysis objects."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.24.9000-106</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence" class="external-link">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function to remove cosmic rays from an RLum.Data.Spectrum S4 class object</h1>
    <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/HEAD/R/apply_CosmicRayRemoval.R" class="external-link"><code>R/apply_CosmicRayRemoval.R</code></a></small>
    <div class="hidden name"><code>apply_CosmicRayRemoval.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function provides several methods for cosmic-ray removal and spectrum
smoothing <a href="RLum.Data.Spectrum-class.html">RLum.Data.Spectrum</a> objects and such objects embedded in <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> or
<a href="RLum.Analysis-class.html">RLum.Analysis</a> objects.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">apply_CosmicRayRemoval</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"smooth"</span>,</span>
<span>  method.Pych.smoothing <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  method.Pych.threshold_factor <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  MARGIN <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p><a href="RLum.Data.Spectrum-class.html">RLum.Data.Spectrum</a> or <a href="RLum.Analysis-class.html">RLum.Analysis</a> (<strong>required</strong>): input
object to be treated. This can be also provided as <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a>. If an <a href="RLum.Analysis-class.html">RLum.Analysis</a> object
is provided, only the <a href="RLum.Data.Spectrum-class.html">RLum.Data.Spectrum</a> objects are treated. Please note: this mixing of
objects do not work for a list of <code>RLum.Data</code> objects.</p></dd>


<dt>method</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
Defines method that is applied for cosmic ray removal. Allowed methods are
<code>smooth</code>, the default, (<a href="https://rdrr.io/r/stats/smooth.html" class="external-link">smooth</a>), <code>smooth.spline</code> (<a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline</a>)
and <code>Pych</code>. See details for further information.</p></dd>


<dt>method.Pych.smoothing</dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
Smoothing parameter for cosmic ray removal according to Pych (2003).
The value defines how many neighbouring values in each frame are used for smoothing
(e.g., <code>2</code> means that the two previous and two following values are used).</p></dd>


<dt>method.Pych.threshold_factor</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
Threshold for zero-bins in the histogram. Small values mean that more peaks
are removed, but signal might be also affected by this removal.</p></dd>


<dt>MARGIN</dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
on which part the function cosmic ray removal should be applied on:</p><ul><li><p>1 = along the time axis (line by line),</p></li>
<li><p>2 = along the wavelength axis (column by column).</p></li>
</ul><p><strong>Note:</strong> This argument currently only affects the methods <code>smooth</code> and <code>smooth.spline</code></p></dd>


<dt>verbose</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
Option to suppress terminal output.,</p></dd>


<dt>plot</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
If <code>TRUE</code> the histograms used for the cosmic-ray removal are returned as plot
including the used threshold. Note: A separate plot is returned for each frame!
Currently only for <code>method = "Pych"</code> a graphical output is provided.</p></dd>


<dt>...</dt>
<dd><p>further arguments and graphical parameters that will be passed
to the <a href="https://rdrr.io/r/stats/smooth.html" class="external-link">smooth</a> function.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns same object as input.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><strong><code>method = "Pych"</code></strong></p>
<p>This method applies the cosmic-ray removal algorithm described by Pych
(2003). Some aspects that are different to the publication:</p><ul><li><p>For interpolation between neighbouring values the median and not the mean is used.</p></li>
<li><p>The number of breaks to construct the histogram is set to: <code>length(number.of.input.values)/2</code></p></li>
</ul><p>For further details see references below.</p>
<p><strong><code>method = "smooth"</code></strong></p>
<p>Method uses the function <a href="https://rdrr.io/r/stats/smooth.html" class="external-link">smooth</a> to remove cosmic rays.</p>
<p>Arguments that can be passed are: <code>kind</code>, <code>twiceit</code></p>
<p><strong><code>method = "smooth.spline"</code></strong></p>
<p>Method uses the function <a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline</a> to remove cosmic rays.</p>
<p>Arguments that can be passed are: <code>spar</code></p>
<p><strong>How to combine methods?</strong></p>
<p>Different methods can be combined by applying the method repeatedly to the
dataset (see example).</p>
    </div>
    <div id="function-version">
    <h2>Function version</h2>
    <p>0.3.0</p>
    </div>
    <div id="how-to-cite">
    <h2>How to cite</h2>
    <p>Kreutzer, S., 2024. apply_CosmicRayRemoval(): Function to remove cosmic rays from an RLum.Data.Spectrum S4 class object. Function version 0.3.0. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., 2024. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.24.9000-106. https://CRAN.R-project.org/package=Luminescence</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Pych, W., 2004. A Fast Algorithm for Cosmic-Ray Removal from
Single Images. The Astronomical Society of the Pacific 116 (816), 148-153.
<a href="https://doi.org/10.1086/381786" class="external-link">doi:10.1086/381786</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="RLum.Data.Spectrum-class.html">RLum.Data.Spectrum</a>, <a href="RLum.Analysis-class.html">RLum.Analysis</a>, <a href="https://rdrr.io/r/stats/smooth.html" class="external-link">smooth</a>, <a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline</a>,
apply_CosmicRayRemoval</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)
, RLum Developer Team</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(1) - use with your own data and combine (uncomment for usage)</span></span></span>
<span class="r-in"><span><span class="co">## run two times the default method and smooth with another method</span></span></span>
<span class="r-in"><span><span class="co">## your.spectrum &lt;- apply_CosmicRayRemoval(your.spectrum, method = "Pych")</span></span></span>
<span class="r-in"><span><span class="co">## your.spectrum &lt;- apply_CosmicRayRemoval(your.spectrum, method = "Pych")</span></span></span>
<span class="r-in"><span><span class="co">## your.spectrum &lt;- apply_CosmicRayRemoval(your.spectrum, method = "smooth")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

