<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fitting Thermal Quenching Data — fit_ThermalQuenching • Luminescence</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting Thermal Quenching Data — fit_ThermalQuenching"><meta property="og:description" content="Applying a nls-fitting to thermal quenching data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.23</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/index.html">
    <span class="fa fa-play"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence" class="external-link">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting Thermal Quenching Data</h1>
    <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/HEAD/R/fit_ThermalQuenching.R" class="external-link"><code>R/fit_ThermalQuenching.R</code></a></small>
    <div class="hidden name"><code>fit_ThermalQuenching.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Applying a nls-fitting to thermal quenching data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_ThermalQuenching</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  start_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  method_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  n.MC <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<strong>required</strong>): input data with three columns, the first column contains
temperature values in deg. C, columns 2 and 3 the dependent values with its error</p></dd>


<dt>start_param</dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> (optional): option to provide own start parameters for the fitting, see
details</p></dd>


<dt>method_control</dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> (optional): further options to fine tune the fitting, see details for
further information</p></dd>


<dt>n.MC</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>): number of Monte Carlo runs for the error estimation. If <code>n.MC</code> is
<code>NULL</code> or <code>&lt;=1</code>, the error estimation is skipped</p></dd>


<dt>verbose</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>): enables/disables terminal output</p></dd>


<dt>plot</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>): enables/disables plot output</p></dd>


<dt>...</dt>
<dd><p>further arguments that can be passed to control the plotting, support are <code>main</code>, <code>pch</code>,
<code>col_fit</code>, <code>col_points</code>, <code>lty</code>, <code>lwd</code>, <code>xlab</code>, <code>ylab</code>, <code>xlim</code>, <code>ylim</code>, <code>xaxt</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The function returns numerical output and an (<em>optional</em>) plot.</p>


<p>-----------------------------------<br></p>


<p><code>[ NUMERICAL OUTPUT ]</code><br></p>


<p>-----------------------------------<br></p>



<p><strong><code>RLum.Results</code></strong>-object</p>


<p><strong>slot:</strong></p>
<p></p>
<p><strong><code>@data</code></strong></p>



<p><code>[.. $data : data.frame]</code><br></p>



<p>A table with all fitting parameters and the number of Monte Carlo runs used for the error estimation.</p>


<p><code>[.. $fit : nls object]</code></p>
<p></p>
<p><br></p>



<p>The nls <a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls</a> object returned by the function <a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a>. This object
can be further passed to other functions supporting an nls object (cf. details section
in <a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls</a>)</p>


<p><strong>slot:</strong></p>
<p></p>
<p><strong><code>@info</code></strong></p>



<p><code>[.. $call : call]</code><br></p>



<p>The original function call.</p>


<p>-----------------------------------<br></p>


<p><code>[ GAPHICAL OUTPUT ]</code><br></p>


<p>-----------------------------------<br></p>



<p>Plotted are temperature against the signal and their uncertainties.
The fit is shown as dashed-line (can be modified). Please note that for the fitting the absolute
temperature values are used but are re-calculated to deg. C for the plot.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><strong>Used equation</strong><br></p>
<p>The equation used for the fitting is</p>
<p>$$y = (A / (1 + C * (exp(-W / (k * x))))) + c$$</p>
<p><em>W</em> is the energy depth in eV and <em>C</em> is dimensionless constant. <em>A</em> and <em>c</em> are used to
adjust the curve for the given signal. <em>k</em> is the Boltzmann in eV/K and <em>x</em> is the absolute
temperature in K.</p>
<p><strong>Error estimation</strong><br></p>
<p>The error estimation is done be varying the input parameters using the given uncertainties in
a Monte Carlo simulation. Errors are assumed to follow a normal distribution.</p>
<p><strong><code>start_param</code></strong> <br></p>
<p>The function allows the injection of own start parameters via the argument <code>start_param</code>. The
parameters needs to be provided as names list. The names are the parameters to be optimised.
Examples: <code>start_param = list(A = 1, C = 1e+5, W = 0.5, c = 0)</code></p>
<p><strong><code>method_control</code></strong> <br></p>
<p>The following arguments can be provided via <code>method_control</code>. Please note that arguments provided
via <code>method_control</code> are not further tested, i.e., if the function crashes your input was probably
wrong.</p>
<table class="table table"><tr><td><strong>ARGUMENT</strong></td><td><strong>TYPE</strong></td><td><strong>DESCRIPTION</strong></td></tr><tr><td><code>upper</code></td><td>named <a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></td><td>sets upper fitting boundaries, if provided boundaries for all arguments
are required, e.g., <code>c(A = 0, C = 0, W = 0, c = 0)</code></td></tr><tr><td><code>lower</code></td><td>names <a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></td><td>sets lower fitting boundaries (see <code>upper</code> for details)</td></tr><tr><td><code>trace</code></td><td><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></td><td>enables/disables progression trace for <a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a></td></tr><tr><td><code>weights</code></td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>option to provide own weights for the fitting, the length of this
vector needs to be equal to the number for rows of the input <code>data.frame</code>. If set to <code>NULL</code> no weights
are applied. The weights are defined by the third column of the input <code>data.frame</code>.</td></tr></table></div>
    <div id="function-version">
    <h2>Function version</h2>
    <p>0.1.0</p>
    </div>
    <div id="how-to-cite">
    <h2>How to cite</h2>
    <p>Kreutzer, S., 2023. fit_ThermalQuenching(): Fitting Thermal Quenching Data. Function version 0.1.0. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., 2023. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.23. https://CRAN.R-project.org/package=Luminescence</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Wintle, A.G., 1975. Thermal Quenching of Thermoluminescence in Quartz. Geophys. J. R. astr. Soc. 41, 107–113.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)
, RLum Developer Team</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##create short example dataset</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  T <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span>, <span class="fl">70</span>, <span class="fl">80</span>, <span class="fl">90</span>, <span class="fl">100</span>, <span class="fl">110</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.06</span>, <span class="fl">0.058</span>, <span class="fl">0.052</span>, <span class="fl">0.051</span>, <span class="fl">0.041</span>, <span class="fl">0.034</span>, <span class="fl">0.035</span>, <span class="fl">0.033</span>, <span class="fl">0.032</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  V_X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.012</span>, <span class="fl">0.009</span>, <span class="fl">0.008</span>, <span class="fl">0.008</span>, <span class="fl">0.007</span>, <span class="fl">0.006</span>, <span class="fl">0.005</span>, <span class="fl">0.005</span>, <span class="fl">0.004</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##fit</span></span></span>
<span class="r-in"><span><span class="fu">fit_ThermalQuenching</span><span class="op">(</span></span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span> n.MC <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [fit_ThermalQuenching()]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A =  0.02831547  ±  NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  C =  8.678659e+14  ±  NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  W =  0.9986951  ±  NA  eV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  c =  0.03151218  ±  NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  --------------------------------</span>
<span class="r-plt img"><img src="fit_ThermalQuenching-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [RLum.Results-class]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 originator: fit_ThermalQuenching()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 data: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  	 .. $data : data.frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $fit : nls</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 additional info elements:  1 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

