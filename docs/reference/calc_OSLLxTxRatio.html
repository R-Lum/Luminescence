<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Lx/Tx ratio for CW-OSL curves — calc_OSLLxTxRatio • Luminescence</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Lx/Tx ratio for CW-OSL curves — calc_OSLLxTxRatio"><meta name="description" content="Calculate Lx/Tx ratios from a given set of CW-OSL curves assuming late light
background subtraction."><meta property="og:description" content="Calculate Lx/Tx ratios from a given set of CW-OSL curves assuming late light
background subtraction."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.25</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate <code>Lx/Tx</code> ratio for CW-OSL curves</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/HEAD/R/calc_OSLLxTxRatio.R" class="external-link"><code>R/calc_OSLLxTxRatio.R</code></a></small>
      <div class="d-none name"><code>calc_OSLLxTxRatio.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate <code>Lx/Tx</code> ratios from a given set of CW-OSL curves assuming late light
background subtraction.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_OSLLxTxRatio</span><span class="op">(</span></span>
<span>  <span class="va">Lx.data</span>,</span>
<span>  Tx.data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">signal.integral</span>,</span>
<span>  signal.integral.Tx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">background.integral</span>,</span>
<span>  background.integral.Tx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  background.count.distribution <span class="op">=</span> <span class="st">"non-poisson"</span>,</span>
<span>  use_previousBG <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sigmab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sig0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  digits <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-lx-data">Lx.data<a class="anchor" aria-label="anchor" href="#arg-lx-data"></a></dt>
<dd><p><a href="RLum.Data.Curve-class.html">RLum.Data.Curve</a> or <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<strong>required</strong>):
requires a CW-OSL shine down curve (x = time, y = counts)</p></dd>


<dt id="arg-tx-data">Tx.data<a class="anchor" aria-label="anchor" href="#arg-tx-data"></a></dt>
<dd><p><a href="RLum.Data.Curve-class.html">RLum.Data.Curve</a> or <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<em>optional</em>):
requires a CW-OSL shine down curve (x = time, y = counts). If no
input is given the <code>Tx.data</code> will be treated as <code>NA</code> and no <code>Lx/Tx</code> ratio
is calculated.</p></dd>


<dt id="arg-signal-integral">signal.integral<a class="anchor" aria-label="anchor" href="#arg-signal-integral"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>): vector with the limits for the signal integral.
Can be set to <code>NA</code> than now integrals are considered and all other integrals are set to <code>NA</code> as well.</p></dd>


<dt id="arg-signal-integral-tx">signal.integral.Tx<a class="anchor" aria-label="anchor" href="#arg-signal-integral-tx"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
vector with the limits for the signal integral for the <code>Tx</code>-curve. If nothing is provided the
value from <code>signal.integral</code> is used.</p></dd>


<dt id="arg-background-integral">background.integral<a class="anchor" aria-label="anchor" href="#arg-background-integral"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>):
vector with the bounds for the background integral.
Can be set to <code>NA</code> than now integrals are considered and all other integrals are set to <code>NA</code> as well.</p></dd>


<dt id="arg-background-integral-tx">background.integral.Tx<a class="anchor" aria-label="anchor" href="#arg-background-integral-tx"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
vector with the limits for the background integral for the <code>Tx</code> curve.
If nothing is provided the value from <code>background.integral</code> is used.</p></dd>


<dt id="arg-background-count-distribution">background.count.distribution<a class="anchor" aria-label="anchor" href="#arg-background-count-distribution"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
sets the count distribution assumed for the error calculation.
Possible arguments <code>poisson</code> or <code>non-poisson</code>. See details for further information</p></dd>


<dt id="arg-use-previousbg">use_previousBG<a class="anchor" aria-label="anchor" href="#arg-use-previousbg"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
If set to <code>TRUE</code> the background of the <code>Lx</code>-signal is subtracted also
from the <code>Tx</code>-signal. Please note that in this case separate
signal integral limits for the <code>Tx</code>-signal are not allowed and will be reset.</p></dd>


<dt id="arg-sigmab">sigmab<a class="anchor" aria-label="anchor" href="#arg-sigmab"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
option to set a manual value for the overdispersion (for <code>LnTx</code> and <code>TnTx</code>),
used for the <code>Lx/Tx</code> error calculation. The value should be provided as
absolute squared count values, e.g. <code>sigmab = c(300,300)</code>.
<strong>Note:</strong> If only one value is provided this value is taken for both (<code>LnTx</code> and <code>TnTx</code>) signals.</p></dd>


<dt id="arg-sig-">sig0<a class="anchor" aria-label="anchor" href="#arg-sig-"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
allow adding an extra component of error to the final <code>Lx/Tx</code> error value
(e.g., instrumental error, see details).</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
round numbers to the specified digits.
If digits is set to <code>NULL</code> nothing is rounded.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an S4 object of type <a href="RLum.Results-class.html">RLum.Results</a>.</p>
<p>Slot <code>data</code> contains a <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> with the following structure:</p>
<p><strong>@data</strong></p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">$</span><span class="fu">LxTx.table</span> (data.frame)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>.. <span class="sc">$</span> LnLx</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>.. <span class="sc">$</span> LnLx.BG</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>.. <span class="sc">$</span> TnTx</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>.. <span class="sc">$</span> TnTx.BG</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>.. <span class="sc">$</span> Net_LnLx</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>.. <span class="sc">$</span> Net_LnLx.Error</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>.. <span class="sc">$</span> Net_TnTx</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>.. <span class="sc">$</span> Net_TnTx.Error</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>.. <span class="sc">$</span> LxTx</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>.. <span class="sc">$</span> LxTx.Error</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="sc">$</span> <span class="fu">calc.parameters</span> (list)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>.. <span class="sc">$</span> sigmab.LnTx</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>.. <span class="sc">$</span> sigmab.TnTx</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>.. <span class="sc">$</span> k</span></code></pre><p></p></div>
<p><strong>@info</strong></p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">$</span> <span class="fu">call</span> (original <span class="cf">function</span> call)</span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The integrity of the chosen values for the signal and background integral is
checked by the function; the signal integral limits have to be lower than
the background integral limits. If a <a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a> is given as input instead
of a <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a>, an artificial <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> is produced. The
error calculation is done according to Galbraith (2002).</p>
<p><strong>Please note:</strong> In cases where the calculation results in <code>NaN</code> values (for
example due to zero-signal, and therefore a division of 0 by 0), these <code>NaN</code>
values are replaced by 0.</p>
<p><strong><code>sigmab</code></strong></p>
<p>The default value of <code>sigmab</code> is calculated assuming the background is
constant and <strong>would not</strong> applicable when the background varies as,
e.g., as observed for the early light subtraction method.</p>
<p><strong>sig0</strong></p>
<p>This argument allows to add an extra component of error to the final <code>Lx/Tx</code>
error value. The input will be treated as factor that is multiplied with
the already calculated <code>LxTx</code> and the result is add up by:</p>
<p>$$se(LxTx) = \sqrt(se(LxTx)^2 + (LxTx * sig0)^2)$$</p>
<p><strong>background.count.distribution</strong></p>
<p>This argument allows selecting the distribution assumption that is used for
the error calculation. According to Galbraith (2002, 2014) the background
counts may be overdispersed (i.e. do not follow a Poisson distribution,
which is assumed for the photomultiplier counts). In that case (might be the
normal case) it has to be accounted for the overdispersion by estimating
\(\sigma^2\) (i.e. the overdispersion value). Therefore the relative
standard error is calculated as:</p><ul><li><p><code>poisson</code>
$$rse(\mu_{S}) \approx \sqrt(Y_{0} + Y_{1}/k^2)/Y_{0} - Y_{1}/k$$</p></li>
<li><p><code>non-poisson</code>
$$rse(\mu_{S}) \approx \sqrt(Y_{0} + Y_{1}/k^2 + \sigma^2(1+1/k))/Y_{0} - Y_{1}/k$$</p></li>
</ul><p><strong>Please note</strong> that when using the early background subtraction method in
combination with the 'non-poisson' distribution argument, the corresponding <code>Lx/Tx</code> error
may considerably increase due to a high <code>sigmab</code> value.
Please check whether this is valid for your data set and  if necessary
consider to provide an own <code>sigmab</code> value using the corresponding argument <code>sigmab</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The results of this function have been cross-checked with the Analyst
(version 3.24b). Access to the results object via <a href="get_RLum.html">get_RLum</a>.</p>
<p><strong>Caution:</strong> If you are using early light subtraction (EBG), please either provide your
own <code>sigmab</code> value or use <code>background.count.distribution = "poisson"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="function-version">Function version<a class="anchor" aria-label="anchor" href="#function-version"></a></h2>
    <p>0.8.0</p>
    </div>
    <div class="section level2">
    <h2 id="how-to-cite">How to cite<a class="anchor" aria-label="anchor" href="#how-to-cite"></a></h2>
    <p>Kreutzer, S., 2024. calc_OSLLxTxRatio(): Calculate Lx/Tx ratio for CW-OSL curves. Function version 0.8.0. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., Colombo, M., 2024. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.25. https://r-lum.github.io/Luminescence/</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Duller, G., 2018. Analyst v4.57 - User Manual.
<code>https://users.aber.ac.uk/ggd</code><br></p>
<p>Galbraith, R.F., 2002. A note on the variance of a background-corrected OSL
count. Ancient TL, 20 (2), 49-51.</p>
<p>Galbraith, R.F., 2014. A further note on the variance of a
background-corrected OSL count. Ancient TL, 31 (2), 1-3.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="RLum.Data.Curve-class.html">RLum.Data.Curve</a>, <a href="Analyse_SAR.OSLdata.html">Analyse_SAR.OSLdata</a>, <a href="plot_GrowthCurve.html">plot_GrowthCurve</a>,
<a href="analyse_SAR.CWOSL.html">analyse_SAR.CWOSL</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)
, RLum Developer Team</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.LxTxOSLData</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##calculate Lx/Tx ratio</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">calc_OSLLxTxRatio</span><span class="op">(</span></span></span>
<span class="r-in"><span> Lx.data <span class="op">=</span> <span class="va">Lx.data</span>,</span></span>
<span class="r-in"><span> Tx.data <span class="op">=</span> <span class="va">Tx.data</span>,</span></span>
<span class="r-in"><span> signal.integral <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> background.integral <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">85</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##get results object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    LnLx LnLx.BG TnTx TnTx.BG Net_LnLx Net_LnLx.Error Net_TnTx Net_TnTx.Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 81709     530 7403     513    81179       286.5461     6890       88.53581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LxTx LxTx.Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 11.78215  0.1570077</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

