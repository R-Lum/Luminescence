<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate Lx/Tx ratio for CW-OSL curves — calc_OSLLxTxRatio • Luminescence</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Lx/Tx ratio for CW-OSL curves — calc_OSLLxTxRatio"><meta property="og:description" content="Calculate Lx/Tx ratios from a given set of CW-OSL curves assuming late light
background subtraction."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.23</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence" class="external-link">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate <code>Lx/Tx</code> ratio for CW-OSL curves</h1>
    <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/HEAD/R/calc_OSLLxTxRatio.R" class="external-link"><code>R/calc_OSLLxTxRatio.R</code></a></small>
    <div class="hidden name"><code>calc_OSLLxTxRatio.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate <code>Lx/Tx</code> ratios from a given set of CW-OSL curves assuming late light
background subtraction.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_OSLLxTxRatio</span><span class="op">(</span></span>
<span>  <span class="va">Lx.data</span>,</span>
<span>  Tx.data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">signal.integral</span>,</span>
<span>  signal.integral.Tx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">background.integral</span>,</span>
<span>  background.integral.Tx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  background.count.distribution <span class="op">=</span> <span class="st">"non-poisson"</span>,</span>
<span>  use_previousBG <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sigmab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sig0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  digits <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>Lx.data</dt>
<dd><p><a href="RLum.Data.Curve-class.html">RLum.Data.Curve</a> or <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<strong>required</strong>):
requires a CW-OSL shine down curve (x = time, y = counts)</p></dd>


<dt>Tx.data</dt>
<dd><p><a href="RLum.Data.Curve-class.html">RLum.Data.Curve</a> or <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<em>optional</em>):
requires a CW-OSL shine down curve (x = time, y = counts). If no
input is given the <code>Tx.data</code> will be treated as <code>NA</code> and no <code>Lx/Tx</code> ratio
is calculated.</p></dd>


<dt>signal.integral</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>): vector with the limits for the signal integral.
Can be set to <code>NA</code> than now integrals are considered and all other integrals are set to <code>NA</code> as well.</p></dd>


<dt>signal.integral.Tx</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
vector with the limits for the signal integral for the <code>Tx</code>-curve. If nothing is provided the
value from <code>signal.integral</code> is used.</p></dd>


<dt>background.integral</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>):
vector with the bounds for the background integral.
Can be set to <code>NA</code> than now integrals are considered and all other integrals are set to <code>NA</code> as well.</p></dd>


<dt>background.integral.Tx</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
vector with the limits for the background integral for the <code>Tx</code> curve.
If nothing is provided the value from <code>background.integral</code> is used.</p></dd>


<dt>background.count.distribution</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
sets the count distribution assumed for the error calculation.
Possible arguments <code>poisson</code> or <code>non-poisson</code>. See details for further information</p></dd>


<dt>use_previousBG</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
If set to <code>TRUE</code> the background of the <code>Lx</code>-signal is subtracted also
from the <code>Tx</code>-signal. Please note that in this case separate
signal integral limits for the <code>Tx</code>-signal are not allowed and will be reset.</p></dd>


<dt>sigmab</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
option to set a manual value for the overdispersion (for <code>LnTx</code> and <code>TnTx</code>),
used for the <code>Lx/Tx</code> error calculation. The value should be provided as
absolute squared count values, e.g. <code>sigmab = c(300,300)</code>.
<strong>Note:</strong> If only one value is provided this value is taken for both (<code>LnTx</code> and <code>TnTx</code>) signals.</p></dd>


<dt>sig0</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
allow adding an extra component of error to the final <code>Lx/Tx</code> error value
(e.g., instrumental error, see details).</p></dd>


<dt>digits</dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
round numbers to the specified digits.
If digits is set to <code>NULL</code> nothing is rounded.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns an S4 object of type <a href="RLum.Results-class.html">RLum.Results</a>.</p>


<p>Slot <code>data</code> contains a <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> with the following structure:</p>


<p><strong>@data</strong></p>



<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">$</span><span class="fu">LxTx.table</span> (data.frame)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>.. <span class="sc">$</span> LnLx</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>.. <span class="sc">$</span> LnLx.BG</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>.. <span class="sc">$</span> TnTx</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>.. <span class="sc">$</span> TnTx.BG</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>.. <span class="sc">$</span> Net_LnLx</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>.. <span class="sc">$</span> Net_LnLx.Error</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>.. <span class="sc">$</span> Net_TnTx</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>.. <span class="sc">$</span> Net_TnTx.Error</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>.. <span class="sc">$</span> LxTx</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>.. <span class="sc">$</span> LxTx.Error</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="sc">$</span> <span class="fu">calc.parameters</span> (list)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>.. <span class="sc">$</span> sigmab.LnTx</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>.. <span class="sc">$</span> sigmab.TnTx</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>.. <span class="sc">$</span> k</span></code></pre><p></p></div>



<p><strong>@info</strong></p>



<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">$</span> <span class="fu">call</span> (original <span class="cf">function</span> call)</span></code></pre><p></p></div>


    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The integrity of the chosen values for the signal and background integral is
checked by the function; the signal integral limits have to be lower than
the background integral limits. If a <a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a> is given as input instead
of a <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a>, an artificial <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> is produced. The
error calculation is done according to Galbraith (2002).</p>
<p><strong>Please note:</strong> In cases where the calculation results in <code>NaN</code> values (for
example due to zero-signal, and therefore a division of 0 by 0), these <code>NaN</code>
values are replaced by 0.</p>
<p><strong><code>sigmab</code></strong></p>
<p>The default value of <code>sigmab</code> is calculated assuming the background is
constant and <strong>would not</strong> applicable when the background varies as,
e.g., as observed for the early light subtraction method.</p>
<p><strong>sig0</strong></p>
<p>This argument allows to add an extra component of error to the final <code>Lx/Tx</code>
error value. The input will be treated as factor that is multiplied with
the already calculated <code>LxTx</code> and the result is add up by:</p>
<p>$$se(LxTx) = \sqrt(se(LxTx)^2 + (LxTx * sig0)^2)$$</p>
<p><strong>background.count.distribution</strong></p>
<p>This argument allows selecting the distribution assumption that is used for
the error calculation. According to Galbraith (2002, 2014) the background
counts may be overdispersed (i.e. do not follow a Poisson distribution,
which is assumed for the photomultiplier counts). In that case (might be the
normal case) it has to be accounted for the overdispersion by estimating
\(\sigma^2\) (i.e. the overdispersion value). Therefore the relative
standard error is calculated as:</p><ul><li><p><code>poisson</code>
$$rse(\mu_{S}) \approx \sqrt(Y_{0} + Y_{1}/k^2)/Y_{0} - Y_{1}/k$$</p></li>
<li><p><code>non-poisson</code>
$$rse(\mu_{S}) \approx \sqrt(Y_{0} + Y_{1}/k^2 + \sigma^2(1+1/k))/Y_{0} - Y_{1}/k$$</p></li>
</ul><p><strong>Please note</strong> that when using the early background subtraction method in
combination with the 'non-poisson' distribution argument, the corresponding <code>Lx/Tx</code> error
may considerably increase due to a high <code>sigmab</code> value.
Please check whether this is valid for your data set and  if necessary
consider to provide an own <code>sigmab</code> value using the corresponding argument <code>sigmab</code>.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The results of this function have been cross-checked with the Analyst
(version 3.24b). Access to the results object via <a href="get_RLum.html">get_RLum</a>.</p>
<p><strong>Caution:</strong> If you are using early light subtraction (EBG), please either provide your
own <code>sigmab</code> value or use <code>background.count.distribution = "poisson"</code>.</p>
    </div>
    <div id="function-version">
    <h2>Function version</h2>
    <p>0.8.0</p>
    </div>
    <div id="how-to-cite">
    <h2>How to cite</h2>
    <p>Kreutzer, S., 2023. calc_OSLLxTxRatio(): Calculate Lx/Tx ratio for CW-OSL curves. Function version 0.8.0. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., 2023. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.23. https://CRAN.R-project.org/package=Luminescence</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Duller, G., 2018. Analyst v4.57 - User Manual.
<code>https://users.aber.ac.uk/ggd</code><br></p>
<p>Galbraith, R.F., 2002. A note on the variance of a background-corrected OSL
count. Ancient TL, 20 (2), 49-51.</p>
<p>Galbraith, R.F., 2014. A further note on the variance of a
background-corrected OSL count. Ancient TL, 31 (2), 1-3.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="RLum.Data.Curve-class.html">RLum.Data.Curve</a>, <a href="Analyse_SAR.OSLdata.html">Analyse_SAR.OSLdata</a>, <a href="plot_GrowthCurve.html">plot_GrowthCurve</a>,
<a href="analyse_SAR.CWOSL.html">analyse_SAR.CWOSL</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)
, RLum Developer Team</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.LxTxOSLData</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##calculate Lx/Tx ratio</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">calc_OSLLxTxRatio</span><span class="op">(</span></span></span>
<span class="r-in"><span> Lx.data <span class="op">=</span> <span class="va">Lx.data</span>,</span></span>
<span class="r-in"><span> Tx.data <span class="op">=</span> <span class="va">Tx.data</span>,</span></span>
<span class="r-in"><span> signal.integral <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> background.integral <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">85</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##get results object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    LnLx LnLx.BG TnTx TnTx.BG Net_LnLx Net_LnLx.Error Net_TnTx Net_TnTx.Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 81709     530 7403     513    81179       286.5461     6890       88.53581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LxTx LxTx.Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 11.78215  0.1570077</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

