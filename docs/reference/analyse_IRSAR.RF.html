<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Analyse IRSAR RF measurements — analyse_IRSAR.RF • Luminescence</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyse IRSAR RF measurements — analyse_IRSAR.RF"><meta name="description" content="Function to analyse IRSAR RF measurements on K-feldspar samples, performed
using the protocol according to Erfurt et al. (2003) and beyond."><meta property="og:description" content="Function to analyse IRSAR RF measurements on K-feldspar samples, performed
using the protocol according to Erfurt et al. (2003) and beyond."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.25</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analyse IRSAR RF measurements</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/HEAD/R/analyse_IRSAR.RF.R" class="external-link"><code>R/analyse_IRSAR.RF.R</code></a></small>
      <div class="d-none name"><code>analyse_IRSAR.RF.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to analyse IRSAR RF measurements on K-feldspar samples, performed
using the protocol according to Erfurt et al. (2003) and beyond.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">analyse_IRSAR.RF</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  sequence_structure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NATURAL"</span>, <span class="st">"REGENERATED"</span><span class="op">)</span>,</span>
<span>  RF_nat.lim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  RF_reg.lim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"FIT"</span>,</span>
<span>  method.control <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  test_parameters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.MC <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  txtProgressBar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_reduced <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><a href="RLum.Analysis-class.html">RLum.Analysis</a> or a <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> of <a href="RLum.Analysis-class.html">RLum.Analysis</a>-objects (<strong>required</strong>):
input object containing data for protocol analysis. The function expects to
find at least two curves in the <a href="RLum.Analysis-class.html">RLum.Analysis</a> object: (1) <code>RF_nat</code>, (2) <code>RF_reg</code>.
If a <code>list</code> is provided as input all other parameters can be provided as
<code>list</code> as well to gain full control.</p></dd>


<dt id="arg-sequence-structure">sequence_structure<a class="anchor" aria-label="anchor" href="#arg-sequence-structure"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a> <a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
specifies the general sequence structure. Allowed steps are <code>NATURAL</code>, <code>REGENERATED</code>.
In addition any other character is allowed in the sequence structure;
such curves will be ignored during the analysis.</p></dd>


<dt id="arg-rf-nat-lim">RF_nat.lim<a class="anchor" aria-label="anchor" href="#arg-rf-nat-lim"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a> (<em>with default</em>):
set minimum and maximum channel range for natural signal fitting and sliding.
If only one value is provided this will be treated as minimum value and the
maximum limit will be added automatically.</p></dd>


<dt id="arg-rf-reg-lim">RF_reg.lim<a class="anchor" aria-label="anchor" href="#arg-rf-reg-lim"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a> (<em>with default</em>):
set minimum and maximum channel range for regenerated signal fitting and sliding.
If only one value is provided this will be treated as minimum value and the
maximum limit will be added automatically.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>): select method applied for the data analysis.
Possible options are <code>"FIT"</code>, <code>"SLIDE"</code>, <code>"VSLIDE"</code>.</p></dd>


<dt id="arg-method-control">method.control<a class="anchor" aria-label="anchor" href="#arg-method-control"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> (<em>optional</em>):
parameters to control the method, that can be passed to the chosen method.
These are for (1) <code>method = "FIT"</code>: <code>'trace'</code>, <code>'maxiter'</code>, <code>'warnOnly'</code>, <code>'minFactor'</code> and for
(2) <code>method = "SLIDE"</code>: <code>'correct_onset'</code>, <code>'show_density'</code>,  <code>'show_fit'</code>, <code>'trace'</code>.
See details.</p></dd>


<dt id="arg-test-parameters">test_parameters<a class="anchor" aria-label="anchor" href="#arg-test-parameters"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> (<em>with default</em>):
set test parameters. Supported parameters are: <code>curves_ratio</code>, <code>residuals_slope</code> (only for
<code>method = "SLIDE"</code>), <code>curves_bounds</code>, <code>dynamic_ratio</code>,
<code>lambda</code>, <code>beta</code> and <code>delta.phi</code>. All input: <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a>
values, <code>NA</code> and <code>NULL</code> (s. Details)</p>
<p>(see Details for further information)</p></dd>


<dt id="arg-n-mc">n.MC<a class="anchor" aria-label="anchor" href="#arg-n-mc"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
set number of Monte Carlo runs for start parameter estimation (<code>method = "FIT"</code>) or
error estimation (<code>method = "SLIDE"</code>). This value can be set to <code>NULL</code> to skip the
MC runs. Note: Large values will significantly increase the computation time</p></dd>


<dt id="arg-txtprogressbar">txtProgressBar<a class="anchor" aria-label="anchor" href="#arg-txtprogressbar"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enables <code>TRUE</code> or disables <code>FALSE</code> the progress bar during MC runs</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
plot output (<code>TRUE</code> or <code>FALSE</code>)</p></dd>


<dt id="arg-plot-reduced">plot_reduced<a class="anchor" aria-label="anchor" href="#arg-plot-reduced"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>optional</em>):
provides a reduced plot output if enabled to allow common R plot combinations,
e.g., <code>par(mfrow(...))</code>. If <code>TRUE</code> no residual plot
is returned; it has no effect if <code>plot = FALSE</code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments that will be passed to the plot output.
Currently supported arguments are <code>main</code>, <code>xlab</code>, <code>ylab</code>,
<code>xlim</code>, <code>ylim</code>, <code>log</code>, <code>legend</code> (<code>TRUE/FALSE</code>),
<code>legend.pos</code>, <code>legend.text</code> (passes argument to x,y in
<a href="https://rdrr.io/r/graphics/legend.html" class="external-link">graphics::legend</a>), <code>xaxt</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns numerical output and an (<em>optional</em>) plot.</p>
<p>———————————–<br><code>[ NUMERICAL OUTPUT ]</code><br>
———————————–<br></p>
<p><strong><code>RLum.Results</code></strong>-object</p>
<p><strong>slot:</strong> <strong><code>@data</code></strong></p>
<p><code>[.. $data : data.frame]</code></p>
<table class="table table"><tr><td><strong>Column</strong></td><td><strong>Type</strong></td><td><strong>Description</strong></td></tr><tr><td><code>DE</code></td><td><code>numeric</code></td><td>the obtained equivalent dose</td></tr><tr><td><code>DE.ERROR</code></td><td><code>numeric</code></td><td>(only <code>method = "SLIDE"</code>) standard deviation obtained from MC runs</td></tr><tr><td><code>DE.LOWER</code></td><td><code>numeric</code></td><td>2.5% quantile for De values obtained by MC runs</td></tr><tr><td><code>DE.UPPER</code></td><td><code>numeric</code></td><td>97.5% quantile for De values obtained by MC runs</td></tr><tr><td><code>DE.STATUS</code></td><td><code>character</code></td><td>test parameter status</td></tr><tr><td><code>RF_NAT.LIM</code></td><td><code>character</code></td><td>used <code>RF_nat</code> curve limits</td></tr><tr><td><code>RF_REG.LIM</code></td><td><code>character</code></td><td>used <code>RF_reg</code> curve limits</td></tr><tr><td><code>POSITION</code></td><td><code>integer</code></td><td>(<em>optional</em>) position of the curves</td></tr><tr><td><code>DATE</code></td><td><code>character</code></td><td>(<em>optional</em>) measurement date</td></tr><tr><td><code>SEQUENCE_NAME</code></td><td><code>character</code></td><td>(<em>optional</em>) sequence name</td></tr><tr><td><code>UID</code></td><td><code>character</code></td><td>unique data set ID</td></tr></table><p><code>[.. $De.MC : numeric]</code></p>
<p>A <code>numeric</code> vector with all the De values obtained by the MC runs.</p>
<p><code>[.. $test_parameters : data.frame]</code></p>
<table class="table table"><tr><td><strong>Column</strong></td><td><strong>Type</strong></td><td><strong>Description</strong></td></tr><tr><td><code>POSITION</code></td><td><code>numeric</code></td><td>aliquot position</td></tr><tr><td><code>PARAMETER</code></td><td><code>character</code></td><td>test parameter name</td></tr><tr><td><code>THRESHOLD</code></td><td><code>numeric</code></td><td>set test parameter threshold value</td></tr><tr><td><code>VALUE</code></td><td><code>numeric</code></td><td>the calculated test parameter value (to be compared with the threshold)</td></tr><tr><td><code>STATUS</code></td><td><code>character</code></td><td>test parameter status either <code>"OK"</code> or <code>"FAILED"</code></td></tr><tr><td><code>SEQUENCE_NAME</code></td><td><code>character</code></td><td>name of the sequence, so far available</td></tr><tr><td><code>UID</code></td><td><code>character</code></td><td>unique data set ID</td></tr></table><p><code>[.. $fit : data.frame]</code></p>
<p>An <a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a> object produced by the fitting.</p>
<p><code>[.. $slide : list]</code></p>
<p>A <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> with data produced during the sliding. Some elements are previously
reported with the summary object data. List elements are:</p>
<table class="table table"><tr><td><strong>Element</strong></td><td><strong>Type</strong></td><td><strong>Description</strong></td></tr><tr><td><code>De</code></td><td><code>numeric</code></td><td>the final De obtained with the sliding approach</td></tr><tr><td><code>De.MC</code></td><td><code>numeric</code></td><td>all De values obtained by the MC runs</td></tr><tr><td><code>residuals</code></td><td><code>numeric</code></td><td>the obtained residuals for each channel of the curve</td></tr><tr><td><code>trend.fit</code></td><td><code>lm</code></td><td>fitting results produced by the fitting of the residuals</td></tr><tr><td><code>RF_nat.slid</code></td><td><code>matrix</code></td><td>the slid <code>RF_nat</code> curve</td></tr><tr><td><code>t_n.id</code></td><td><code>numeric</code></td><td>the index of the t_n offset</td></tr><tr><td><code>I_n</code></td><td><code>numeric</code></td><td>the vertical intensity offset if a vertical slide was applied</td></tr><tr><td><code>algorithm_error</code></td><td><code>numeric</code></td><td>the vertical sliding suffers from a systematic effect induced by the used
algorithm. The returned value is the standard deviation of all obtained De values while expanding the
vertical sliding range. I can be added as systematic error to the final De error; so far wanted.</td></tr><tr><td><code>vslide_range</code></td><td><code>numeric</code></td><td>the range used for the vertical sliding</td></tr><tr><td><code>squared_residuals</code></td><td><code>numeric</code></td><td>the squared residuals (horizontal sliding)</td></tr></table><p><strong>slot:</strong> <strong><code>@info</code></strong></p>
<p>The original function call (methods::language-object)</p>
<p>The output (<code>data</code>) should be accessed using the function <a href="get_RLum.html">get_RLum</a></p>
<p>————————<br><code>[ PLOT OUTPUT ]</code><br>
————————<br></p>
<p>The slid IR-RF curves with the finally obtained De</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs an IRSAR analysis described for K-feldspar samples by
Erfurt et al. (2003) assuming a negligible sensitivity change of the RF
signal.</p>
<p><strong>General Sequence Structure</strong> (according to Erfurt et al., 2003)</p><ol><li><p>Measuring IR-RF intensity of the natural dose for a few seconds (\(RF_{nat}\))</p></li>
<li><p>Bleach the samples under solar conditions for at least 30 min without changing the geometry</p></li>
<li><p>Waiting for at least one hour</p></li>
<li><p>Regeneration of the IR-RF signal to at least the natural level (measuring (\(RF_{reg}\))</p></li>
<li><p>Fitting data with a stretched exponential function</p></li>
<li><p>Calculate the the palaeodose \(D_{e}\) using the parameters from the fitting</p></li>
</ol><p>Actually two methods are supported to obtain the \(D_{e}\):
<code>method = "FIT"</code> and <code>method = "SLIDE"</code>:</p>
<p><strong><code>method = "FIT"</code></strong></p>
<p>The principle is described above and follows the original suggestions by
Erfurt et al., 2003. For the fitting the mean count value of the <code>RF_nat</code> curve is used.</p>
<p>Function used for the fitting (according to Erfurt et al. (2003)):</p>
<p>$$\phi(D) = \phi_{0}-\Delta\phi(1-exp(-\lambda*D))^\beta$$</p>
<p>with
\(\phi(D)\) the dose dependent IR-RF flux,
\(\phi_{0}\) the initial IR-RF flux,
\(\Delta\phi\) the dose dependent change of the IR-RF flux,
\(\lambda\) the exponential parameter, \(D\) the dose and
\(\beta\) the dispersive factor.</p>
<p>To obtain the palaeodose
\(D_{e}\) the function is changed to:</p>
<p>$$D_{e} = ln(-(\phi(D) - \phi_{0})/(-\lambda*\phi)^{1/\beta}+1)/-\lambda$$</p>
<p>The fitting is done using the <code>port</code> algorithm of the <a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a> function.</p>
<p><strong><code>method = "SLIDE"</code></strong></p>
<p>For this method, the natural curve is slid along the x-axis until
congruence with the regenerated curve is reached. Instead of fitting this
allows working with the original data without the need for any physical
model. This approach was introduced for RF curves by Buylaert et al., 2012
and Lapp et al., 2012.</p>
<p>Here the sliding is done by searching for the minimum of the squared residuals.
For the mathematical details of the implementation see Frouin et al., 2017</p>
<p><strong><code>method = "VSLIDE"</code></strong></p>
<p>Same as <code>"SLIDE"</code> but searching also vertically for the best match (i.e. in xy-direction.)
See Kreutzer et al. (2017) and Murari et al. (2021). By default the vertical sliding
range will is set to <code>"auto"</code> (see <code>method.control</code>). This setting can be still
changed with <code>method.control</code>.</p>
<p><strong><code>method.control</code></strong></p>
<p>To keep the generic argument list as clear as possible, arguments to control the methods
for De estimation are all preset with meaningful default parameters and can be
handled using the argument <code>method.control</code> only, e.g.,
<code>method.control = list(trace = TRUE)</code>. Supported arguments are:</p>
<table class="table table"><tr><td><strong>ARGUMENT</strong></td><td><strong>METHOD</strong></td><td><strong>DESCRIPTION</strong></td></tr><tr><td><code>trace</code></td><td><code>FIT</code>, <code>SLIDE</code> or <code>VSLIDE</code></td><td>as in <a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a>; shows sum of squared residuals</td></tr><tr><td><code>trace_vslide</code></td><td><code>SLIDE</code> or <code>VSLIDE</code></td><td><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> argument to enable or disable the tracing of the vertical sliding</td></tr><tr><td><code>maxiter</code></td><td><code>FIT</code></td><td>as in <a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></td></tr><tr><td><code>warnOnly</code></td><td><code>FIT</code></td><td>as in <a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></td></tr><tr><td><code>minFactor</code></td><td><code>FIT</code></td><td>as in <a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></td></tr><tr><td><code>correct_onset</code></td><td><code>SLIDE</code> or <code>VSLIDE</code></td><td>The logical argument shifts the curves along the x-axis by the first channel,
as light is expected in the first channel. The default value is <code>TRUE</code>.</td></tr><tr><td><code>show_density</code></td><td><code>SLIDE</code> or <code>VSLIDE</code></td><td><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>)
enables or disables KDE plots for MC run results. If the distribution is too narrow nothing is shown.</td></tr><tr><td><code>show_fit</code></td><td><code>SLIDE</code> or <code>VSLIDE</code></td><td><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>)
enables or disables the plot of the fitted curve routinely obtained during the evaluation.</td></tr><tr><td><code>n.MC</code></td><td><code>SLIDE</code> or <code>VSLIDE</code></td><td><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
This controls the number of MC runs within the sliding (assessing the possible minimum values).
The default <code>n.MC = 1000</code>. Note: This parameter is not the same as controlled by the
function argument <code>n.MC</code>.</td></tr><tr><td><code>vslide_range</code></td><td><code>SLIDE</code> or <code>VSLIDE</code></td><td><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> or <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> or <a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
This argument sets the boundaries for a vertical curve
sliding. The argument expects a vector with an absolute minimum and a maximum (e.g., <code>c(-1000,1000)</code>).
Alternatively the values <code>NULL</code> and <code>'auto'</code> are allowed. The automatic mode detects the
reasonable vertical sliding range (<strong>recommended</strong>). <code>NULL</code> applies no vertical sliding.
The default is <code>NULL</code>.</td></tr><tr><td><code>cores</code></td><td><code>SLIDE</code> or <code>VSLIDE</code></td><td><code>number</code> or <code>character</code> (<em>with default</em>): set number of cores to be allocated
for a parallel processing of the Monte-Carlo runs. The default value is <code>NULL</code> (single thread),
the recommended values is <code>'auto'</code>. An optional number (e.g., <code>cores</code> = 8) assigns a value manually.</td></tr></table><p><strong>Error estimation</strong></p>
<p>For <strong><code>method = "FIT"</code></strong> the asymmetric error range is obtained by using the 2.5 % (lower) and
the 97.5 % (upper) quantiles of the \(RF_{nat}\) curve for calculating the \(D_{e}\) error range.</p>
<p>For <strong><code>method = "SLIDE"</code></strong> the error is obtained by bootstrapping the residuals of the slid
curve to construct new natural curves for a Monte Carlo simulation. The error is returned in two
ways: (a) the standard deviation of the herewith obtained \(D_{e}\) from the MC runs and (b) the confidence
interval using the  2.5 % (lower) and the 97.5 % (upper) quantiles. The results of the MC runs
are returned with the function output.</p>
<p><strong>Test parameters</strong></p>
<p>The argument <code>test_parameters</code> allows to pass some thresholds for several test parameters,
which will be evaluated during the function run. If a threshold is set and it will be exceeded the
test parameter status will be set to <code>"FAILED"</code>. Intentionally this parameter is not termed
<code>'rejection criteria'</code> as not all test parameters are evaluated for both methods and some parameters
are calculated by not evaluated by default. Common for all parameters are the allowed argument options
<code>NA</code> and <code>NULL</code>. If the parameter is set to <code>NA</code> the value is calculated but the
result will not be evaluated, means it has no effect on the status (<code>"OK"</code> or <code>"FAILED"</code>)
of the parameter.
Setting the parameter to <code>NULL</code> disables the parameter entirely and the parameter will be
also removed from the function output. This might be useful in cases where a particular parameter
asks for long computation times. Currently supported parameters are:</p>
<p><code>curves_ratio</code> <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (default: <code>1.001</code>):</p>
<p>The ratio of \(RF_{nat}\) over \(RF_{reg}\) in the range of\(RF_{nat}\) of is calculated
and should not exceed the threshold value.</p>
<p><code>intersection_ratio</code> <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (default: <code>NA</code>):</p>
<p>Calculated as absolute difference from 1 of the ratio of the integral of the normalised RF-curves,
This value indicates intersection of the RF-curves and should be close to 0 if the curves
have a similar shape. For this calculation first the corresponding time-count pair value on the RF_reg
curve is obtained using the maximum count value of the <code>RF_nat</code> curve and only this segment (fitting to
the <code>RF_nat</code> curve) on the RF_reg curve is taken for further calculating this ratio. If nothing is
found at all, <code>Inf</code> is returned.</p>
<p><code>residuals_slope</code> <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (default: <code>NA</code>; only for <code>method = "SLIDE"</code>):</p>
<p>A linear function is fitted on the residuals after sliding.
The corresponding slope can be used to discard values as a high (positive, negative) slope
may indicate that both curves are fundamentally different and the method cannot be applied at all.
Per default the value of this parameter is calculated but not evaluated.</p>
<p><code>curves_bounds</code> <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (default: \(max(RF_{reg_counts})\):</p>
<p>This measure uses the maximum time (x) value of the regenerated curve.
The maximum time (x) value of the natural curve cannot be larger than this value. However, although
this is not recommended the value can be changed or disabled.</p>
<p><code>dynamic_ratio</code> <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (default: <code>NA</code>):</p>
<p>The dynamic ratio of the regenerated curve is calculated as ratio of the minimum and maximum count values.</p>
<p><code>lambda</code>, <code>beta</code> and <code>delta.phi</code>
<a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (default: <code>NA</code>; <code>method = "SLIDE"</code>):</p>
<p>The stretched exponential function suggested by Erfurt et al. (2003) describing the decay of
the RF signal, comprises several parameters that might be useful to evaluate the shape of the curves.
For <code>method = "FIT"</code> this parameter is obtained during the fitting, for <code>method = "SLIDE"</code> a
rather rough estimation is made using the function <a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a> and the equation
given above. Note: As this procedure requests more computation time, setting of one of these three parameters
to <code>NULL</code> also prevents a calculation of the remaining two.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function assumes that there is no sensitivity change during the
measurements (natural vs. regenerated signal), which is in contrast to the
findings by Buylaert et al. (2012).</p>
    </div>
    <div class="section level2">
    <h2 id="function-version">Function version<a class="anchor" aria-label="anchor" href="#function-version"></a></h2>
    <p>0.7.10</p>
    </div>
    <div class="section level2">
    <h2 id="how-to-cite">How to cite<a class="anchor" aria-label="anchor" href="#how-to-cite"></a></h2>
    <p>Kreutzer, S., 2024. analyse_IRSAR.RF(): Analyse IRSAR RF measurements. Function version 0.7.10. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., Colombo, M., 2024. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.25. https://r-lum.github.io/Luminescence/</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Buylaert, J.P., Jain, M., Murray, A.S., Thomsen, K.J., Lapp, T.,
2012. IR-RF dating of sand-sized K-feldspar extracts: A test of accuracy.
Radiation Measurements 44 (5-6), 560-565. doi: 10.1016/j.radmeas.2012.06.021</p>
<p>Erfurt, G., Krbetschek, M.R., 2003. IRSAR - A single-aliquot
regenerative-dose dating protocol applied to the infrared radiofluorescence
(IR-RF) of coarse- grain K-feldspar. Ancient TL 21, 35-42.</p>
<p>Erfurt, G., 2003. Infrared luminescence of Pb+ centres in potassium-rich
feldspars. physica status solidi (a) 200, 429-438.</p>
<p>Erfurt, G., Krbetschek, M.R., 2003. Studies on the physics of the infrared
radioluminescence of potassium feldspar and on the methodology of its
application to sediment dating. Radiation Measurements 37, 505-510.</p>
<p>Erfurt, G., Krbetschek, M.R., Bortolot, V.J., Preusser, F., 2003. A fully
automated multi-spectral radioluminescence reading system for geochronometry
and dosimetry. Nuclear Instruments and Methods in Physics Research Section
B: Beam Interactions with Materials and Atoms 207, 487-499.</p>
<p>Frouin, M., Huot, S., Kreutzer, S., Lahaye, C., Lamothe, M., Philippe, A., Mercier, N., 2017.
An improved radiofluorescence single-aliquot regenerative dose protocol for K-feldspars.
Quaternary Geochronology 38, 13-24. doi:10.1016/j.quageo.2016.11.004</p>
<p>Kreutzer, S., Murari, M.K., Frouin, M., Fuchs, M., Mercier, N., 2017.
Always remain suspicious: a case study on tracking down a technical artefact while measuring IR-RF.
Ancient TL 35, 20–30.</p>
<p>Murari, M.K., Kreutzer, S., Fuchs, M., 2018. Further investigations on IR-RF:
Dose recovery and correction. Radiation Measurements 120, 110–119.
doi: 10.1016/j.radmeas.2018.04.017</p>
<p>Lapp, T., Jain, M., Thomsen, K.J., Murray, A.S., Buylaert, J.P., 2012. New
luminescence measurement facilities in retrospective dosimetry. Radiation
Measurements 47, 803-808. doi:10.1016/j.radmeas.2012.02.006</p>
<p>Trautmann, T., 2000. A study of radioluminescence kinetics of natural
feldspar dosimeters: experiments and simulations. Journal of Physics D:
Applied Physics 33, 2304-2310.</p>
<p>Trautmann, T., Krbetschek, M.R., Dietrich, A., Stolz, W., 1998.
Investigations of feldspar radioluminescence: potential for a new dating
technique. Radiation Measurements 29, 421-425.</p>
<p>Trautmann, T., Krbetschek, M.R., Dietrich, A., Stolz, W., 1999. Feldspar
radioluminescence: a new dating method and its physical background. Journal
of Luminescence 85, 45-58.</p>
<p>Trautmann, T., Krbetschek, M.R., Stolz, W., 2000. A systematic study of the
radioluminescence properties of single feldspar grains. Radiation
Measurements 32, 685-690.</p>
<p>** Further reading**</p>
<p>Murari, M.K., Kreutzer, S., King, G.E., Frouin, M., Tsukamoto, S., Schmidt, C., Lauer, T.,
Klasen, N., Richter, D., Friedrich, J., Mercier, N., Fuchs, M., 2021.
Infrared radiofluorescence (IR-RF) dating: A review. Quaternary Geochronology 64,
101155. doi: 10.1016/j.quageo.2021.101155</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="RLum.Analysis-class.html">RLum.Analysis</a>, <a href="RLum.Results-class.html">RLum.Results</a>, <a href="get_RLum.html">get_RLum</a>,
<a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a>, <a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a>, <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">parallel::mclapply</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)
, RLum Developer Team</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.RLum.Analysis</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(1) perform analysis using the method 'FIT'</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">analyse_IRSAR.RF</span><span class="op">(</span>object <span class="op">=</span> <span class="va">IRSAR.RF.Data</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="analyse_IRSAR.RF-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##show De results and test paramter results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">results</span>, data.object <span class="op">=</span> <span class="st">"data"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       DE DE.ERROR DE.LOWER DE.UPPER DE.STATUS RF_NAT.LIM RF_REG.LIM POSITION</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 623.25       NA   600.63    635.8        OK        1:5      1:524       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DATE SEQUENCE_NAME                               UID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   NA            NA 2024-09-12-01:45.0.18945696670562</span>
<span class="r-in"><span><span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">results</span>, data.object <span class="op">=</span> <span class="st">"test_parameters"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   POSITION          PARAMETER THRESHOLD        VALUE STATUS SEQUENCE_NAME</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       NA       curves_ratio     1.001 6.845685e-01     OK            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       NA intersection_ratio        NA 5.541736e-03     OK            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       NA    residuals_slope        NA           NA     OK            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       NA      curves_bounds   716.000 6.358000e+02     OK            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       NA      dynamic_ratio        NA 1.524261e+00     OK            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       NA             lambda        NA 2.182234e-04     OK            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       NA               beta        NA 5.418719e-01     OK            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       NA          delta.phi        NA 2.103400e+03     OK            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                 UID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2024-09-12-01:45.0.18945696670562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2024-09-12-01:45.0.18945696670562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2024-09-12-01:45.0.18945696670562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2024-09-12-01:45.0.18945696670562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2024-09-12-01:45.0.18945696670562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2024-09-12-01:45.0.18945696670562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 2024-09-12-01:45.0.18945696670562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 2024-09-12-01:45.0.18945696670562</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(2) perform analysis using the method 'SLIDE'</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">analyse_IRSAR.RF</span><span class="op">(</span>object <span class="op">=</span> <span class="va">IRSAR.RF.Data</span>, method <span class="op">=</span> <span class="st">"SLIDE"</span>, n.MC <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 Run Monte Carlo loops for error estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>[analyse_IRSAR.RF()] Narrow density distribution, no density distribution plotted</span>
<span class="r-plt img"><img src="analyse_IRSAR.RF-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">##(3) perform analysis using the method 'SLIDE' and method control option</span></span></span>
<span class="r-in"><span><span class="co">## 'trace</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">analyse_IRSAR.RF</span><span class="op">(</span></span></span>
<span class="r-in"><span> object <span class="op">=</span> <span class="va">IRSAR.RF.Data</span>,</span></span>
<span class="r-in"><span> method <span class="op">=</span> <span class="st">"SLIDE"</span>,</span></span>
<span class="r-in"><span> method.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

