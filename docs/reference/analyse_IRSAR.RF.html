<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Analyse IRSAR RF measurements — analyse_IRSAR.RF • Luminescence</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Analyse IRSAR RF measurements — analyse_IRSAR.RF" />
<meta property="og:description" content="Function to analyse IRSAR RF measurements on K-feldspar samples, performed
using the protocol according to Erfurt et al. (2003) and beyond." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/index.html">
    <span class="fa fa-play"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/NEWS_Version0.9.0.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Analyse IRSAR RF measurements</h1>
    <small class="dont-index">Source: <a href='https://github.com/R-Lum/Luminescence/blob/master/R/analyse_IRSAR.RF.R'><code>R/analyse_IRSAR.RF.R</code></a></small>
    <div class="hidden name"><code>analyse_IRSAR.RF.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to analyse IRSAR RF measurements on K-feldspar samples, performed
using the protocol according to Erfurt et al. (2003) and beyond.</p>
    </div>

    <pre class="usage"><span class='fu'>analyse_IRSAR.RF</span><span class='op'>(</span>
  <span class='va'>object</span>,
  sequence_structure <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NATURAL"</span>, <span class='st'>"REGENERATED"</span><span class='op'>)</span>,
  RF_nat.lim <span class='op'>=</span> <span class='cn'>NULL</span>,
  RF_reg.lim <span class='op'>=</span> <span class='cn'>NULL</span>,
  method <span class='op'>=</span> <span class='st'>"FIT"</span>,
  method.control <span class='op'>=</span> <span class='cn'>NULL</span>,
  test_parameters <span class='op'>=</span> <span class='cn'>NULL</span>,
  n.MC <span class='op'>=</span> <span class='fl'>10</span>,
  txtProgressBar <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot_reduced <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p><a href='RLum.Analysis-class.html'>RLum.Analysis</a> or a <a href='https://rdrr.io/r/base/list.html'>list</a> of <a href='RLum.Analysis-class.html'>RLum.Analysis</a>-objects (<strong>required</strong>):
input object containing data for protocol analysis. The function expects to
find at least two curves in the <a href='RLum.Analysis-class.html'>RLum.Analysis</a> object: (1) RF_nat, (2) RF_reg.
If a <code>list</code> is provided as input all other parameters can be provided as
<code>list</code> as well to gain full control.</p></td>
    </tr>
    <tr>
      <th>sequence_structure</th>
      <td><p><a href='https://rdrr.io/r/base/vector.html'>vector</a> <a href='https://rdrr.io/r/base/character.html'>character</a> (<em>with default</em>):
specifies the general sequence structure. Allowed steps are <code>NATURAL</code>, <code>REGENERATED</code>.
In addition any other character is allowed in the sequence structure;
such curves will be ignored during the analysis.</p></td>
    </tr>
    <tr>
      <th>RF_nat.lim</th>
      <td><p><a href='https://rdrr.io/r/base/vector.html'>vector</a> (<em>with default</em>):
set minimum and maximum channel range for natural signal fitting and sliding.
If only one value is provided this will be treated as minimum value and the
maximum limit will be added automatically.</p></td>
    </tr>
    <tr>
      <th>RF_reg.lim</th>
      <td><p><a href='https://rdrr.io/r/base/vector.html'>vector</a> (<em>with default</em>):
set minimum and maximum channel range for regenerated signal fitting and sliding.
If only one value is provided this will be treated as minimum value and the
maximum limit will be added automatically.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (<em>with default</em>):
setting method applied for the data analysis.
Possible options are <code>"FIT"</code> or <code>"SLIDE"</code>.</p></td>
    </tr>
    <tr>
      <th>method.control</th>
      <td><p><a href='https://rdrr.io/r/base/list.html'>list</a> (<em>optional</em>):
parameters to control the method, that can be passed to the chosen method.
These are for (1) <code>method = "FIT"</code>: 'trace', 'maxiter', 'warnOnly', 'minFactor' and for
(2) <code>method = "SLIDE"</code>: 'correct_onset', 'show_density',  'show_fit', 'trace'.
See details.</p></td>
    </tr>
    <tr>
      <th>test_parameters</th>
      <td><p><a href='https://rdrr.io/r/base/list.html'>list</a> (<em>with default</em>):
set test parameters. Supported parameters are: <code>curves_ratio</code>, <code>residuals_slope</code> (only for
<code>method = "SLIDE"</code>), <code>curves_bounds</code>, <code>dynamic_ratio</code>,
<code>lambda</code>, <code>beta</code> and <code>delta.phi</code>. All input: <a href='https://rdrr.io/r/base/numeric.html'>numeric</a>
values, <code>NA</code> and <code>NULL</code> (s. Details)</p>
<p>(see Details for further information)</p></td>
    </tr>
    <tr>
      <th>n.MC</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (<em>with default</em>):
set number of Monte Carlo runs for start parameter estimation (<code>method = "FIT"</code>) or
error estimation (<code>method = "SLIDE"</code>). This value can be set to <code>NULL</code> to skip the
MC runs. Note: Large values will significantly increase the computation time</p></td>
    </tr>
    <tr>
      <th>txtProgressBar</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
enables <code>TRUE</code> or disables <code>FALSE</code> the progression bar during MC runs</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
plot output (<code>TRUE</code> or <code>FALSE</code>)</p></td>
    </tr>
    <tr>
      <th>plot_reduced</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>optional</em>):
provides a reduced plot output if enabled to allow common R plot combinations,
e.g., <code><a href='https://rdrr.io/r/graphics/par.html'>par(mfrow(...))</a></code>. If <code>TRUE</code> no residual plot
is returned; it has no effect if <code>plot = FALSE</code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments that will be passed to the plot output.
Currently supported arguments are <code>main</code>, <code>xlab</code>, <code>ylab</code>,
<code>xlim</code>, <code>ylim</code>, <code>log</code>, <code>legend</code> (<code>TRUE/FALSE</code>),
<code>legend.pos</code>, <code>legend.text</code> (passes argument to x,y in
<a href='https://rdrr.io/r/graphics/legend.html'>graphics::legend</a>), <code>xaxt</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns numerical output and an (<em>optional</em>) plot.</p>
<p>-----------------------------------<br />
<code>[ NUMERICAL OUTPUT ]</code><br />
-----------------------------------<br /></p>
<p><strong><code>RLum.Results</code></strong>-object</p>
<p><strong>slot:</strong> <strong><code>@data</code></strong></p>
<p><code>[.. $data : data.frame]</code></p>
<table class='table'>
<tr><td><strong>Column</strong></td><td><strong>Type</strong></td><td><strong>Description</strong></td></tr>
<tr><td><code>DE</code></td><td><code>numeric</code></td><td>the obtained equivalent dose</td></tr>
<tr><td><code>DE.ERROR</code></td><td><code>numeric</code></td><td>(only <code>method = "SLIDE"</code>) standard deviation obtained from MC runs</td></tr>
<tr><td><code>DE.LOWER</code></td><td><code>numeric</code></td><td>2.5% quantile for De values obtained by MC runs</td></tr>
<tr><td><code>DE.UPPER</code></td><td><code>numeric</code></td><td>97.5% quantile for De values obtained by MC runs</td></tr>
<tr><td><code>DE.STATUS</code></td><td><code>character</code></td><td>test parameter status</td></tr>
<tr><td><code>RF_NAT.LIM</code></td><td><code>charcter</code></td><td>used RF_nat curve limits</td></tr>
<tr><td><code>RF_REG.LIM</code></td><td><code>character</code></td><td>used RF_reg curve limits</td></tr>
<tr><td><code>POSITION</code></td><td><code>integer</code></td><td>(<em>optional</em>) position of the curves</td></tr>
<tr><td><code>DATE</code></td><td><code>character</code></td><td>(<em>optional</em>) measurement date</td></tr>
<tr><td><code>SEQUENCE_NAME</code></td><td><code>character</code></td><td>(<em>optional</em>) sequence name</td></tr>
<tr><td><code>UID</code></td><td><code>character</code></td><td>unique data set ID</td></tr>
</table>


<p><code>[.. $De.MC : numeric]</code></p>
<p>A <code>numeric</code> vector with all the De values obtained by the MC runs.</p>
<p><code>[.. $test_parameters : data.frame]</code></p>
<table class='table'>
<tr><td><strong>Column</strong></td><td><strong>Type</strong></td><td><strong>Description</strong></td></tr>
<tr><td><code>POSITION</code></td><td><code>numeric</code></td><td>aliquot position</td></tr>
<tr><td><code>PARAMETER</code></td><td><code>character</code></td><td>test parameter name</td></tr>
<tr><td><code>THRESHOLD</code></td><td><code>numeric</code></td><td>set test parameter threshold value</td></tr>
<tr><td><code>VALUE</code></td><td><code>numeric</code></td><td>the calculated test parameter value (to be compared with the threshold)</td></tr>
<tr><td><code>STATUS</code></td><td><code>character</code></td><td>test parameter status either <code>"OK"</code> or <code>"FAILED"</code></td></tr>
<tr><td><code>SEQUENCE_NAME</code></td><td><code>character</code></td><td>name of the sequence, so far available</td></tr>
<tr><td><code>UID</code></td><td><code>character</code></td><td>unique data set ID</td></tr>
</table>


<p><code>[.. $fit : data.frame]</code></p>
<p>An <a href='https://rdrr.io/r/stats/nls.html'>nls</a> object produced by the fitting.</p>
<p><code>[.. $slide : list]</code></p>
<p>A <a href='https://rdrr.io/r/base/list.html'>list</a> with data produced during the sliding. Some elements are previously
reported with the summary object data. List elements are:</p>
<table class='table'>
<tr><td><strong>Element</strong></td><td><strong>Type</strong></td><td><strong>Description</strong></td></tr>
<tr><td><code>De</code></td><td><code>numeric</code></td><td>the final De obtained with the sliding approach</td></tr>
<tr><td><code>De.MC</code></td><td><code>numeric</code></td><td>all De values obtained by the MC runs</td></tr>
<tr><td><code>residuals</code></td><td><code>numeric</code></td><td>the obtained residuals for each channel of the curve</td></tr>
<tr><td><code>trend.fit</code></td><td><code>lm</code></td><td>fitting results produced by the fitting of the residuals</td></tr>
<tr><td><code>RF_nat.slided</code></td><td><code>matrix</code></td><td>the slided RF_nat curve</td></tr>
<tr><td><code>t_n.id</code></td><td><code>numeric</code></td><td>the index of the t_n offset</td></tr>
<tr><td><code>I_n</code></td><td><code>numeric</code></td><td>the vertical intensity offset if a vertical slide was applied</td></tr>
<tr><td><code>algorithm_error</code></td><td><code>numeric</code></td><td>the vertical sliding suffers from a systematic effect induced by the used
algorithm. The returned value is the standard deviation of all obtained De values while expanding the
vertical sliding range. I can be added as systematic error to the final De error; so far wanted.</td></tr>
<tr><td><code>vslide_range</code></td><td><code>numeric</code></td><td>the range used for the vertical sliding</td></tr>
<tr><td><code>squared_residuals</code></td><td><code>numeric</code></td><td>the squared residuals (horizontal sliding)</td></tr>
</table>


<p><strong>slot:</strong> <strong><code>@info</code></strong></p>
<p>The original function call (methods::language-class-object)</p>
<p>The output (<code>data</code>) should be accessed using the function <a href='get_RLum.html'>get_RLum</a></p>
<p>------------------------<br />
<code>[ PLOT OUTPUT ]</code><br />
------------------------<br /></p>
<p>The slided IR-RF curves with the finally obtained De</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function performs an IRSAR analysis described for K-feldspar samples by
Erfurt et al. (2003) assuming a negligible sensitivity change of the RF
signal.</p>
<p><strong>General Sequence Structure</strong> (according to Erfurt et al., 2003)</p><ol>
<li><p>Measuring IR-RF intensity of the natural dose for a few seconds (\(RF_{nat}\))</p></li>
<li><p>Bleach the samples under solar conditions for at least 30 min without changing the geometry</p></li>
<li><p>Waiting for at least one hour</p></li>
<li><p>Regeneration of the IR-RF signal to at least the natural level (measuring (\(RF_{reg}\))</p></li>
<li><p>Fitting data with a stretched exponential function</p></li>
<li><p>Calculate the the palaeodose \(D_{e}\) using the parameters from the fitting</p></li>
</ol>

<p>Actually two methods are supported to obtain the \(D_{e}\):
<code>method = "FIT"</code> and <code>method = "SLIDE"</code>:</p>
<p><strong><code>method = "FIT"</code></strong></p>
<p>The principle is described above and follows the original suggestions by
Erfurt et al., 2003. For the fitting the mean count value of the RF_nat curve is used.</p>
<p>Function used for the fitting (according to Erfurt et al. (2003)):</p>
<p>$$\phi(D) = \phi_{0}-\Delta\phi(1-exp(-\lambda*D))^\beta$$</p>
<p>with
\(\phi(D)\) the dose dependent IR-RF flux,
\(\phi_{0}\) the initial IR-RF flux,
\(\Delta\phi\) the dose dependent change of the IR-RF flux,
\(\lambda\) the exponential parameter, \(D\) the dose and
\(\beta\) the dispersive factor.</p>
<p>To obtain the palaeodose
\(D_{e}\) the function is changed to:</p>
<p>$$D_{e} = ln(-(\phi(D) - \phi_{0})/(-\lambda*\phi)^{1/\beta}+1)/-\lambda$$</p>
<p>The fitting is done using the <code>port</code> algorithm of the <a href='https://rdrr.io/r/stats/nls.html'>nls</a> function.</p>
<p><strong><code>method = "SLIDE"</code></strong></p>
<p>For this method, the natural curve is slid along the x-axis until
congruence with the regenerated curve is reached. Instead of fitting this
allows working with the original data without the need for any physical
model. This approach was introduced for RF curves by Buylaert et al., 2012
and Lapp et al., 2012.</p>
<p>Here the sliding is done by searching for the minimum of the squared residuals.
For the mathematical details of the implementation see Frouin et al., 2017</p>
<p><strong><code>method.control</code></strong></p>
<p>To keep the generic argument list as clear as possible, arguments to control the methods
for De estimation are all preset with meaningful default parameters and can be
handled using the argument <code>method.control</code> only, e.g.,
<code>method.control = list(trace = TRUE)</code>. Supported arguments are:</p>
<table class='table'>
<tr><td><strong>ARGUMENT</strong></td><td><strong>METHOD</strong></td><td><strong>DESCRIPTION</strong></td></tr>
<tr><td><code>trace</code></td><td><code>FIT</code>, <code>SLIDE</code></td><td>as in <a href='https://rdrr.io/r/stats/nls.html'>nls</a>; shows sum of squared residuals</td></tr>
<tr><td><code>trace_vslide</code></td><td><code>SLIDE</code></td><td><a href='https://rdrr.io/r/base/logical.html'>logical</a> argument to enable or disable the tracing of the vertical sliding</td></tr>
<tr><td><code>maxiter</code></td><td><code>FIT</code></td><td>as in <a href='https://rdrr.io/r/stats/nls.html'>nls</a></td></tr>
<tr><td><code>warnOnly</code></td><td><code>FIT</code></td><td>as in <a href='https://rdrr.io/r/stats/nls.html'>nls</a></td></tr>
<tr><td><code>minFactor</code></td><td><code>FIT</code></td><td>as in <a href='https://rdrr.io/r/stats/nls.html'>nls</a></td></tr>
<tr><td><code>correct_onset</code></td><td><code>SLIDE</code></td><td>The logical argument shifts the curves along the x-axis by the first channel,
as light is expected in the first channel. The default value is <code>TRUE</code>.</td></tr>
<tr><td><code>show_density</code></td><td><code>SLIDE</code></td><td><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>)
enables or disables KDE plots for MC run results. If the distribution is too narrow nothing is shown.</td></tr>
<tr><td><code>show_fit</code></td><td><code>SLIDE</code></td><td><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>)
enables or disables the plot of the fitted curve routinely obtained during the evaluation.</td></tr>
<tr><td><code>n.MC</code></td><td><code>SLIDE</code></td><td><a href='https://rdrr.io/r/base/integer.html'>integer</a> (<em>with default</em>):
This controls the number of MC runs within the sliding (assessing the possible minimum values).
The default <code>n.MC = 1000</code>. Note: This parameter is not the same as controlled by the
function argument <code>n.MC</code>.</td></tr>
<tr><td><code>vslide_range</code></td><td><code>SLDE</code></td><td><a href='https://rdrr.io/r/base/logical.html'>logical</a> or <a href='https://rdrr.io/r/base/numeric.html'>numeric</a> or <a href='https://rdrr.io/r/base/character.html'>character</a> (<em>with default</em>):
This argument sets the boundaries for a vertical curve
sliding. The argument expects a vector with an absolute minimum and a maximum (e.g., <code><a href='https://rdrr.io/r/base/c.html'>c(-1000,1000)</a></code>).
Alternatively the values <code>NULL</code> and <code>'auto'</code> are allowed. The automatic mode detects the
reasonable vertical sliding range (<strong>recommended</strong>). <code>NULL</code> applies no vertical sliding.
The default is <code>NULL</code>.</td></tr>
<tr><td><code>cores</code></td><td><code>SLIDE</code></td><td><code>number</code> or <code>character</code> (<em>with default</em>): set number of cores to be allocated
for a parallel processing of the Monte-Carlo runs. The default value is <code>NULL</code> (single thread),
the recommended values is <code>'auto'</code>. An optional number (e.g., <code>cores</code> = 8) assigns a value manually.</td></tr>
</table>


<p><strong>Error estimation</strong></p>
<p>For <strong><code>method = "FIT"</code></strong> the asymmetric error range is obtained by using the 2.5 % (lower) and
the 97.5 % (upper) quantiles of the \(RF_{nat}\) curve for calculating the \(D_{e}\) error range.</p>
<p>For <strong><code>method = "SLIDE"</code></strong> the error is obtained by bootstrapping the residuals of the slided
curve to construct new natural curves for a Monte Carlo simulation. The error is returned in two
ways: (a) the standard deviation of the herewith obtained \(D_{e}\) from the MC runs and (b) the confidence
interval using the  2.5 % (lower) and the 97.5 % (upper) quantiles. The results of the MC runs
are returned with the function output.</p>
<p><strong>Test parameters</strong></p>
<p>The argument <code>test_parameters</code> allows to pass some thresholds for several test parameters,
which will be evaluated during the function run. If a threshold is set and it will be exceeded the
test parameter status will be set to "FAILED". Intentionally this parameter is not termed
'rejection criteria' as not all test parameters are evaluated for both methods and some parameters
are calculated by not evaluated by default. Common for all parameters are the allowed argument options
<code>NA</code> and <code>NULL</code>. If the parameter is set to <code>NA</code> the value is calculated but the
result will not be evaluated, means it has no effect on the status ("OK" or "FAILED") of the parameter.
Setting the parameter to <code>NULL</code> disables the parameter entirely and the parameter will be
also removed from the function output. This might be useful in cases where a particular parameter
asks for long computation times. Currently supported parameters are:</p>
<p><code>curves_ratio</code> <a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (default: <code>1.001</code>):</p>
<p>The ratio of \(RF_{nat}\) over \(RF_{reg}\) in the range of\(RF_{nat}\) of is calculated
and should not exceed the threshold value.</p>
<p><code>intersection_ratio</code> <a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (default: <code>NA</code>):</p>
<p>Calculated as absolute difference from 1 of the ratio of the integral of the normalised RF-curves,
This value indicates intersection of the RF-curves and should be close to 0 if the curves
have a similar shape. For this calculation first the corresponding time-count pair value on the RF_reg
curve is obtained using the maximum count value of the RF_nat curve and only this segment (fitting to
the RF_nat curve) on the RF_reg curve is taken for further calculating this ratio. If nothing is
found at all, <code>Inf</code> is returned.</p>
<p><code>residuals_slope</code> <a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (default: <code>NA</code>; only for <code>method = "SLIDE"</code>):</p>
<p>A linear function is fitted on the residuals after sliding.
The corresponding slope can be used to discard values as a high (positive, negative) slope
may indicate that both curves are fundamentally different and the method cannot be applied at all.
Per default the value of this parameter is calculated but not evaluated.</p>
<p><code>curves_bounds</code> <a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (default: \(max(RF_{reg_counts})\):</p>
<p>This measure uses the maximum time (x) value of the regenerated curve.
The maximum time (x) value of the natural curve cannot be larger than this value. However, although
this is not recommended the value can be changed or disabled.</p>
<p><code>dynamic_ratio</code> <a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (default: <code>NA</code>):</p>
<p>The dynamic ratio of the regenerated curve is calculated as ratio of the minimum and maximum count values.</p>
<p><code>lambda</code>, <code>beta</code> and <code>delta.phi</code>
<a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (default: <code>NA</code>; <code>method = "SLIDE"</code>):</p>
<p>The stretched exponential function suggested by Erfurt et al. (2003) describing the decay of
the RF signal, comprises several parameters that might be useful to evaluate the shape of the curves.
For <code>method = "FIT"</code> this parameter is obtained during the fitting, for <code>method = "SLIDE"</code> a
rather rough estimation is made using the function <a href='https://rdrr.io/pkg/minpack.lm/man/nlsLM.html'>minpack.lm::nlsLM</a> and the equation
given above. Note: As this procedure requests more computation time, setting of one of these three parameters
to <code>NULL</code> also prevents a calculation of the remaining two.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function assumes that there is no sensitivity change during the
measurements (natural vs. regenerated signal), which is in contrast to the
findings by Buylaert et al. (2012).</p>
    <h2 class="hasAnchor" id="function-version"><a class="anchor" href="#function-version"></a>Function version</h2>

    <p>0.7.5</p>
    <h2 class="hasAnchor" id="how-to-cite"><a class="anchor" href="#how-to-cite"></a>How to cite</h2>

    <p>Kreutzer, S., 2020. analyse_IRSAR.RF(): Analyse IRSAR RF measurements. Function version 0.7.5. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., 2020. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.7. https://CRAN.R-project.org/package=Luminescence</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Buylaert, J.P., Jain, M., Murray, A.S., Thomsen, K.J., Lapp, T.,
2012. IR-RF dating of sand-sized K-feldspar extracts: A test of accuracy.
Radiation Measurements 44 (5-6), 560-565. doi: 10.1016/j.radmeas.2012.06.021</p>
<p>Erfurt, G., Krbetschek, M.R., 2003. IRSAR - A single-aliquot
regenerative-dose dating protocol applied to the infrared radiofluorescence
(IR-RF) of coarse- grain K-feldspar. Ancient TL 21, 35-42.</p>
<p>Erfurt, G., 2003. Infrared luminescence of Pb+ centres in potassium-rich
feldspars. physica status solidi (a) 200, 429-438.</p>
<p>Erfurt, G., Krbetschek, M.R., 2003. Studies on the physics of the infrared
radioluminescence of potassium feldspar and on the methodology of its
application to sediment dating. Radiation Measurements 37, 505-510.</p>
<p>Erfurt, G., Krbetschek, M.R., Bortolot, V.J., Preusser, F., 2003. A fully
automated multi-spectral radioluminescence reading system for geochronometry
and dosimetry. Nuclear Instruments and Methods in Physics Research Section
B: Beam Interactions with Materials and Atoms 207, 487-499.</p>
<p>Frouin, M., Huot, S., Kreutzer, S., Lahaye, C., Lamothe, M., Philippe, A., Mercier, N., 2017.
An improved radiofluorescence single-aliquot regenerative dose protocol for K-feldspars.
Quaternary Geochronology 38, 13-24. doi:10.1016/j.quageo.2016.11.004</p>
<p>Lapp, T., Jain, M., Thomsen, K.J., Murray, A.S., Buylaert, J.P., 2012. New
luminescence measurement facilities in retrospective dosimetry. Radiation
Measurements 47, 803-808. doi:10.1016/j.radmeas.2012.02.006</p>
<p>Trautmann, T., 2000. A study of radioluminescence kinetics of natural
feldspar dosimeters: experiments and simulations. Journal of Physics D:
Applied Physics 33, 2304-2310.</p>
<p>Trautmann, T., Krbetschek, M.R., Dietrich, A., Stolz, W., 1998.
Investigations of feldspar radioluminescence: potential for a new dating
technique. Radiation Measurements 29, 421-425.</p>
<p>Trautmann, T., Krbetschek, M.R., Dietrich, A., Stolz, W., 1999. Feldspar
radioluminescence: a new dating method and its physical background. Journal
of Luminescence 85, 45-58.</p>
<p>Trautmann, T., Krbetschek, M.R., Stolz, W., 2000. A systematic study of the
radioluminescence properties of single feldspar grains. Radiation
Measurements 32, 685-690.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='RLum.Analysis-class.html'>RLum.Analysis</a>, <a href='RLum.Results-class.html'>RLum.Results</a>, <a href='get_RLum.html'>get_RLum</a>,
<a href='https://rdrr.io/r/stats/nls.html'>nls</a>, <a href='https://rdrr.io/pkg/minpack.lm/man/nlsLM.html'>minpack.lm::nlsLM</a>, <code><a href='https://rdrr.io/r/parallel/mclapply.html'>parallel::mclapply</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastian Kreutzer, IRAMAT-CRP2A, Université Bordeaux Montaigne (France)
, RLum Developer Team</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>##load data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>ExampleData.RLum.Analysis</span>, envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>environment</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>##(1) perform analysis using the method 'FIT'</span>
<span class='va'>results</span> <span class='op'>&lt;-</span> <span class='fu'>analyse_IRSAR.RF</span><span class='op'>(</span>object <span class='op'>=</span> <span class='va'>IRSAR.RF.Data</span><span class='op'>)</span>
</div><div class='img'><img src='analyse_IRSAR.RF-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>##show De results and test paramter results</span>
<span class='fu'><a href='get_RLum.html'>get_RLum</a></span><span class='op'>(</span><span class='va'>results</span>, data.object <span class='op'>=</span> <span class='st'>"data"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       DE DE.ERROR DE.LOWER DE.UPPER DE.STATUS RF_NAT.LIM RF_REG.LIM POSITION
#&gt; 1 623.25       NA   600.63    635.8        OK        1:5      1:524       NA
#&gt;   DATE SEQUENCE_NAME                               UID
#&gt; 1   NA            NA 2020-11-03-12:25.0.18945696670562</div><div class='input'><span class='fu'><a href='get_RLum.html'>get_RLum</a></span><span class='op'>(</span><span class='va'>results</span>, data.object <span class='op'>=</span> <span class='st'>"test_parameters"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   POSITION          PARAMETER THRESHOLD        VALUE STATUS SEQUENCE_NAME
#&gt; 1       NA       curves_ratio     1.001 6.845685e-01     OK            NA
#&gt; 2       NA intersection_ratio        NA 5.541736e-03     OK            NA
#&gt; 3       NA    residuals_slope        NA           NA     OK            NA
#&gt; 4       NA      curves_bounds   716.000 6.358000e+02     OK            NA
#&gt; 5       NA      dynamic_ratio        NA 1.524261e+00     OK            NA
#&gt; 6       NA             lambda        NA 2.182234e-04     OK            NA
#&gt; 7       NA               beta        NA 5.418719e-01     OK            NA
#&gt; 8       NA          delta.phi        NA 2.103400e+03     OK            NA
#&gt;                                 UID
#&gt; 1 2020-11-03-12:25.0.18945696670562
#&gt; 2 2020-11-03-12:25.0.18945696670562
#&gt; 3 2020-11-03-12:25.0.18945696670562
#&gt; 4 2020-11-03-12:25.0.18945696670562
#&gt; 5 2020-11-03-12:25.0.18945696670562
#&gt; 6 2020-11-03-12:25.0.18945696670562
#&gt; 7 2020-11-03-12:25.0.18945696670562
#&gt; 8 2020-11-03-12:25.0.18945696670562</div><div class='input'>
<span class='co'>##(2) perform analysis using the method 'SLIDE'</span>
<span class='va'>results</span> <span class='op'>&lt;-</span> <span class='fu'>analyse_IRSAR.RF</span><span class='op'>(</span>object <span class='op'>=</span> <span class='va'>IRSAR.RF.Data</span>, method <span class='op'>=</span> <span class='st'>"SLIDE"</span>, n.MC <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 	 Run Monte Carlo loops for error estimation
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</div><div class='output co'>#&gt; <span class='warning'>Warning: [analyse_IRSAR.RF()] Narrow density distribution, no density distribution plotted!</span></div><div class='img'><img src='analyse_IRSAR.RF-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>##(3) perform analysis using the method 'SLIDE' and method control option</span>
<span class='co'>## 'trace</span>
<span class='va'>results</span> <span class='op'>&lt;-</span> <span class='fu'>analyse_IRSAR.RF</span><span class='op'>(</span>
 object <span class='op'>=</span> <span class='va'>IRSAR.RF.Data</span>,
 method <span class='op'>=</span> <span class='st'>"SLIDE"</span>,
 method.control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>trace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>

<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


