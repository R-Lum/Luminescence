<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate the Average Dose and the dose rate dispersion — calc_AverageDose • Luminescence</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate the Average Dose and the dose rate dispersion — calc_AverageDose"><meta property="og:description" content="This functions calculates the Average Dose and their extrinsic dispersion and estimates
the standard errors by bootstrapping based on the Average Dose Model by Guerin et al., 2017"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/R-Lum/Luminescence/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate the Average Dose and the dose rate dispersion</h1>
    <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/HEAD/R/calc_AverageDose.R" class="external-link"><code>R/calc_AverageDose.R</code></a></small>
    <div class="hidden name"><code>calc_AverageDose.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This functions calculates the Average Dose and their extrinsic dispersion and estimates
the standard errors by bootstrapping based on the Average Dose Model by Guerin et al., 2017</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">calc_AverageDose</span><span class="op">(</span>
  <span class="va">data</span>,
  sigma_m <span class="op">=</span> <span class="cn">NULL</span>,
  Nb_BE <span class="op">=</span> <span class="fl">500</span>,
  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,
  plot <span class="op">=</span> <span class="cn">TRUE</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p><a href="RLum.Results-class.html">RLum.Results</a> or <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<strong>required</strong>):
for <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a>: two columns with <code>De</code> <code>(data[,1])</code> and <code>De error</code> <code>(values[,2])</code></p></dd>
<dt>sigma_m</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>):
the overdispersion resulting from a dose recovery
experiment, i.e. when all grains have  received the same dose. Indeed in such a case, any
overdispersion (i.e. dispersion on top of analytical uncertainties) is, by definition, an
unrecognised measurement uncertainty.</p></dd>
<dt>Nb_BE</dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
sample size used for the bootstrapping</p></dd>
<dt>na.rm</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
exclude NA values from the data set prior to any further operation.</p></dd>
<dt>plot</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enables/disables plot output</p></dd>
<dt>verbose</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enables/disables terminal output</p></dd>
<dt>...</dt>
<dd><p>further arguments that can be passed to <a href="https://rdrr.io/r/graphics/hist.html" class="external-link">graphics::hist</a>. As three plots
are returned all arguments need to be provided as <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a>,
e.g., <code>main = list("Plot 1", "Plot 2", "Plot 3")</code>.
Note: not all arguments of <code>hist</code> are
supported, but the output of <code>hist</code> is returned and can be used of own plots. <br></p>
<p>Further supported arguments: <code>mtext</code> (<a href="https://rdrr.io/r/base/character.html" class="external-link">character</a>), <code>rug</code> (<code>TRUE/FALSE</code>).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The function returns numerical output and an (<em>optional</em>) plot.
-----------------------------------<br><code>[ NUMERICAL OUTPUT ]</code><br>-----------------------------------<br><strong><code>RLum.Results</code></strong>-object<br><strong>slot:</strong><strong><code>@data</code></strong><br><code>[.. $summary : data.frame]</code><br></p><table class="table table"><tr><td><strong>Column</strong></td><td><strong>Type</strong></td><td><strong>Description</strong></td></tr><tr><td>AVERAGE_DOSE</td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>the obtained average dose</td></tr><tr><td>AVERAGE_DOSE.SE</td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>the average dose error</td></tr><tr><td>SIGMA_D</td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>sigma</td></tr><tr><td>SIGMA_D.SE</td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>standard error of the sigma</td></tr><tr><td>IC_AVERAGE_DOSE.LEVEL</td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>confidence level average dose</td></tr><tr><td>IC_AVERAGE_DOSE.LOWER</td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>lower quantile of average dose</td></tr><tr><td>IC_AVERAGE_DOSE.UPPER</td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>upper quantile of average dose</td></tr><tr><td>IC_SIGMA_D.LEVEL</td><td><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></td><td>confidence level sigma</td></tr><tr><td>IC_SIGMA_D.LOWER</td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>lower sigma quantile</td></tr><tr><td>IC_SIGMA_D.UPPER</td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>upper sigma quantile</td></tr><tr><td>L_MAX</td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>maximum likelihood value</td></tr></table><p><code>[.. $dstar : matrix]</code><br>Matrix with bootstrap values<br><code>[.. $hist : list]</code><br>Object as produced by the function histogram
------------------------<br><code>[ PLOT OUTPUT ]</code><br>------------------------<br>The function returns two different plot panels.
(1) An abanico plot with the dose values
(2) A histogram panel comprising 3 histograms with the equivalent dose and the bootstrapped average
dose and the sigma values.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><strong><code>sigma_m</code></strong><br></p>
<p>The program requires the input of a known value of <code>sigma_m</code>,
which corresponds to the intrinsic overdispersion, as determined
by a dose recovery experiment. Then the dispersion in doses (<code>sigma_d</code>)
will be that over and above <code>sigma_m</code> (and individual uncertainties <code>sigma_wi</code>).</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>This function has beta status!</p>
    </div>
    <div id="function-version">
    <h2>Function version</h2>
    <p>0.1.5</p>
    </div>
    <div id="how-to-cite">
    <h2>How to cite</h2>
    <p>Christophe, C., Philippe, A., Kreutzer, S., 2022. calc_AverageDose(): Calculate the Average Dose and the dose rate dispersion. Function version 0.1.5. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., 2022. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.18. https://CRAN.R-project.org/package=Luminescence</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Guerin, G., Christophe, C., Philippe, A., Murray, A.S., Thomsen, K.J., Tribolo, C., Urbanova, P.,
Jain, M., Guibert, P., Mercier, N., Kreutzer, S., Lahaye, C., 2017. Absorbed dose, equivalent dose,
measured dose rates, and implications for OSL age estimates: Introducing the Average Dose Model.
Quaternary Geochronology 1-32. doi:10.1016/j.quageo.2017.04.002</p>
<p><strong>Further reading</strong><br></p>
<p>Efron, B., Tibshirani, R., 1986. Bootstrap Methods for Standard Errors, Confidence Intervals,
and Other Measures of Statistical Accuracy. Statistical Science 1, 54-75.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a>, <a href="https://rdrr.io/r/graphics/hist.html" class="external-link">graphics::hist</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Claire Christophe, IRAMAT-CRP2A, Université de Nantes (France),
Anne Philippe, Université de Nantes, (France),
Guillaume Guérin, IRAMAT-CRP2A, Université Bordeaux Montaigne, (France),
Sebastian Kreutzer, Geography &amp; Earth Sciences, Aberystwyth University (United Kingdom)
, RLum Developer Team</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">##Example 01 using package example data</span></span>
<span class="r-in"><span class="co">##load example data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.DeValues</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">##calculate Average dose</span></span>
<span class="r-in"><span class="co">##(use only the first 56 values here)</span></span>
<span class="r-in"><span class="va">AD</span> <span class="op">&lt;-</span> <span class="fu">calc_AverageDose</span><span class="op">(</span><span class="va">ExampleData.DeValues</span><span class="op">$</span><span class="va">CA1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">56</span>,<span class="op">]</span>, sigma_m <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [calc_AverageDose()]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;&gt; Initialisation &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n:		 56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:		 65.7939285714286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma_m:	 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma_d:	 0.286159381384861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;&gt; Calculation &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log likelihood:	 -19.251</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> confidence intervals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          IC_delta      IC_sigma_d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> level                        0.95          0.9500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CredibleIntervalInf         60.46          0.2175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CredibleIntervalSup         70.34          0.3951</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;&gt; Results &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average dose:	  65.3597 	se(Aver. dose):	 2.5528</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma_d:	  0.3092 	se(sigma_d):	 0.0476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------------</span>
<span class="r-plt img"><img src="calc_AverageDose-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">##plot De and set Average dose as central value</span></span>
<span class="r-in"><span class="fu"><a href="plot_AbanicoPlot.html">plot_AbanicoPlot</a></span><span class="op">(</span></span>
<span class="r-in"> data <span class="op">=</span> <span class="va">ExampleData.DeValues</span><span class="op">$</span><span class="va">CA1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">56</span>,<span class="op">]</span>,</span>
<span class="r-in"> z.0 <span class="op">=</span> <span class="va">AD</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">AVERAGE_DOSE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="calc_AverageDose-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

