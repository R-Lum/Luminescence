<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit and plot a dose-response curve for luminescence data (Lx/Tx against dose) — plot_GrowthCurve • Luminescence</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit and plot a dose-response curve for luminescence data (Lx/Tx against dose) — plot_GrowthCurve"><meta property="og:description" content="A dose-response curve is produced for luminescence measurements using a
regenerative or additive protocol. The function supports interpolation and
extrapolation to calculate the equivalent dose."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.23</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence" class="external-link">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit and plot a dose-response curve for luminescence data (Lx/Tx against dose)</h1>
    <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/HEAD/R/plot_GrowthCurve.R" class="external-link"><code>R/plot_GrowthCurve.R</code></a></small>
    <div class="hidden name"><code>plot_GrowthCurve.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A dose-response curve is produced for luminescence measurements using a
regenerative or additive protocol. The function supports interpolation and
extrapolation to calculate the equivalent dose.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_GrowthCurve</span><span class="op">(</span></span>
<span>  <span class="va">sample</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"interpolation"</span>,</span>
<span>  fit.method <span class="op">=</span> <span class="st">"EXP"</span>,</span>
<span>  fit.force_through_origin <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fit.weights <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fit.includingRepeatedRegPoints <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fit.NumberRegPoints <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fit.NumberRegPointsReal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fit.bounds <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  NumberIterations.MC <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  output.plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  output.plotExtended <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  output.plotExtended.single <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex.global <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  txtProgressBar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sample</dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<strong>required</strong>):
data frame with three columns for <code>x = Dose</code>,<code>y = LxTx</code>,<code>z = LxTx.Error</code>, <code>y1 = TnTx</code>.
The column for the test dose response is optional, but requires <code>'TnTx'</code> as
column name if used. For exponential fits at least three dose points
(including the natural) should be provided.</p></dd>


<dt>na.rm</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>): excludes <code>NA</code> values from the data set prior to any further operations. This argument is defunct and will be removed in a future version!</p></dd>


<dt>mode</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
selects calculation mode of the function.</p><ul><li><p><code>"interpolation"</code> (default) calculates the De by interpolation,</p></li>
<li><p><code>"extrapolation"</code> calculates the equivalent dose by extrapolation (useful for MAAD measurements) and</p></li>
<li><p><code>"alternate"</code> calculates no equivalent dose and just fits the data points.</p></li>
</ul><p>Please note that for option <code>"regenerative"</code> the first point is considered
as natural dose</p></dd>


<dt>fit.method</dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
function used for fitting. Possible options are:</p><ul><li><p><code>LIN</code>,</p></li>
<li><p><code>QDR</code>,</p></li>
<li><p><code>EXP</code>,</p></li>
<li><p><code>EXP OR LIN</code>,</p></li>
<li><p><code>EXP+LIN</code>,</p></li>
<li><p><code>EXP+EXP</code>,</p></li>
<li><p><code>GOK</code>,</p></li>
<li><p><code>LambertW</code></p></li>
</ul><p>See details.</p></dd>


<dt>fit.force_through_origin</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>)
allow to force the fitted function through the origin.
For <code>method = "EXP+EXP"</code> the function will be fixed through
the origin in either case, so this option will have no effect.</p></dd>


<dt>fit.weights</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
option whether the fitting is done with or without weights. See details.</p></dd>


<dt>fit.includingRepeatedRegPoints</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
includes repeated points for fitting (<code>TRUE</code>/<code>FALSE</code>).</p></dd>


<dt>fit.NumberRegPoints</dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>optional</em>):
set number of regeneration points manually. By default the number of all (!)
regeneration points is used automatically.</p></dd>


<dt>fit.NumberRegPointsReal</dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>optional</em>):
if the number of regeneration points is provided manually, the value of the
real, regeneration points = all points (repeated points) including reg 0,
has to be inserted.</p></dd>


<dt>fit.bounds</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
set lower fit bounds for all fitting parameters to 0. Limited for the use
with the fit methods <code>EXP</code>, <code>EXP+LIN</code>, <code>EXP OR LIN</code>, <code>GOK</code>, <code>LambertW</code>
Argument to be inserted for experimental application only!</p></dd>


<dt>NumberIterations.MC</dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
number of Monte Carlo simulations for error estimation. See details.</p></dd>


<dt>output.plot</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
plot output (<code>TRUE/FALSE</code>).</p></dd>


<dt>output.plotExtended</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
If' <code>TRUE</code>, 3 plots on one plot area are provided:</p><ol><li><p>growth curve,</p></li>
<li><p>histogram from Monte Carlo error simulation and</p></li>
<li><p>a test dose response plot.</p></li>
</ol><p>If <code>FALSE</code>, just the growth curve will be plotted.
<strong>Requires:</strong> <code>output.plot = TRUE</code>.</p></dd>


<dt>output.plotExtended.single</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
single plot output (<code>TRUE/FALSE</code>) to allow for plotting the results in
single plot windows. Requires <code>output.plot = TRUE</code> and
<code>output.plotExtended = TRUE</code>.</p></dd>


<dt>cex.global</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
global scaling factor.</p></dd>


<dt>txtProgressBar</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enables or disables <code>txtProgressBar</code>. If <code>verbose = FALSE</code> also no
<code>txtProgressBar</code> is shown.</p></dd>


<dt>verbose</dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enables or disables terminal feedback.</p></dd>


<dt>...</dt>
<dd><p>Further arguments and graphical parameters to be passed. Note:
Standard arguments will only be passed to the growth curve plot. Supported:
<code>xlim</code>, <code>ylim</code>, <code>main</code>, <code>xlab</code>, <code>ylab</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Along with a plot (so far wanted) an <code>RLum.Results</code> object is returned containing,
the slot <code>data</code> contains the following elements:</p>


<table class="table table"><tr><td><strong>DATA.OBJECT</strong></td><td><strong>TYPE</strong></td><td><strong>DESCRIPTION</strong></td></tr><tr><td><code>..$De</code> :</td><td><code>data.frame</code></td><td>Table with De values</td></tr><tr><td><code>..$De.MC</code> :</td><td><code>numeric</code></td><td>Table with De values from MC runs</td></tr><tr><td><code>..$Fit</code> :</td><td><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a> or <a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></td><td>object from the fitting for <code>EXP</code>, <code>EXP+LIN</code> and <code>EXP+EXP</code>.
In case of a resulting  linear fit when using <code>LIN</code>, <code>QDR</code> or <code>EXP OR LIN</code></td></tr><tr><td><code>..$Formula</code> :</td><td><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></td><td>Fitting formula as R expression</td></tr><tr><td><code>..$call</code> :</td><td><code>call</code></td><td>The original function call</td></tr></table></div>
    <div id="details">
    <h2>Details</h2>
    <p><strong>Fitting methods</strong></p>
<p>For all options (except for the <code>LIN</code>, <code>QDR</code> and the <code>EXP OR LIN</code>),
the <a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a> function with the <code>LM</code> (Levenberg-Marquardt algorithm)
algorithm is used. Note: For historical reasons for the Monte Carlo
simulations partly the function <a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a> using the <code>port</code> algorithm.</p>
<p>The solution is found by transforming the function or using <a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a>.</p>
<p><code>LIN</code>: fits a linear function to the data using
<a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a>: $$y = mx + n$$</p>
<p><code>QDR</code>: fits a linear function to the data using
<a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a>: $$y = a + bx + cx^2$$</p>
<p><code>EXP</code>: tries to fit a function of the form
$$y = a(1 - exp(-\frac{(x+c)}{b}))$$
Parameters b and c are approximated by a linear fit using <a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a>. Note: b = D0</p>
<p><code>EXP OR LIN</code>: works for some cases where an <code>EXP</code> fit fails.
If the <code>EXP</code> fit fails, a <code>LIN</code> fit is done instead.</p>
<p><code>EXP+LIN</code>: tries to fit an exponential plus linear function of the
form:
$$y = a(1-exp(-\frac{x+c}{b}) + (gx))$$
The \(D_e\) is calculated by iteration.</p>
<p><strong>Note:</strong> In the context of luminescence dating, this
function has no physical meaning. Therefore, no D0 value is returned.</p>
<p><code>EXP+EXP</code>: tries to fit a double exponential function of the form
$$y = (a_1 (1-exp(-\frac{x}{b_1}))) + (a_2 (1 - exp(-\frac{x}{b_2})))$$
This fitting procedure is not robust against wrong start parameters and
should be further improved.</p>
<p><code>GOK</code>: tries to fit the general-order kinetics function after
Guralnik et al. (2015) of the form of</p>
<p>$$y = a (d - (1 + (\frac{1}{b}) x c)^{(-1/c)})$$</p>
<p>where <strong>c &gt; 0</strong> is a kinetic order modifier
(not to be confused with <strong>c</strong> in <code>EXP</code> or <code>EXP+LIN</code>!).</p>
<p><code>LambertW</code>: tries to fit a dose-response curve based on the Lambert W function
according to Pagonis et al. (2020). The function has the form</p>
<p>$$y ~ (1 + (W((R - 1) * exp(R - 1 - ((x + D_{int}) / D_{c}))) / (1 - R))) * N$$</p>
<p>with \(W\) the Lambert W function, calculated using the package <a href="https://rdrr.io/pkg/lamW/man/lamW-package.html" class="external-link">lamW::lambertW0</a>,
\(R\) the dimensionless retrapping ratio, \(N\) the total concentration
of trappings states in cm^-3 and \(D_{c} = N/R\) a constant. \(D_{int}\) is
the offset on the x-axis. Please not that finding the root in <code>mode = "extrapolation"</code>
is a non-easy task due to the shape of the function and the results might be
unexpected.</p>
<p><strong>Fit weighting</strong></p>
<p>If the option <code>fit.weights =  TRUE</code> is chosen, weights are calculated using
provided signal errors (Lx/Tx error):
$$fit.weights = \frac{\frac{1}{error}}{\Sigma{\frac{1}{error}}}$$</p>
<p><strong>Error estimation using Monte Carlo simulation</strong></p>
<p>Error estimation is done using a parametric bootstrapping approach. A set of
<code>Lx/Tx</code> values is constructed by randomly drawing curve data sampled from normal
distributions. The normal distribution is defined by the input values (<code>mean = value</code>, <code>sd = value.error</code>). Then, a dose-response curve fit is attempted for each
dataset resulting in a new distribution of single <code>De</code> values. The standard
deviation of this distribution is becomes then the error of the <code>De</code>. With increasing
iterations, the error value becomes more stable. However, naturally the error
will not decrease with more MC runs.</p>
<p>Alternatively, the function returns highest probability density interval
estimates as output, users may find more useful under certain circumstances.</p>
<p><strong>Note:</strong> It may take some calculation time with increasing MC runs,
especially for the composed functions (<code>EXP+LIN</code> and <code>EXP+EXP</code>).<br>
Each error estimation is done with the function of the chosen fitting method.</p>
<p><strong>Subtitle information</strong></p>
<p>To avoid plotting the subtitle information, provide an empty user <code>mtext</code>
<code>mtext = ""</code>. To plot any other subtitle text, use <code>mtext</code>.</p>
    </div>
    <div id="function-version">
    <h2>Function version</h2>
    <p>1.11.10</p>
    </div>
    <div id="how-to-cite">
    <h2>How to cite</h2>
    <p>Kreutzer, S., Dietze, M., 2023. plot_GrowthCurve(): Fit and plot a dose-response curve for luminescence data (Lx/Tx against dose). Function version 1.11.10. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., 2023. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.23. https://CRAN.R-project.org/package=Luminescence</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Berger, G.W., Huntley, D.J., 1989. Test data for exponential fits. Ancient TL 7, 43-46.</p>
<p>Guralnik, B., Li, B., Jain, M., Chen, R., Paris, R.B., Murray, A.S., Li, S.-H., Pagonis, P.,
Herman, F., 2015. Radiation-induced growth and isothermal decay of infrared-stimulated luminescence
from feldspar. Radiation Measurements 81, 224-231.</p>
<p>Pagonis, V., Kitis, G., Chen, R., 2020. A new analytical equation for the dose response of dosimetric materials,
based on the Lambert W function. Journal of Luminescence 225, 117333. <a href="https://doi.org/10.1016/j.jlumin.2020.117333" class="external-link">doi:10.1016/j.jlumin.2020.117333</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a>, <a href="RLum.Results-class.html">RLum.Results</a>, <a href="get_RLum.html">get_RLum</a>, <a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a>,
<a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a>, <a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a>, <a href="https://rdrr.io/pkg/lamW/man/lamW-package.html" class="external-link">lamW::lambertW0</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)<br>
Michael Dietze, GFZ Potsdam (Germany)
, RLum Developer Team</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(1) plot growth curve for a dummy data.set and show De value</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.LxTxData</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu">plot_GrowthCurve</span><span class="op">(</span><span class="va">LxTxData</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [plot_GrowthCurve()] Fit: EXP (interpolation) | De = 1737.88 | D01 = 1766.07</span>
<span class="r-plt img"><img src="plot_GrowthCurve-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             De De.Error      D01 D01.ERROR D02 D02.ERROR Dc    De.MC Fit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lower 1737.881 57.41192 1766.074  88.36014  NA        NA NA 1740.717 EXP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       HPDI68_L HPDI68_U HPDI95_L HPDI95_U</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lower 1670.802 1786.901 1628.451 1867.222</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(1b) horizontal plot arrangement</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_GrowthCurve</span><span class="op">(</span><span class="va">LxTxData</span>, output.plotExtended.single <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [plot_GrowthCurve()] Fit: EXP (interpolation) | De = 1737.88 | D01 = 1766.07</span>
<span class="r-plt img"><img src="plot_GrowthCurve-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(1c) to access the fitting value try</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">temp</span>, data.object <span class="op">=</span> <span class="st">"Fit"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nonlinear regression model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model: y ~ a * (1 - exp(-(x + c)/b))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    data: data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a        b        c </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6.806 1766.074    5.051 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  weighted residual sum-of-squares: 0.0004268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of iterations to convergence: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Achieved convergence tolerance: 1.49e-08</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(2) plot the growth curve only - uncomment to use</span></span></span>
<span class="r-in"><span><span class="co">##pdf(file = "~/Desktop/Growth_Curve_Dummy.pdf", paper = "special")</span></span></span>
<span class="r-in"><span><span class="fu">plot_GrowthCurve</span><span class="op">(</span><span class="va">LxTxData</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [plot_GrowthCurve()] Fit: EXP (interpolation) | De = 1737.88 | D01 = 1766.07</span>
<span class="r-plt img"><img src="plot_GrowthCurve-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">##dev.off()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(3) plot growth curve with pdf output - uncomment to use, single output</span></span></span>
<span class="r-in"><span><span class="co">##pdf(file = "~/Desktop/Growth_Curve_Dummy.pdf", paper = "special")</span></span></span>
<span class="r-in"><span><span class="fu">plot_GrowthCurve</span><span class="op">(</span><span class="va">LxTxData</span>, output.plotExtended.single <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [plot_GrowthCurve()] Fit: EXP (interpolation) | De = 1737.88 | D01 = 1766.07</span>
<span class="r-in"><span><span class="co">##dev.off()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(4) plot resulting function for given intervall x</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10000</span>, by <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span> y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">Formula</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> type <span class="op">=</span> <span class="st">"l"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_GrowthCurve-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(5) plot using the 'extrapolation' mode</span></span></span>
<span class="r-in"><span><span class="va">LxTxData</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.001</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">plot_GrowthCurve</span><span class="op">(</span><span class="va">LxTxData</span>,mode <span class="op">=</span> <span class="st">"extrapolation"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [plot_GrowthCurve()] Fit: EXP (extrapolation) | De = 109.74 | D01 = 2624.06</span>
<span class="r-plt img"><img src="plot_GrowthCurve-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [RLum.Results-class]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 originator: plot_GrowthCurve()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 data: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  	 .. $De : data.frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $De.MC : numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $Fit : nls</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $Formula : expression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 additional info elements:  1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(6) plot using the 'alternate' mode</span></span></span>
<span class="r-in"><span><span class="va">LxTxData</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.001</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">plot_GrowthCurve</span><span class="op">(</span><span class="va">LxTxData</span>,mode <span class="op">=</span> <span class="st">"alternate"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_GrowthCurve-6.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [RLum.Results-class]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 originator: plot_GrowthCurve()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 data: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  	 .. $De : data.frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $De.MC : logical</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $Fit : nls</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $Formula : expression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 additional info elements:  1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(7) import and fit test data set by Berger &amp; Huntley 1989</span></span></span>
<span class="r-in"><span><span class="va">QNL84_2_unbleached</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/QNL84_2_unbleached.txt"</span>, package <span class="op">=</span> <span class="st">"Luminescence"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">plot_GrowthCurve</span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="va">QNL84_2_unbleached</span>,</span></span>
<span class="r-in"><span> mode <span class="op">=</span> <span class="st">"extrapolation"</span>,</span></span>
<span class="r-in"><span> plot <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span> verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>[plot_GrowthCurve()] 'fit.weights' ignored since the error column is invalid or 0.</span>
<span class="r-plt img"><img src="plot_GrowthCurve-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#calculate confidence interval for the parameters</span></span></span>
<span class="r-in"><span><span class="co">#as alternative error estimation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Fit</span>, level <span class="op">=</span> <span class="fl">0.68</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Waiting for profiling to be done...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           16%         84%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 140543.3024 146731.8471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b    374.0861    425.5679</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c    116.3499    133.3474</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">QNL84_2_bleached</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/QNL84_2_bleached.txt"</span>, package <span class="op">=</span> <span class="st">"Luminescence"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">STRB87_1_unbleached</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/STRB87_1_unbleached.txt"</span>, package <span class="op">=</span> <span class="st">"Luminescence"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">STRB87_1_bleached</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/STRB87_1_bleached.txt"</span>, package <span class="op">=</span> <span class="st">"Luminescence"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="fu">plot_GrowthCurve</span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="va">QNL84_2_bleached</span>,</span></span>
<span class="r-in"><span> mode <span class="op">=</span> <span class="st">"alternate"</span>,</span></span>
<span class="r-in"><span> plot <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span> verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">Fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="fu">plot_GrowthCurve</span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="va">STRB87_1_unbleached</span>,</span></span>
<span class="r-in"><span> mode <span class="op">=</span> <span class="st">"alternate"</span>,</span></span>
<span class="r-in"><span> plot <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span> verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">Fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="fu">plot_GrowthCurve</span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="va">STRB87_1_bleached</span>,</span></span>
<span class="r-in"><span> mode <span class="op">=</span> <span class="st">"alternate"</span>,</span></span>
<span class="r-in"><span> plot <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span> verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">Fit</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

