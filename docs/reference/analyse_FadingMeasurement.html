<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Analyse fading measurements and returns the fading rate per decade (g-value) — analyse_FadingMeasurement • Luminescence</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Analyse fading measurements and returns the fading rate per decade (g-value) — analyse_FadingMeasurement" />
<meta property="og:description" content="The function analysis fading measurements and returns a fading rate including an error estimation.
The function is not limited to standard fading measurements, as can be seen, e.g., Huntley and
Lamothe (2001). Additionally, the density of recombination centres (rho') is estimated after
Kars et al. (2008)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/R-Lum/Luminescence/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Analyse fading measurements and returns the fading rate per decade (g-value)</h1>
    <small class="dont-index">Source: <a href='https://github.com/R-Lum/Luminescence/blob/master/R/analyse_FadingMeasurement.R'><code>R/analyse_FadingMeasurement.R</code></a></small>
    <div class="hidden name"><code>analyse_FadingMeasurement.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function analysis fading measurements and returns a fading rate including an error estimation.
The function is not limited to standard fading measurements, as can be seen, e.g., Huntley and
Lamothe (2001). Additionally, the density of recombination centres (rho') is estimated after
Kars et al. (2008).</p>
    </div>

    <pre class="usage"><span class='fu'>analyse_FadingMeasurement</span><span class='op'>(</span>
  <span class='va'>object</span>,
  structure <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Lx"</span>, <span class='st'>"Tx"</span><span class='op'>)</span>,
  <span class='va'>signal.integral</span>,
  <span class='va'>background.integral</span>,
  t_star <span class='op'>=</span> <span class='st'>"half"</span>,
  n.MC <span class='op'>=</span> <span class='fl'>100</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plot.single <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p><a href='RLum.Analysis-class.html'>RLum.Analysis</a> (<strong>required</strong>):
input object with the measurement data. Alternatively, a <a href='https://rdrr.io/r/base/list.html'>list</a> containing <a href='RLum.Analysis-class.html'>RLum.Analysis</a>
objects or a <a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a> with three columns
(x = LxTx, y = LxTx error, z = time since irradiation) can be provided.
Can also be a wide table, i.e. a <a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a> with a number of columns divisible by 3
and where each triplet has the before mentioned column structure.</p>
<p><strong>Please note: The input object should solely consists of the curve needed for the data analysis, i.e.
only IRSL curves representing Lx (and Tx)</strong></p>
<p>If data from multiple aliquots are provided please <strong>see the details below</strong> with regard to
Lx/Tx normalisation. <strong>The function assumes that all your measurements are related to
one (comparable) sample. If you to treat independent samples, you have use this function
in a loop.</strong></p></td>
    </tr>
    <tr>
      <th>structure</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (<em>with default</em>):
sets the structure of the measurement data. Allowed are <code>'Lx'</code> or <code><a href='https://rdrr.io/r/base/c.html'>c('Lx','Tx')</a></code>.
Other input is ignored</p></td>
    </tr>
    <tr>
      <th>signal.integral</th>
      <td><p><a href='https://rdrr.io/r/base/vector.html'>vector</a> (<strong>required</strong>): vector with channels for the signal integral
(e.g., <code><a href='https://rdrr.io/r/base/c.html'>c(1:10)</a></code>). Not required if a <code>data.frame</code> with <code>LxTx</code> values is provided.</p></td>
    </tr>
    <tr>
      <th>background.integral</th>
      <td><p><a href='https://rdrr.io/r/base/vector.html'>vector</a> (<strong>required</strong>): vector with channels for the background integral
(e.g., <code><a href='https://rdrr.io/r/base/c.html'>c(90:100)</a></code>). Not required if a <code>data.frame</code> with <code>LxTx</code> values is provided.</p></td>
    </tr>
    <tr>
      <th>t_star</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (<em>with default</em>):
method for calculating the time elapsed since irradiation if input is <strong>not</strong> a <code>data.frame</code>.
Options are: <code>'half'</code> (the default), <code>'half_complex</code>, which uses the long equation in Auclair et al. 2003, and
and <code>'end'</code>, which takes the time between irradiation and the measurement step.
Alternatively, <code>t_star</code> can be a function with one parameter which works on <code>t1</code>.
For more information see details. <br /></p>
<p><em><code>t_star</code> has no effect if the input is a <a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a>, because this input comes
without irradiation times.</em></p></td>
    </tr>
    <tr>
      <th>n.MC</th>
      <td><p><a href='https://rdrr.io/r/base/integer.html'>integer</a> (<em>with default</em>):
number for Monte Carlo runs for the error estimation</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
enables/disables verbose mode</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
enables/disables plot output</p></td>
    </tr>
    <tr>
      <th>plot.single</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (<em>with default</em>):
enables/disables single plot mode, i.e. one plot window per plot.
Alternatively a vector specifying the plot to be drawn, e.g.,
<code>plot.single = c(3,4)</code> draws only the last two plots</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>(<em>optional</em>) further arguments that can be passed to internally used functions. Supported arguments:
<code>xlab</code>, <code>log</code>, <code>mtext</code> and <code>xlim</code> for the two first curve plots, and <code>ylim</code> for the fading
curve plot. For further plot customization please use the numerical output of the functions for
own plots.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An <a href='RLum.Results-class.html'>RLum.Results</a> object is returned:</p>
<p>Slot: <strong>@data</strong></p>
<table class='table'>
<tr><td><strong>OBJECT</strong></td><td><strong>TYPE</strong></td><td><strong>COMMENT</strong></td></tr>
<tr><td><code>fading_results</code></td><td><code>data.frame</code></td><td>results of the fading measurement in a table</td></tr>
<tr><td><code>fit</code></td><td><code>lm</code></td><td>object returned by the used linear fitting function <a href='https://rdrr.io/r/stats/lm.html'>stats::lm</a></td></tr>
<tr><td><code>rho_prime</code></td><td><code>data.frame</code></td><td>results of rho' estimation after Kars et al. (2008)</td></tr>
<tr><td><code>LxTx_table</code></td><td><code>data.frame</code></td><td>Lx/Tx table, if curve data had been provided</td></tr>
<tr><td><code>irr.times</code></td><td><code>integer</code></td><td>vector with the irradiation times in seconds</td></tr>
</table>


<p>Slot: <strong>@info</strong></p>
<table class='table'>
<tr><td><strong>OBJECT</strong></td><td><code>TYPE</code></td><td><code>COMMENT</code></td></tr>
<tr><td><code>call</code></td><td><code>call</code></td><td>the original function call</td></tr>
</table>


    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>All provided output corresponds to the \(tc\) value obtained by this analysis. Additionally
in the output object the g-value normalised to 2-days is provided. The output of this function
can be passed to the function <a href='calc_FadingCorr.html'>calc_FadingCorr</a>.</p>
<p><strong>Fitting and error estimation</strong></p>
<p>For the fitting the function <a href='https://rdrr.io/r/stats/lm.html'>stats::lm</a> is used without applying weights. For the
error estimation all input values, except <code>tc</code>, as the precision can be considered as sufficiently
high enough with regard to the underlying problem, are sampled assuming a normal distribution
for each value with the value as the mean and the provided uncertainty as standard deviation.</p>
<p><strong>The options for <code>t_star</code></strong></p>
<ul>
<li><p><code>t_star = "half"</code> (the default) The calculation follows the simplified
version in Auclair et al. (2003), which reads
$$t_{star} := t_1 + (t_2 - t_1)/2$$</p></li>
<li><p><code>t_star = "half_complex"</code> This option applies the complex function shown in Auclair et al. (2003),
which is derived from Aitken (1985) appendix F, equations 9 and 11.
It reads $$t_{star} = t0 * 10^[(t_2 log(t_2/t_0) - t_1 log(t_1/t_0) - 0.43(t_2 - t_1))/(t_2 - t_1)]$$
where 0.43 = \(1/ln(10)\). t0, which is an arbitrary constant, is set to 1.
Please note that the equation in Auclair et al. (2003) is incorrect
insofar that it reads \(10exp(...)\), where the base should be 10 and not the Euler's number.
Here we use the correct version (base 10).</p></li>
<li><p><code>t_star = "end"</code> This option uses the simplest possible form for <code>t_star</code> which is the time since
irradiation without taking into account any addition parameter and it equals t1 in Auclair et al. (2003)</p></li>
<li><p><code>t_star = &lt;function&gt;</code> This last option allows you to provide an R function object that works on t1 and
gives you all possible freedom. For instance, you may want to define the following
function <code>fun &lt;- function(x) {x^2}</code>, this would square all values of t1, because internally
it calls <code>fun(t1)</code>. The name of the function does not matter.</p></li>
</ul>

<p><strong>Density of recombination centres</strong></p>
<p>The density of recombination centres, expressed by the dimensionless variable rho', is estimated
by fitting equation 5 in Kars et al. 2008 to the data. For the fitting the function
<a href='https://rdrr.io/r/stats/nls.html'>stats::nls</a> is used without applying weights. For the error estimation the same
procedure as for the g-value is applied (see above).</p>
<p><strong>Multiple aliquots &amp; Lx/Tx normalisation</strong></p>
<p>Be aware that this function will always normalise all <code>Lx/Tx</code> values by the <code>Lx/Tx</code> value of the
prompt measurement of the first aliquot. This implicitly assumes that there are no systematic
inter-aliquot variations in <code>Lx/Tx</code> values. If deemed necessary to normalise the <code>Lx/Tx</code> values
of each aliquot by its individual prompt measurement please do so <strong>before</strong> running
analyse_FadingMeasurement and provide the already normalised values for <code>object</code> instead.</p>
    <h2 class="hasAnchor" id="function-version"><a class="anchor" href="#function-version"></a>Function version</h2>

    <p>0.1.19</p>
    <h2 class="hasAnchor" id="how-to-cite"><a class="anchor" href="#how-to-cite"></a>How to cite</h2>

    <p>Kreutzer, S., Burow, C., 2021. analyse_FadingMeasurement(): Analyse fading measurements and returns the fading rate per decade (g-value). Function version 0.1.19. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., 2021. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.14. https://CRAN.R-project.org/package=Luminescence</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Aitken, M.J., 1985. Thermoluminescence dating, Studies in archaeological science.
Academic Press, London, Orlando.</p>
<p>Auclair, M., Lamothe, M., Huot, S., 2003. Measurement of anomalous fading for feldspar IRSL using
SAR. Radiation Measurements 37, 487-492. doi: <a href='https://doi.org/10.1016/S1350-4487(03)00018-0'>10.1016/S1350-4487(03)00018-0</a></p>
<p>Huntley, D.J., Lamothe, M., 2001. Ubiquity of anomalous fading in K-feldspars and the measurement
and correction for it in optical dating. Canadian Journal of Earth Sciences 38,
1093-1106. doi: <code>10.1139/cjes-38-7-1093</code></p>
<p>Kars, R.H., Wallinga, J., Cohen, K.M., 2008. A new approach towards anomalous
fading correction for feldspar  IRSL dating-tests on samples in field saturation.
Radiation Measurements 43, 786-790. doi: <a href='https://doi.org/10.1016/j.radmeas.2008.01.021'>10.1016/j.radmeas.2008.01.021</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='calc_OSLLxTxRatio.html'>calc_OSLLxTxRatio</a>, <a href='read_BIN2R.html'>read_BIN2R</a>, <a href='read_XSYG2R.html'>read_XSYG2R</a>,
<a href='extract_IrradiationTimes.html'>extract_IrradiationTimes</a>, <a href='calc_FadingCorr.html'>calc_FadingCorr</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastian Kreutzer, Geography &amp; Earth Sciences, Aberystwyth University (United Kingdom) <br />
Christoph Burow, University of Cologne (Germany)
, RLum Developer Team</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## load example data (sample UNIL/NB123, see ?ExampleData.Fading)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"ExampleData.Fading"</span>, envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>environment</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>##(1) get fading measurement data (here a three column data.frame)</span>
<span class='va'>fading_data</span> <span class='op'>&lt;-</span> <span class='va'>ExampleData.Fading</span><span class='op'>$</span><span class='va'>fading.data</span><span class='op'>$</span><span class='va'>IR50</span>

<span class='co'>##(2) run analysis</span>
<span class='va'>g_value</span> <span class='op'>&lt;-</span> <span class='fu'>analyse_FadingMeasurement</span><span class='op'>(</span>
<span class='va'>fading_data</span>,
plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
n.MC <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
</div><div class='img'><img src='analyse_FadingMeasurement-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; [analyse_FadingMeasurement()]
#&gt; 
#&gt;  n.MC:	10
#&gt;  tc:	3.78e+02 s
#&gt; ---------------------------------------------------
#&gt; T_0.5 interpolated:	NA
#&gt; T_0.5 predicted:	4e+11
#&gt; g-value:		5.18 ± 0.34 (%/decade)
#&gt; g-value (norm. 2 days):	6.01 ± 0.34 (%/decade)
#&gt; ---------------------------------------------------
#&gt; rho':			3.93e-06 ± 3.81e-07
#&gt; log10(rho'):		-5.41 ± 0.04
#&gt; ---------------------------------------------------</div><div class='input'>
<span class='co'>##(3) this can be further used in the function</span>
<span class='co'>## to correct the age according to Huntley &amp; Lamothe, 2001</span>
<span class='va'>results</span> <span class='op'>&lt;-</span> <span class='fu'><a href='calc_FadingCorr.html'>calc_FadingCorr</a></span><span class='op'>(</span>
age.faded <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>,<span class='fl'>2</span><span class='op'>)</span>,
g_value <span class='op'>=</span> <span class='va'>g_value</span>,
n.MC <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; [calc_FadingCorr()]
#&gt; 
#&gt;  &gt;&gt; Fading correction according to Huntley &amp; Lamothe (2001)
#&gt; 
#&gt;  .. used g-value:	5.182 ± 0.337 %/decade
#&gt;  .. used tc:		1.198e-08 ka
#&gt;  .. used kappa:		0.0225 ± 0.0015
#&gt;  ----------------------------------------------
#&gt;  seed: 			NA
#&gt;  n.MC: 			10
#&gt;  observations: 		10
#&gt;  ----------------------------------------------
#&gt;  Age (faded):		100 ka ± 2 ka
#&gt;  Age (corr.):		203.0812 ka ± 13.4105 ka
#&gt;  ---------------------------------------------- </div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


