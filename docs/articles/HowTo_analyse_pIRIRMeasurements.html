<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to analyse post-IR IRSL measurements? • Luminescence</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to analyse post-IR IRSL measurements?">
<meta property="og:description" content="Luminescence">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Luminescence</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/index.html">
    <span class="fa fa-play"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/NEWS_Version0.9.0.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/Luminescence">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="HowTo_analyse_pIRIRMeasurements_files/header-attrs-2.5/header-attrs.js"></script><link href="HowTo_analyse_pIRIRMeasurements_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="HowTo_analyse_pIRIRMeasurements_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How to analyse post-IR IRSL measurements?</h1>
                        <h4 class="author">Sebastian Kreutzer, IRAMAT-CRP2A, UMR 5060, CNRS - Université Bordeaux Montagine, France</h4>
            
            <h4 class="date">Last modified: 2020-11-03 (‘Luminescence’ version: 0.9.8.9000.113)</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/master/vignettes/HowTo_analyse_pIRIRMeasurements.Rmd"><code>vignettes/HowTo_analyse_pIRIRMeasurements.Rmd</code></a></small>
      <div class="hidden name"><code>HowTo_analyse_pIRIRMeasurements.Rmd</code></div>

    </div>

    
    
<div id="scope-and-introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#scope-and-introduction" class="anchor"></a>Scope and introduction</h1>
<p>Using the function <code><a href="../reference/analyse_SAR.CWOSL.html">analyse_SAR.CWOSL()</a></code> are <code><a href="../reference/Analyse_SAR.OSLdata.html">Analyse_SAR.OSLdata()</a></code> from the <strong>R</strong> package ‘Luminescence’ allows to analyse standard OSL (quartz) measurements based on the SAR protocol <span class="citation">(Murray and Wintle 2000)</span>.</p>
<p>The function <code><a href="../reference/analyse_SAR.CWOSL.html">analyse_SAR.CWOSL()</a></code> can also be used for analysing measurements based on the post-IR IRSL protocol (pIRIR, <span class="citation">Thomsen et al. (2008)</span>), since the measurement protocol based on the SAR structure (see the following table) comprising a set of curves with a <span class="math inline">\(L_{x}\)</span> and <span class="math inline">\(T_{x}\)</span> signal pattern.</p>
<table class="table">
<thead><tr class="header">
<th>Step</th>
<th>Example</th>
<th>Signal</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Irradiation</td>
<td>beta-irr.</td>
<td>-</td>
</tr>
<tr class="even">
<td>Heating</td>
<td>preheat/TL</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Stimulation</td>
<td>OSL</td>
<td><span class="math inline">\(L_x\)</span></td>
</tr>
<tr class="even">
<td>Irradiation</td>
<td>beta-irr.</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Heating</td>
<td>cutheat/TL</td>
<td>-</td>
</tr>
<tr class="even">
<td>Stimulation</td>
<td>OSL</td>
<td><span class="math inline">\(T_x\)</span></td>
</tr>
</tbody>
</table>
<p>To lower the entry level and make the analysis of post-IR IRSL data more straightforward, some time ago, the function <code><a href="../reference/analyse_pIRIRSequence.html">analyse_pIRIRSequence()</a></code> was developed. This function is basically a wrapper around the two functions <code><a href="../reference/analyse_SAR.CWOSL.html">analyse_SAR.CWOSL()</a></code> and <code><a href="../reference/plot_GrowthCurve.html">plot_GrowthCurve()</a></code>.</p>
<p>This vignette provides a short tutorial exemplifying the analysis of post-IR IRSL data in <strong>R</strong>. To avoid misunderstandings, please keep in mind that the post-IR IRSL protocol is a simple extension of the SAR structure by introducing further stimulations steps only:</p>
<table class="table">
<thead><tr class="header">
<th>Step</th>
<th>Example</th>
<th>Signal</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Irradiation</td>
<td>beta-irr.</td>
<td>-</td>
</tr>
<tr class="even">
<td>Heating</td>
<td>preheat/TL</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Stimulation</td>
<td>IR<span class="math inline">\(_{50}\)</span>
</td>
<td><span class="math inline">\(L_{x_{_1}}\)</span></td>
</tr>
<tr class="even">
<td>Stimulation</td>
<td>pIRIR<span class="math inline">\(_{225}\)</span>
</td>
<td><span class="math inline">\(L_{x_{_2}}\)</span></td>
</tr>
<tr class="odd">
<td>Irradiation</td>
<td>beta-irr.</td>
<td>-</td>
</tr>
<tr class="even">
<td>Heating</td>
<td>preheat/TL</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Stimulation</td>
<td>IR<span class="math inline">\(_{50}\)</span>
</td>
<td><span class="math inline">\(T_{x_{_1}}\)</span></td>
</tr>
<tr class="even">
<td>Stimulation</td>
<td>pIRIR<span class="math inline">\(_{225}\)</span>
</td>
<td><span class="math inline">\(T_{x_{_2}}\)</span></td>
</tr>
</tbody>
</table>
<p>While the number of IRSL stimulation steps is not limited in general (cf. <span class="citation">Fu, Li, and Li (2012)</span>), the number of steps used for recording the signal of interest and the test dose signal must be equal. Example, if the sequence has two stimulation steps for the signal (<span class="math inline">\(L_{x_{_1}}\)</span>, <span class="math inline">\(L_{x_{_2}}\)</span>) (as in the table given above), it also needs two stimulations steps for measuring the test dose. Further steps, e.g., hot bleach steps at the end of the cycle, are allowed, but <strong>do not</strong> belong to the SAR structure and should be removed prior any analysis using the function <code><a href="../reference/analyse_pIRIRSequence.html">analyse_pIRIRSequence()</a></code>.</p>
<p><em>Note: The terminal and graphical output show below is partly truncated to shorten the length of this vignette, however, calling the functions in R will show the full output.</em></p>
</div>
<div id="running-example" class="section level1">
<h1 class="hasAnchor">
<a href="#running-example" class="anchor"></a>Running example</h1>
<p>In our example, the measurement was carried out on a Freiberg Instruments lexsyg luminescence reader. Measurement data are stored in XML-based file format called <em>XSYG</em>. Two pIRIR signals were measured: A IR<span class="math inline">\(_{50}\)</span> and a pIRIR<span class="math inline">\(_{225}\)</span> signal. The preheat steps were carried out as TL.</p>
<div id="data-import" class="section level2">
<h2 class="hasAnchor">
<a href="#data-import" class="anchor"></a>Data import</h2>
<p>To start with, the package ‘Luminescence’ itself has to be loaded. In a next step, measurement data are imported using the function <code><a href="../reference/read_XSYG2R.html">read_XSYG2R()</a></code>. If your input format is a BIN/BINX-file, replace the function <code><a href="../reference/read_XSYG2R.html">read_XSYG2R()</a></code> by <code><a href="../reference/read_BIN2R.html">read_BIN2R()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=Luminescence">Luminescence</a></span><span class="op">)</span>
<span class="va">temp</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/read_XSYG2R.html">read_XSYG2R</a></span><span class="op">(</span><span class="st">"pIRIR_measurementData.xsyg"</span>, fastForward <span class="op">=</span> <span class="cn">TRUE</span>, txtProgressBar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<p>To se the dataset in the <strong>R</strong> terminal, just call the object <code>temp</code></p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">temp</span></pre></div>
<pre><code>## [[1]]
## 
##  [RLum.Analysis-class]
##   originator: read_XSYG2R()
##   protocol: pIRIR225
##   additional info elements:  0
##   number of records: 229
##   .. : RLum.Data.Curve : 229
##   .. .. : #1 TL (UVVIS) &lt;&gt; #2 TL (NA) &lt;&gt; #3 TL (NA) 
##   .. .. : #4 IRSL (UVVIS) &lt;&gt; #5 IRSL (NA) &lt;&gt; #6 IRSL (NA) &lt;&gt; #7 IRSL (NA) &lt;&gt; #8 IRSL (NA)
##   .. .. : #9 IRSL (UVVIS) &lt;&gt; #10 IRSL (NA) &lt;&gt; #11 IRSL (NA) &lt;&gt; #12 IRSL (NA) &lt;&gt; #13 IRSL (NA) 
##   .. .. : #14 irradiation (NA)
##   .. .. : #15 TL (UVVIS) &lt;&gt; #16 TL (NA) &lt;&gt; #17 TL (NA) 
##   .. .. : #18 IRSL (UVVIS) &lt;&gt; #19 IRSL (NA) &lt;&gt; #20 IRSL (NA) &lt;&gt; #21 IRSL (NA) &lt;&gt; #22 IRSL (NA)
##   .. .. : #23 IRSL (UVVIS) &lt;&gt; #24 IRSL (NA) &lt;&gt; #25 IRSL (NA) &lt;&gt; #26 IRSL (NA) &lt;&gt; #27 IRSL (NA) 
## ... &lt;remaining records truncated manually&gt;</code></pre>
<p>The output shows an <code>RLum.Analysis</code> object, which contains all recorded curves (<code>RLum.Data.Curve</code> objects) from one aliquot (e.g., cup/disc). In total, the dataset contains the curves of 7 aliquots. All records are numbered, here from <code>#1</code> to <code>#208</code> (shown only until <code>#29</code>) and named by their corresponding record type (<code>TL</code>, <code>IRSL</code>). So far available, within round brackets, information on the detector are given (<code>UVVIS</code> and <code>NA</code>). This reveals that the object contains curves which are not wanted for the analysis.</p>
<p>Curves which belong to a specific measurement step (e.g., IRSL stimulation) are connected with the <code>&lt;&gt;</code> symbol. However, curves with <code>(NA)</code> are curves recorded by technical components (e.g., temperature sensor) other than the photomultiplier tube and not wanted, even they belong to the dataset. In our case, unfortunately, the information <code>(UVVIS)</code> is rather uninformative, but a usual case, since <em>it depends on the measurement device whether information on the detector are available or not.</em> This example emphasises that prior knowledge of the data structure and the used technical components are indispensable.</p>
</div>
<div id="select-wanted-curves" class="section level2">
<h2 class="hasAnchor">
<a href="#select-wanted-curves" class="anchor"></a>Select wanted curves</h2>
<p>To select only wanted curves wanted for the analysis the function <code><a href="../reference/get_RLum.html">get_RLum()</a></code> can be used:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">temp_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">temp</span>, recordType <span class="op">=</span> <span class="st">"UVVIS"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">temp_sel</span></pre></div>
<pre><code>## [[1]]
## 
##  [RLum.Analysis-class]
##   originator: read_XSYG2R()
##   protocol: pIRIR225
##   additional info elements:  0
##   number of records: 49
##   .. : RLum.Data.Curve : 49
##   .. .. : #1 TL (UVVIS) | #2 IRSL (UVVIS) | #3 IRSL (UVVIS) | #4 TL (UVVIS) | #5 IRSL (UVVIS) | #6 IRSL (UVVIS) | #7 IRSL (UVVIS)
##   .. .. : #8 TL (UVVIS) | #9 IRSL (UVVIS) | #10 IRSL (UVVIS) | #11 TL (UVVIS) | #12 IRSL (UVVIS) | #13 IRSL (UVVIS) | #14 IRSL (UVVIS)
## ... &lt;remaining records truncated manually&gt;</code></pre>
<p>The function <code><a href="../reference/get_RLum.html">get_RLum()</a></code> is very powerful and supports sophisticated subsetting of a <code>RLum.Analysis</code> objects. Further useful arguments are <code>curveType</code> and <code>record.id</code>. The latter one allows a subsetting by record id (e.g., <code>record.id = 2</code> to select <code>#2</code>) and supports also negative subsetting (e.g., to remove only <code>#2</code>, type <code>record.id = -2</code>). To understand the meaning of the argument <code>drop = FALSE</code>, please call the function <code><a href="../reference/get_RLum.html">get_RLum()</a></code> another time with <code>drop = TRUE</code> and see the difference in the <strong>R</strong> terminal. For all supported arguments see the manual of the function by typing <code><a href="../reference/get_RLum.html">?get_RLum</a></code> in the <strong>R</strong> terminal.</p>
<p>In our example, however, the dataset does not yet follow the SAR structure. The sequence comprises a hotbleach at the end of each cycles (record <code>#7</code> in the terminal output example above). This curves are not wanted a have to be removed. This can be done using again the function <code><a href="../reference/get_RLum.html">get_RLum()</a></code> with the argument <code>record.id</code>. Please note that by executing the following example the object <code>temp_sel</code> will be replaced.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">temp_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">temp_sel</span>, record.id <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">temp_sel</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">temp_sel</span></pre></div>
<pre><code>## [[1]]
## 
##  [RLum.Analysis-class]
##   originator: read_XSYG2R()
##   protocol: pIRIR225
##   additional info elements:  0
##   number of records: 42
##   .. : RLum.Data.Curve : 42
##   .. .. : #1 TL (UVVIS) | #2 IRSL (UVVIS) | #3 IRSL (UVVIS) | #4 TL (UVVIS) | #5 IRSL (UVVIS) | #6 IRSL (UVVIS) | #7 TL (UVVIS)
##   .. .. : #8 IRSL (UVVIS) | #9 IRSL (UVVIS) | #10 TL (UVVIS) | #11 IRSL (UVVIS) | #12 IRSL (UVVIS) | #13 TL (UVVIS) | #14 IRSL (UVVIS)
## ... &lt;remaining records truncated manually&gt;</code></pre>
<p>Using a negative subsetting, all hotbleach curves have been removed using the call <code>-seq(7,length(temp_sel[[1]]), by = 7)</code>. Important is to understand that the function <code><a href="https://rdrr.io/r/base/length.html">length()</a></code> was called for the first list element of <code>temp_sel</code>, which contains the recorded curves for the first aliquot only. To see the differences type:</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">temp_sel</span><span class="op">)</span></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">temp_sel</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></pre></div>
<pre><code>## [1] 42</code></pre>
<p>In other words, our measurement record has data from 7 aliquots and each aliquot consits of (at least) 42 records. We here further assume that the number of records is similar for each aliquot.</p>
</div>
</div>
<div id="analyse-sequence" class="section level1">
<h1 class="hasAnchor">
<a href="#analyse-sequence" class="anchor"></a>Analyse sequence</h1>
<p>Now the object <code>temp_sel</code> only comprises TL and IRSL curves, and this data can be directly passed to the function <code><a href="../reference/analyse_pIRIRSequence.html">analyse_pIRIRSequence()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyse_pIRIRSequence.html">analyse_pIRIRSequence</a></span><span class="op">(</span>
  object <span class="op">=</span> <span class="va">temp_sel</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,
  signal.integral.min <span class="op">=</span> <span class="fl">1</span>,
  signal.integral.max <span class="op">=</span> <span class="fl">10</span>,
  background.integral.min <span class="op">=</span> <span class="fl">800</span>, 
  background.integral.max <span class="op">=</span> <span class="fl">999</span>,
  dose.points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">340</span>, <span class="fl">680</span>, <span class="fl">1020</span>, <span class="fl">1360</span>, <span class="fl">0</span>, <span class="fl">340</span><span class="op">)</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<p><img src="HowTo_analyse_pIRIRMeasurements_files/figure-html/unnamed-chunk-12-1.png" width="700" height="400px" style="display: block; margin: auto;"></p>
<p>The function expects the setting of some arguments, for details and meaning, please see <code><a href="../reference/analyse_pIRIRSequence.html">?analyse_pIRIRSequence</a></code>. If the imported measurement data do not carry information on the <code>dose.points</code>, as it is the case in our example, these values have to be provided manually. Please note that the information needed for <code>dose.points</code> is something which was defined while writing the measurement sequence (your irradiation times).</p>
<p>The function output is a comprehensive plot scheme and a so-called <code>RLum.Results</code> object, which contains all relevant calculations from the analysis.</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="va">results</span></pre></div>
<pre><code>## 
##  [RLum.Results-class]
##   originator: analyse_pIRIRSequence()
##   data: 4
##       .. $data : data.frame
##   .. $LnLxTnTx.table : data.frame
##   .. $rejection.criteria : data.frame
##   .. $Formula : list
##   additional info elements:  14</code></pre>
<p>The <span class="math inline">\(D_{e}\)</span> values (here in seconds) can be seen by calling the <code>$data</code> element from the object <code>results</code>, which is a <code>data.frame</code> (and here limited to three columns):</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="va">results</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"De"</span>, <span class="st">"De.Error"</span>, <span class="st">"RC.Status"</span>, <span class="st">"Signal"</span><span class="op">)</span><span class="op">]</span></pre></div>
<pre><code>##           De De.Error RC.Status   Signal
## 1   803.5434    35.84        OK     IR50
## 2  1099.8584    32.09        OK pIRIR225
## 3   632.8027    29.38        OK     IR50
## 4   873.7713    24.20        OK pIRIR225
## 5  1166.2585    32.60        OK     IR50
## 6  1058.8393    18.62        OK pIRIR225
## 7   741.3041    30.53    FAILED     IR50
## 8  1049.1700    29.28        OK pIRIR225
## 9   873.9625    59.23        OK     IR50
## 10 1236.3436    53.47        OK pIRIR225
## 11  827.6762    44.40        OK     IR50
## 12 1095.2448    31.75        OK pIRIR225
## 13  714.1201    21.65        OK     IR50
## 14  807.3030    17.47        OK pIRIR225</code></pre>
<p>The column <code>RC.Status</code> informs you about a failed rejection criterium, which one is not revealed, but the column provides a possibilty for further subsetting. For a quick data processing this is, together with the plot output, usually enough information. However, to see all rejection criteria type <code>results$rejection.criteria</code>. To see all information type <code>results$data</code> without further information.</p>
<p>If you want to combine the two tables for a more virtous data processing, you can merge both tables by calling:</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">data</span>, <span class="va">results</span><span class="op">$</span><span class="va">rejection.criteria</span>, by <span class="op">=</span> <span class="st">"UID"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></pre></div>
<pre><code>##                                   UID       De De.Error      D01 D01.ERROR D02
## 1 2020-11-03-12:27.0.0286505836993456  807.303    17.47 1230.636  76.74736  NA
## 2 2020-11-03-12:27.0.0286505836993456  807.303    17.47 1230.636  76.74736  NA
## 3 2020-11-03-12:27.0.0286505836993456  807.303    17.47 1230.636  76.74736  NA
## 4 2020-11-03-12:27.0.0286505836993456  807.303    17.47 1230.636  76.74736  NA
## 5 2020-11-03-12:27.0.0286505836993456  807.303    17.47 1230.636  76.74736  NA
## 6  2020-11-03-12:27.0.364873518468812 1058.839    18.62 1191.583  55.13138  NA
##   D02.ERROR     De.MC Fit RC.Status signal.range background.range
## 1        NA  810.7373 EXP        OK       1 : 10        800 : 999
## 2        NA  810.7373 EXP        OK       1 : 10        800 : 999
## 3        NA  810.7373 EXP        OK       1 : 10        800 : 999
## 4        NA  810.7373 EXP        OK       1 : 10        800 : 999
## 5        NA  810.7373 EXP        OK       1 : 10        800 : 999
## 6        NA 1057.9142 EXP        OK       1 : 10        800 : 999
##   signal.range.Tx background.range.Tx Signal.x                Criteria
## 1         NA : NA             NA : NA pIRIR225 Recycling ratio (R5/R1)
## 2         NA : NA             NA : NA pIRIR225     Recuperation rate 1
## 3         NA : NA             NA : NA pIRIR225          Testdose error
## 4         NA : NA             NA : NA pIRIR225        Palaeodose error
## 5         NA : NA             NA : NA pIRIR225    De &gt; max. dose point
## 6         NA : NA             NA : NA pIRIR225 Recycling ratio (R5/R1)
##         Value Threshold Status Signal.y
## 1   0.9593000       0.1     OK pIRIR225
## 2   0.0032000       0.1     OK pIRIR225
## 3   0.0115479       0.1     OK pIRIR225
## 4   0.0216400       0.1     OK pIRIR225
## 5 807.3029639    1360.0     OK pIRIR225
## 6   1.0451000       0.1     OK pIRIR225</code></pre>
<p>The result may appear confusing in a first instance, since, e.g. the column <code>De</code> appears to contain duplicated entries. But still, each row is unique and in sum contains unique information.</p>
</div>
<div id="plot-results" class="section level1">
<h1 class="hasAnchor">
<a href="#plot-results" class="anchor"></a>Plot results</h1>
<p>To plot the <code>pIRIR225</code> <span class="math inline">\(D_{e}\)</span> values the following call can be used:</p>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="fu"><a href="../reference/plot_KDE.html">plot_KDE</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">data</span>, <span class="va">Signal</span> <span class="op">==</span> <span class="st">"pIRIR225"</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"De"</span>, <span class="st">"De.Error"</span><span class="op">)</span><span class="op">]</span>,
  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">D</span><span class="op">[</span><span class="va">e</span><span class="op">]</span>, <span class="st">" [s]"</span><span class="op">)</span><span class="op">)</span>, 
  summary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"mean"</span>, <span class="st">"sd.abs"</span><span class="op">)</span>
  <span class="op">)</span></pre></div>
<p><img src="HowTo_analyse_pIRIRMeasurements_files/figure-html/unnamed-chunk-17-1.png" width="200" style="display: block; margin: auto;"></p>
</div>
<div id="compacted-call" class="section level1">
<h1 class="hasAnchor">
<a href="#compacted-call" class="anchor"></a>Compacted call</h1>
<p>The above-listed steps can also be shortened to a concise <strong>R</strong> call using the so-called <code>magriitr</code> operator, which basically pipes the results from function to function. To have a difference the final plot is an Abanico plot <span class="citation">Dietze et al. (2016)</span>.</p>
<p><em>Please note that for this last example the arguments <code>plot</code> and <code>verbose</code> have been set to <code>FALSE</code> for most of the functions.</em></p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_XSYG2R.html">read_XSYG2R</a></span><span class="op">(</span><span class="st">"pIRIR_measurementData.xsyg"</span>, fastForward <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/get_RLum.html">get_RLum</a></span><span class="op">(</span>recordType <span class="op">=</span> <span class="st">"UVVIS"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">.</span>,record.id <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">.</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/analyse_pIRIRSequence.html">analyse_pIRIRSequence</a></span><span class="op">(</span>
    signal.integral.min <span class="op">=</span> <span class="fl">1</span>,
    signal.integral.max <span class="op">=</span> <span class="fl">10</span>,
    background.integral.min <span class="op">=</span> <span class="fl">800</span>, 
    background.integral.max <span class="op">=</span> <span class="fl">999</span>,
    dose.points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">340</span>, <span class="fl">680</span>, <span class="fl">1020</span>, <span class="fl">1360</span>, <span class="fl">0</span>, <span class="fl">340</span><span class="op">)</span>, 
    verbose <span class="op">=</span> <span class="cn">FALSE</span>, 
    plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">.</span>,subset <span class="op">=</span> <span class="va">Signal</span> <span class="op">==</span> <span class="st">"pIRIR225"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_AbanicoPlot.html">plot_AbanicoPlot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">.</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"De"</span>, <span class="st">"De.Error"</span><span class="op">)</span><span class="op">]</span>,
  zlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">D</span><span class="op">[</span><span class="va">e</span><span class="op">]</span>, <span class="st">" [s]"</span><span class="op">)</span><span class="op">)</span>, 
  summary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"mean"</span>, <span class="st">"sd.abs"</span><span class="op">)</span>
  <span class="op">)</span></pre></div>
<p><img src="HowTo_analyse_pIRIRMeasurements_files/figure-html/unnamed-chunk-18-1.png" width="250" style="display: block; margin: auto;"></p>
<p>#References {-}</p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Dietze:2015dp" class="csl-entry">
Dietze, Michael, Sebastian Kreutzer, Christoph Burow, Margret C Fuchs, Manfred Fischer, and Christoph Schmidt. 2016. <span>“<span class="nocase">The abanico plot: visualising chronometric data with individual standard errors</span>.”</span> <em>Quaternary Geochronology</em> 31: 12–18.
</div>
<div id="ref-Fu:2012ca" class="csl-entry">
Fu, Xiao, Bo Li, and Sheng-Hua Li. 2012. <span>“<span class="nocase">Testing a multi-step post-IR IRSL dating method using polymineral fine grains from Chinese loess</span>.”</span> <em>Radiation Measurements</em> 10: 8–15.
</div>
<div id="ref-Murray_2000cr" class="csl-entry">
Murray, A S, and Ann G Wintle. 2000. <span>“<span class="nocase">Luminescence dating of quartz using an improved single-aliquot regenerative-dose protocol</span>.”</span> <em>Radiation Measurements</em> 32 (1): 57–73.
</div>
<div id="ref-Thomsen_2008qv" class="csl-entry">
Thomsen, K J, A S Murray, M Jain, and L Boetter-Jensen. 2008. <span>“<span class="nocase">Laboratory fading rates of various luminescence signals from feldspar-rich sediment extracts</span>.”</span> <em>Radiation Measurements</em> 43 (9-10): 1474–86.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
