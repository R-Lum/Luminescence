<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Nonlinear Least Squares Fit for OSL surface exposure data — fit_SurfaceExposure • Luminescence</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Nonlinear Least Squares Fit for OSL surface exposure data — fit_SurfaceExposure"><meta name="description" content="This function determines the (weighted) least-squares estimates of the
parameters of either equation 1 in Sohbati et al. (2012a) or equation 12 in
Sohbati et al. (2012b) for a given OSL surface exposure data set (BETA)."><meta property="og:description" content="This function determines the (weighted) least-squares estimates of the
parameters of either equation 1 in Sohbati et al. (2012a) or equation 12 in
Sohbati et al. (2012b) for a given OSL surface exposure data set (BETA)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Nonlinear Least Squares Fit for OSL surface exposure data</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/v1.1.1/R/fit_SurfaceExposure.R" class="external-link"><code>R/fit_SurfaceExposure.R</code></a></small>
      <div class="d-none name"><code>fit_SurfaceExposure.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function determines the (weighted) least-squares estimates of the
parameters of either equation 1 in <em>Sohbati et al. (2012a)</em> or equation 12 in
<em>Sohbati et al. (2012b)</em> for a given OSL surface exposure data set (<strong>BETA</strong>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_SurfaceExposure</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  sigmaphi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  age <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Ddot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  D0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  error_bars <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  coord_flip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> or <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> (<strong>required</strong>):
Measured OSL surface exposure data with the following structure:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>                               (optional)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>     <span class="sc">|</span> <span class="fu">depth</span> (a.u.)<span class="sc">|</span> intensity <span class="sc">|</span> error <span class="sc">|</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>     <span class="er">|</span>     [ ,<span class="dv">1</span>]   <span class="sc">|</span>    [ ,<span class="dv">2</span>]  <span class="sc">|</span> [ ,<span class="dv">3</span>] <span class="sc">|</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>     <span class="er">|</span><span class="sc">-------------</span><span class="er">|</span><span class="sc">-----------</span><span class="er">|</span><span class="sc">-------</span><span class="er">|</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>[<span class="dv">1</span>, ]<span class="sc">|</span>    <span class="er">~~~~</span>     <span class="er">|</span>    <span class="er">~~~~</span>   <span class="er">|</span> <span class="er">~~~~</span>  <span class="er">|</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>[<span class="dv">2</span>, ]<span class="sc">|</span>    <span class="er">~~~~</span>     <span class="er">|</span>    <span class="er">~~~~</span>   <span class="er">|</span> <span class="er">~~~~</span>  <span class="er">|</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a> ... <span class="sc">|</span>     ...     <span class="sc">|</span>     ...   <span class="sc">|</span>  ...  <span class="sc">|</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>[x, ]<span class="sc">|</span>    <span class="er">~~~~</span>     <span class="er">|</span>    <span class="er">~~~~</span>   <span class="er">|</span> <span class="er">~~~~</span>  <span class="er">|</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span></code></pre><p></p></div>
<p>Alternatively, a <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> of <code>data.frames</code> can be provided, where each
<code>data.frame</code> has the same structure as shown above, with the exception that
they must <strong>not</strong> include the optional error column. Providing a <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> as
input automatically activates the global fitting procedure (see details).</p></dd>


<dt id="arg-sigmaphi">sigmaphi<a class="anchor" aria-label="anchor" href="#arg-sigmaphi"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
A numeric value for <code>sigmaphi</code>, i.e. the charge detrapping rate.
Example: <code>sigmaphi = 5e-10</code></p></dd>


<dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
A numeric value for <code>mu</code>, i.e. the light attenuation coefficient. If <code>data</code>
is a list of <em>n</em> samples, then <code>mu</code> must be a vector of length 1 or <em>n</em>.
Example: <code>mu = 0.9</code>, or <code>mu = c(0.9, 0.8, 0.9)</code>.</p></dd>


<dt id="arg-age">age<a class="anchor" aria-label="anchor" href="#arg-age"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
The age (a) of the sample, if known. If <code>data</code> is a <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> of <em>n</em> samples,
then <code>age</code> must be a numeric vector of length <em>n</em>.
Example: <code>age = 10000</code>, or <code>age = c(1e4, 1e5, 1e6)</code>.</p></dd>


<dt id="arg-ddot">Ddot<a class="anchor" aria-label="anchor" href="#arg-ddot"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
A numeric value for the environmental dose rate (Gy/ka). For this argument
to be considered a value for <code>D0</code> must also be provided; otherwise it will be
ignored.</p></dd>


<dt id="arg-d-">D0<a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
A numeric value for the characteristic saturation dose (Gy). For this argument
to be considered a value for <code>Ddot</code> must also be provided; otherwise it will be
ignored.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
If <code>TRUE</code> the fit will be weighted by the inverse square of the error.
Requires <code>data</code> to be a <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> with three columns.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disable the plot output.</p></dd>


<dt id="arg-legend">legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
Show or hide the equation inside the plot.</p></dd>


<dt id="arg-error-bars">error_bars<a class="anchor" aria-label="anchor" href="#arg-error-bars"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
Show or hide error bars (only applies if errors were provided).</p></dd>


<dt id="arg-coord-flip">coord_flip<a class="anchor" aria-label="anchor" href="#arg-coord-flip"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
Flip the coordinate system.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further parameters passed to <a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a>.
Custom parameters include:</p><ul><li><p><code>verbose</code> (<a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a>): show or hide console output</p></li>
<li><p><code>line_col</code>: Colour of the fitted line</p></li>
<li><p><code>line_lty</code>: Type of the fitted line (see <code>lty</code> in <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">?par</a></code>)</p></li>
<li><p><code>line_lwd</code>: Line width of the fitted line (see <code>lwd</code> in <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">?par</a></code>)</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Function returns results numerically and graphically:</p>
<p>———————————–<br><code>[ NUMERICAL OUTPUT ]</code><br>
———————————–<br></p>
<p><strong><code>RLum.Results</code></strong>-object</p>
<p><strong>slot:</strong> <strong><code>@data</code></strong></p>
<table class="table table"><tr><td><strong>Element</strong></td><td><strong>Type</strong></td><td><strong>Description</strong></td></tr><tr><td><code>$summary</code></td><td><code>data.frame</code></td><td>summary of the fitting results</td></tr><tr><td><code>$data</code></td><td><code>data.frame</code></td><td>the original input data</td></tr><tr><td><code>$fit</code></td><td><code>nls</code></td><td>the fitting object produced by <a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a></td></tr><tr><td><code>$args</code></td><td><code>character</code></td><td>arguments of the call</td></tr><tr><td><code>$call</code></td><td><code>call</code></td><td>the original function call</td></tr></table><p><strong>slot:</strong> <strong><code>@info</code></strong></p>
<p>Currently unused.</p>
<p>————————<br><code>[ PLOT OUTPUT ]</code><br>
————————<br></p>
<p>A scatter plot of the provided depth-intensity OSL surface exposure data
with the fitted model.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Weighted fitting</strong></p>
<p>If <code>weights = TRUE</code> the function will use the inverse square of the error (\(1/\sigma^2\))
as weights during fitting using <a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a>. Naturally, for this to
take effect individual errors must be provided in the third column of the
<code>data.frame</code> for <code>data</code>. Weighted fitting is <strong>not</strong> supported if <code>data</code>
is a list of multiple <code>data.frame</code>s, i.e., it is not available for global
fitting.</p>
<p><strong>Dose rate</strong>
If any of the arguments <code>Ddot</code> or <code>D0</code> is at its default value (<code>NULL</code>),
this function will fit equation 1 in Sohbati et al. (2012a) to the data. If
the effect of dose rate (i.e., signal saturation) needs to be considered,
numeric values for the dose rate (<code>Ddot</code>) (in Gy/ka) and the characteristic
saturation dose (<code>D0</code>) (in Gy) must be provided. The function will then fit
equation 12 in Sohbati et al. (2012b) to the data.</p>
<p><strong>NOTE</strong>: Currently, this function does <strong>not</strong> consider the variability
of the dose rate with sample depth (<code>x</code>)! In the original equation the dose
rate <code>D</code> is an arbitrary function of <code>x</code> (term <code>D(x)</code>), but here <code>D</code> is assumed
constant.</p>
<p><strong>Global fitting</strong>
If <code>data</code> is <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> of multiple <code>data.frame</code>s, each representing a separate
sample, the function automatically performs a global fit to the data. This
may be useful to better constrain the parameters <code>sigmaphi</code> or <code>mu</code> and
<strong>requires</strong> that known ages for each sample is provided
(e.g., <code>age = c(100, 1000)</code> if <code>data</code> is a list with two samples).</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><strong>This function has BETA status. If possible, results should be</strong>
<strong>cross-checked.</strong></p>
    </div>
    <div class="section level2">
    <h2 id="function-version">Function version<a class="anchor" aria-label="anchor" href="#function-version"></a></h2>
    <p>0.1.0</p>
    </div>
    <div class="section level2">
    <h2 id="how-to-cite">How to cite<a class="anchor" aria-label="anchor" href="#how-to-cite"></a></h2>
    <p>Burow, C., 2025. fit_SurfaceExposure(): Nonlinear Least Squares Fit for OSL surface exposure data. Function version 0.1.0. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., Colombo, M., Steinbuch, L., Boer, A.d., 2025. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 1.1.1. https://r-lum.github.io/Luminescence/</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Sohbati, R., Murray, A.S., Chapot, M.S., Jain, M., Pederson, J., 2012a.
Optically stimulated luminescence (OSL) as a chronometer for surface exposure
dating. Journal of Geophysical Research 117, B09202. doi:
<a href="https://doi.org/10.1029/2012JB009383" class="external-link">doi:10.1029/2012JB009383</a></p>
<p>Sohbati, R., Jain, M., Murray, A.S., 2012b. Surface exposure dating of
non-terrestrial bodies using optically stimulated luminescence: A new method.
Icarus 221, 160-166.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="ExampleData.SurfaceExposure.html">ExampleData.SurfaceExposure</a>, <a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Christoph Burow, University of Cologne (Germany)
, RLum Developer Team</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ExampleData.SurfaceExposure"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 1 - Single sample</span></span></span>
<span class="r-in"><span><span class="co"># Known parameters: 10000 a, mu = 0.9, sigmaphi = 5e-10</span></span></span>
<span class="r-in"><span><span class="va">sample_1</span> <span class="op">&lt;-</span> <span class="va">ExampleData.SurfaceExposure</span><span class="op">$</span><span class="va">sample_1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sample_1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   depth   intensity      error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.0  0.05487370 0.08018774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   0.1 -0.06055516 0.17745452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   0.2  0.09560277 0.12385804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   0.3 -0.05973453 0.05593426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   0.4 -0.02775111 0.19830218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   0.5  0.04852239 0.06168570</span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">fit_SurfaceExposure</span><span class="op">(</span></span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="va">sample_1</span>,</span></span>
<span class="r-in"><span> mu <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span> sigmaphi <span class="op">=</span> <span class="fl">5e-10</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_SurfaceExposure-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [fit_SurfaceExposure()] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Estimated parameter(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  age (a):	 9890 ± 369 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Fixed parameter(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sigmaphi:	 5e-10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  mu:		 0.9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        age age_error sigmaphi sigmaphi_error  mu mu_error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 9892.927  369.0142    5e-10             NA 0.9       NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 2 - Single sample and considering dose rate</span></span></span>
<span class="r-in"><span><span class="co"># Known parameters: 10000 a, mu = 0.9, sigmaphi = 5e-10,</span></span></span>
<span class="r-in"><span><span class="co"># dose rate = 2.5 Gy/ka, D0 = 40 Gy</span></span></span>
<span class="r-in"><span><span class="va">sample_2</span> <span class="op">&lt;-</span> <span class="va">ExampleData.SurfaceExposure</span><span class="op">$</span><span class="va">sample_2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sample_2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   depth   intensity      error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.0  0.05881908 0.08018774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   0.1 -0.05623983 0.17745452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   0.2  0.10032258 0.12385804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   0.3 -0.05457253 0.05593426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   0.4 -0.02210573 0.19830218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   0.5  0.05469614 0.06168570</span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">fit_SurfaceExposure</span><span class="op">(</span></span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="va">sample_2</span>,</span></span>
<span class="r-in"><span> mu <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span> sigmaphi <span class="op">=</span> <span class="fl">5e-10</span>,</span></span>
<span class="r-in"><span> Ddot <span class="op">=</span> <span class="fl">2.5</span>,</span></span>
<span class="r-in"><span> D0 <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_SurfaceExposure-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [fit_SurfaceExposure()] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Estimated parameter(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  age (a):	 9800 ± 675 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Fixed parameter(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sigmaphi:	 5e-10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  mu:		 0.9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        age age_error sigmaphi sigmaphi_error  mu mu_error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 9803.815  674.8718    5e-10             NA 0.9       NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 3 - Multiple samples (global fit) to better constrain 'mu'</span></span></span>
<span class="r-in"><span><span class="co"># Known parameters: ages = 1e3, 1e4, 1e5, 1e6 a, mu = 0.9, sigmaphi = 5e-10</span></span></span>
<span class="r-in"><span><span class="va">set_1</span> <span class="op">&lt;-</span> <span class="va">ExampleData.SurfaceExposure</span><span class="op">$</span><span class="va">set_1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">set_1</span>, max.level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ :'data.frame':	76 obs. of  2 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ depth    : num [1:76] 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ intensity: num [1:76] 0.0274 -0.0303 0.0478 -0.0298 -0.0134 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ :'data.frame':	76 obs. of  2 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ depth    : num [1:76] 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ intensity: num [1:76] 0.00714 -0.04511 0.04804 0.04145 0.0266 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ :'data.frame':	76 obs. of  2 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ depth    : num [1:76] 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ intensity: num [1:76] -0.0284 0.00732 -0.04984 0.02182 -0.02349 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ :'data.frame':	76 obs. of  2 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ depth    : num [1:76] 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ intensity: num [1:76] -0.0122 -0.0189 0.0358 -0.0314 -0.0454 ...</span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">fit_SurfaceExposure</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">set_1</span>,</span></span>
<span class="r-in"><span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e3</span>, <span class="fl">1e4</span>, <span class="fl">1e5</span>, <span class="fl">1e6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sigmaphi <span class="op">=</span> <span class="fl">5e-10</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_SurfaceExposure-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [fit_SurfaceExposure()] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Shared estimated parameter(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  mu:		 0.901 ± 0.00161 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Fixed parameter(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  age (a):	 1000, 10000, 1e+05, 1e+06 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sigmaphi:	 5e-10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> To apply the estimated parameters to a sample of unknown age run:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> fit_SurfaceExposure(data = set_1, sigmaphi = 5e-10, mu = c(0.901, 0.901, 0.901, 0.901))</span>
<span class="r-in"><span><span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     age age_error sigmaphi sigmaphi_error        mu    mu_error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1e+03        NA    5e-10             NA 0.9009494 0.001612274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1e+04        NA    5e-10             NA 0.9009494 0.001612274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1e+05        NA    5e-10             NA 0.9009494 0.001612274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1e+06        NA    5e-10             NA 0.9009494 0.001612274</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 4 - Multiple samples (global fit) and considering dose rate</span></span></span>
<span class="r-in"><span><span class="co"># Known parameters: ages = 1e2, 1e3, 1e4, 1e5, 1e6 a, mu = 0.9, sigmaphi = 5e-10,</span></span></span>
<span class="r-in"><span><span class="co"># dose rate = 1.0 Ga/ka, D0 = 40 Gy</span></span></span>
<span class="r-in"><span><span class="va">set_2</span> <span class="op">&lt;-</span> <span class="va">ExampleData.SurfaceExposure</span><span class="op">$</span><span class="va">set_2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">set_2</span>, max.level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ :'data.frame':	76 obs. of  2 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ depth    : num [1:76] 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ intensity: num [1:76] 0.235 0.238 0.381 0.369 0.451 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ :'data.frame':	76 obs. of  2 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ depth    : num [1:76] 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ intensity: num [1:76] 0.00872 -0.04321 0.05032 0.04426 0.03029 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ :'data.frame':	76 obs. of  2 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ depth    : num [1:76] 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ intensity: num [1:76] -0.02682 0.00921 -0.04757 0.02453 -0.02024 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ :'data.frame':	76 obs. of  2 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ depth    : num [1:76] 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ intensity: num [1:76] -0.0106 -0.0171 0.0381 -0.0287 -0.0422 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ :'data.frame':	76 obs. of  2 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ depth    : num [1:76] 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ intensity: num [1:76] -0.00358 0.03918 0.00275 0.04301 -0.04237 ...</span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">fit_SurfaceExposure</span><span class="op">(</span></span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="va">set_2</span>,</span></span>
<span class="r-in"><span> age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e2</span>, <span class="fl">1e3</span>, <span class="fl">1e4</span>, <span class="fl">1e5</span>, <span class="fl">1e6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> sigmaphi <span class="op">=</span> <span class="fl">5e-10</span>,</span></span>
<span class="r-in"><span> Ddot <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span> D0 <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_SurfaceExposure-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [fit_SurfaceExposure()] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Shared estimated parameter(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  mu:		 0.899 ± 0.00232 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Fixed parameter(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  age (a):	 100, 1000, 10000, 1e+05, 1e+06 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  sigmaphi:	 5e-10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> To apply the estimated parameters to a sample of unknown age run:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> fit_SurfaceExposure(data = set_2, sigmaphi = 5e-10, mu = c(0.899, 0.899, 0.899, 0.899, 0.899))</span>
<span class="r-in"><span><span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     age age_error sigmaphi sigmaphi_error        mu    mu_error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1e+02        NA    5e-10             NA 0.8986586 0.002323746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1e+03        NA    5e-10             NA 0.8986586 0.002323746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1e+04        NA    5e-10             NA 0.8986586 0.002323746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1e+05        NA    5e-10             NA 0.8986586 0.002323746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1e+06        NA    5e-10             NA 0.8986586 0.002323746</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo, Luc Steinbuch, Anna-Maartje de Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

