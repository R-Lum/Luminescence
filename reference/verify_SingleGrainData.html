<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Verify single grain data sets and check for invalid grains, i.e. zero-light level grains — verify_SingleGrainData • Luminescence</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Verify single grain data sets and check for invalid grains, i.e. zero-light level grains — verify_SingleGrainData"><meta name="description" content="This function tries to identify automatically zero-light level curves (grains)
from single grain data measurements."><meta property="og:description" content="This function tries to identify automatically zero-light level curves (grains)
from single grain data measurements."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Verify single grain data sets and check for invalid grains, i.e. zero-light level grains</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/master/R/verify_SingleGrainData.R" class="external-link"><code>R/verify_SingleGrainData.R</code></a></small>
      <div class="d-none name"><code>verify_SingleGrainData.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function tries to identify automatically zero-light level curves (grains)
from single grain data measurements.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">verify_SingleGrainData</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  use_fft <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cleanup <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cleanup_level <span class="op">=</span> <span class="st">"aliquot"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><a href="Risoe.BINfileData-class.html">Risoe.BINfileData</a> or <a href="RLum.Analysis-class.html">RLum.Analysis</a> (<strong>required</strong>):
input object. The function also accepts a list with objects of allowed type.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
numeric threshold value for the allowed difference between the <code>mean</code> and
the <code>var</code> of the count values (see details)</p></dd>


<dt id="arg-use-fft">use_fft<a class="anchor" aria-label="anchor" href="#arg-use-fft"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>): applies an additional approach based on <a href="https://rdrr.io/r/stats/fft.html" class="external-link">stats::fft</a>.
The threshold is fixed and cannot be changed.</p></dd>


<dt id="arg-cleanup">cleanup<a class="anchor" aria-label="anchor" href="#arg-cleanup"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
if set to <code>TRUE</code>, curves/aliquots identified as zero light level curves/aliquots are
automatically removed. Output is an object as same type as the input, i.e.
either <a href="Risoe.BINfileData-class.html">Risoe.BINfileData</a> or <a href="RLum.Analysis-class.html">RLum.Analysis</a></p></dd>


<dt id="arg-cleanup-level">cleanup_level<a class="anchor" aria-label="anchor" href="#arg-cleanup-level"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
selects the level for the clean-up of the input data sets.
Two options are allowed: <code>"curve"</code> or <code>"aliquot"</code>:</p><ul><li><p>If  <code>"curve"</code> is selected, every single curve marked as <code>invalid</code> is removed.</p></li>
<li><p>If <code>"aliquot"</code> is selected, curves of one aliquot (grain or disc) can be
marked as invalid, but will not be removed. An aliquot will be only removed
if all curves of this aliquot are marked as invalid.</p></li>
</ul></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disables output to the terminal.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disable the plot output.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further parameters to control the plot output; if selected.
Supported arguments <code>main</code>, <code>ylim</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns</p>
<p>———————————–<br><code>[ NUMERICAL OUTPUT ]</code><br>
———————————–<br></p>
<p><strong><code>RLum.Results</code></strong>-object</p>
<p><strong>slot:****<code>@data</code></strong></p>
<table class="table table"><tr><td><strong>Element</strong></td><td><strong>Type</strong></td><td><strong>Description</strong></td></tr><tr><td><code>$unique_pairs</code></td><td><code>data.frame</code></td><td>the unique position and grain pairs</td></tr><tr><td><code>$selection_id</code></td><td><code>numeric</code></td><td>the selection as record ID</td></tr><tr><td><code>$selection_full</code></td><td><code>data.frame</code></td><td>implemented models used in the baSAR-model core</td></tr></table><p><strong>slot:****<code>@info</code></strong></p>
<p>The original function call</p>
<p><strong>Output variation</strong></p>
<p>For <code>cleanup = TRUE</code> the same object as the input is returned, but cleaned up
(invalid curves were removed). This means: Either a <a href="Risoe.BINfileData-class.html">Risoe.BINfileData</a>
or an <a href="RLum.Analysis-class.html">RLum.Analysis</a> object is returned in such cases.
A <a href="Risoe.BINfileData-class.html">Risoe.BINfileData</a> object can be exported to a BINX-file by
using the function <a href="write_R2BIN.html">write_R2BIN</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>How does the method work?</strong></p>
<p>The function compares the expected values (\(E(X)\)) and the variance
(\(Var(X)\)) of the count values for each curve. Assuming that the
background roughly follows a Poisson distribution, the absolute difference
of both values should be zero or at least around zero as</p>
<p>$$E(x) = Var(x) = \lambda$$</p>
<p>Thus the function checks for:</p>
<p>$$abs(E(x) - Var(x)) &gt;= \Theta$$</p>
<p>With \(\Theta\) an arbitrary, user defined, threshold. Values above the
threshold indicate curves comprising a signal.</p>
<p>Note: the absolute difference of \(E(X)\) and \(Var(x)\) instead of the
ratio was chosen as both terms can become 0 which would result in 0 or <code>Inf</code>,
if the ratio is calculated.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function can work with <a href="Risoe.BINfileData-class.html">Risoe.BINfileData</a> objects or
<a href="RLum.Analysis-class.html">RLum.Analysis</a> objects (or a list of it). However, the function is
highly optimised for <a href="Risoe.BINfileData-class.html">Risoe.BINfileData</a> objects as it make sense to
remove identify invalid grains before the conversion to an
<a href="RLum.Analysis-class.html">RLum.Analysis</a> object.</p>
<p>The function checking for invalid curves works rather robust and it is likely
that Reg0 curves within a SAR cycle are removed as well. Therefore it is
strongly recommended to use the argument <code>cleanup = TRUE</code> carefully if
the cleanup works only on curves.</p>
    </div>
    <div class="section level2">
    <h2 id="function-version">Function version<a class="anchor" aria-label="anchor" href="#function-version"></a></h2>
    <p>0.2.5</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="Risoe.BINfileData-class.html">Risoe.BINfileData</a>, <a href="RLum.Analysis-class.html">RLum.Analysis</a>, <a href="write_R2BIN.html">write_R2BIN</a>,
<a href="read_BIN2R.html">read_BIN2R</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##01 - basic example I</span></span></span>
<span class="r-in"><span><span class="co">##just show how to apply the function</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.XSYG</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##verify and get data.frame out of it</span></span></span>
<span class="r-in"><span><span class="fu">verify_SingleGrainData</span><span class="op">(</span><span class="va">OSL.SARMeasurement</span><span class="op">$</span><span class="va">Sequence.Object</span><span class="op">)</span><span class="op">$</span><span class="va">selection_full</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>[verify_SingleGrainData()] 'selection_id' is NA, everything tagged for removal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     POSITION GRAIN      MEAN          VAR       RATIO THRESHOLD VALID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         NA    NA  23.66271 2.572619e+02   10.872037        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         NA    NA 146.85632 4.982419e+03   33.927165        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         NA    NA  23.20000 4.901230e+03  211.259934        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6         NA    NA 107.87043 7.125950e+02    6.606027        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7         NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8         NA    NA  27.06067 3.495743e+02   12.918172        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9         NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10        NA    NA 111.65882 2.120132e+04  189.875911        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11        NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12        NA    NA  94.00808 1.421120e+03   15.117001        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13        NA    NA  14.78800 1.018989e+02    6.890645        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15        NA    NA 107.90087 7.100111e+02    6.580216        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17        NA    NA  26.88278 3.521022e+02   13.097686        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19        NA    NA 203.04576 1.440995e+05  709.689721        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20        NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21        NA    NA 147.35434 4.941044e+03   33.531721        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22        NA    NA  18.48800 1.309212e+03   70.814165        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24        NA    NA 107.37241 7.180268e+02    6.687256        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26        NA    NA  26.53464 3.569946e+02   13.453909        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28        NA    NA 149.22647 4.077393e+04  273.235223        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29        NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30        NA    NA  93.65100 1.425739e+03   15.223959        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31        NA    NA  15.43400 1.468754e+02    9.516353        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33        NA    NA 107.74087 7.151408e+02    6.637600        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35        NA    NA  26.88278 3.521553e+02   13.099660        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37        NA    NA 437.18390 7.404312e+05 1693.637907        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38        NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39        NA    NA 146.74713 4.976541e+03   33.912357        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40        NA    NA  26.99200 8.015916e+03  296.973761        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42        NA    NA 107.87652 7.046340e+02    6.531857        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44        NA    NA  26.88079 3.520762e+02   13.097687        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46        NA    NA 183.18088 6.418055e+04  350.367102        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47        NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48        NA    NA  94.05556 1.416457e+03   15.059791        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49        NA    NA  16.43000 2.741815e+02   16.687855        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51        NA    NA 108.64071 6.910736e+02    6.361093        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53        NA    NA  27.62109 3.416066e+02   12.367601        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55        NA    NA 693.53644 1.868981e+06 2694.856789        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56        NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57        NA    NA 146.77471 4.985033e+03   33.963838        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58        NA    NA  41.61400 3.277204e+04  787.524417        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60        NA    NA 107.84087 7.062001e+02    6.548538        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62        NA    NA  26.89205 3.523737e+02   13.103264        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64        NA    NA 229.96912 1.033205e+05  449.279678        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65        NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66        NA    NA  94.09293 1.419207e+03   15.083033        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67        NA    NA  17.54000 4.446938e+02   25.353124        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69        NA    NA 107.82348 7.152073e+02    6.633131        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71        NA    NA  26.88212 3.521107e+02   13.098323        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73        NA    NA 919.37203 3.298185e+06 3587.432532        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74        NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75        NA    NA 146.25829 4.992561e+03   34.135236        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76        NA    NA  55.33200 7.126496e+04 1287.951921        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78        NA    NA 107.44397 7.226060e+02    6.725422        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80        NA    NA  26.70197 3.544455e+02   13.274131        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82        NA    NA 278.14412 1.553639e+05  558.573294        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83        NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84        NA    NA  94.03131 1.419523e+03   15.096277        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85        NA    NA  20.75400 7.620376e+02   36.717624        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87        NA    NA 108.72566 6.921674e+02    6.366182        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89        NA    NA  27.60612 3.412339e+02   12.360804        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90        NA    NA  15.83136 4.363311e+01    2.756120        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91        NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92        NA    NA 146.50230 4.921485e+03   33.593229        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93        NA    NA  13.75400 2.191331e+01    1.593232        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94        NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95        NA    NA 108.25351 6.988567e+02    6.455741        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96        NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97        NA    NA  27.23758 3.468351e+02   12.733694        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98        NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99        NA    NA 296.30735 1.763985e+05  595.322619        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100       NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101       NA    NA  93.99192 1.420900e+03   15.117255        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102       NA    NA  19.43600 8.624027e+02   44.371409        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103       NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104       NA    NA 107.82174 7.110169e+02    6.594375        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105       NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106       NA    NA  26.88344 3.521723e+02   13.099971        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107       NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108       NA    NA 532.60085 1.130401e+06 2122.416765        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109       NA    NA 133.00000 1.364500e+04  102.593985        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110       NA    NA 146.72471 4.962003e+03   33.818454        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111       NA    NA  27.52000 7.629970e+03  277.251800        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112       NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113       NA    NA 107.92696 7.062523e+02    6.543799        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114       NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115       NA    NA  26.87815 3.520057e+02   13.096354        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116       NA    NA   1.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117       NA    NA 302.94412 1.862969e+05  614.954596        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118       NA    NA  76.25000 3.389583e+03   44.453552        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119       NA    NA  94.41327 1.419383e+03   15.033721        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120       NA    NA  20.19800 8.579387e+02   42.476417        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121       NA    NA  79.00000 1.967500e+03   24.905063        10  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122       NA    NA 108.15702 6.957128e+02    6.432433        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123       NA    NA  40.00000 0.000000e+00    0.000000        10 FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124       NA    NA  27.24765 3.470933e+02   12.738468        10  TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##02 - basic example II</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.BINfileData</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu">verify_SingleGrainData</span><span class="op">(</span>object <span class="op">=</span> <span class="va">CWOSL.SAR.Data</span>,</span></span>
<span class="r-in"><span>cleanup_level <span class="op">=</span> <span class="st">"aliquot"</span><span class="op">)</span><span class="op">$</span><span class="va">selection_id</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">##03 - advanced example I</span></span></span>
<span class="r-in"><span><span class="co">##importing and exporting a BIN-file</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##select and import file</span></span></span>
<span class="r-in"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_BIN2R.html">read_BIN2R</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##remove invalid aliquots(!)</span></span></span>
<span class="r-in"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu">verify_SingleGrainData</span><span class="op">(</span><span class="va">object</span>, cleanup <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##export to new BIN-file</span></span></span>
<span class="r-in"><span><span class="fu"><a href="write_R2BIN.html">write_R2BIN</a></span><span class="op">(</span><span class="va">object</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span>,<span class="st">"/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span>, <span class="st">"_CLEANED.BIN"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo, Luc Steinbuch, Anna-Maartje de Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

