<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Moran Scatter Plot: Visualizing Spatial Dependency — plot_MoranScatterplot • Luminescence</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Moran Scatter Plot: Visualizing Spatial Dependency — plot_MoranScatterplot"><meta name="description" content="Scatter plot, with on the x axis the original grain signal and on the y axis
the weighted mean of the neighbour grain signals. The plot area is divided into four quadrants,
and also a least square line (which slopes indicates, but not exactly represents, Moran's I) and
an 1:1 line (which indicates a Moran's I of around 1)."><meta property="og:description" content="Scatter plot, with on the x axis the original grain signal and on the y axis
the weighted mean of the neighbour grain signals. The plot area is divided into four quadrants,
and also a least square line (which slopes indicates, but not exactly represents, Moran's I) and
an 1:1 line (which indicates a Moran's I of around 1)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Moran Scatter Plot: Visualizing Spatial Dependency</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/master/R/plot_MoranScatterplot.R" class="external-link"><code>R/plot_MoranScatterplot.R</code></a></small>
      <div class="d-none name"><code>plot_MoranScatterplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Scatter plot, with on the x axis the original grain signal and on the y axis
the weighted mean of the neighbour grain signals. The plot area is divided into four quadrants,
and also a least square line (which slopes indicates, but not exactly represents, Moran's I) and
an 1:1 line (which indicates a Moran's I of around 1).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_MoranScatterplot</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  df_neighbours <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  str_y_def <span class="op">=</span> <span class="st">"mean_neighbours"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><a href="RLum.Results-class.html">RLum.Results</a> or <a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>): containing a numerical vector of length 100,
representing one or more measurement discs ("positions") in a reader.
Each element in the vector represents one grain hole location on a disc.</p></dd>


<dt id="arg-df-neighbours">df_neighbours<a class="anchor" aria-label="anchor" href="#arg-df-neighbours"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<em>with default</em>) Data frame indicating
which borders to consider, and their respective weights (see the description
provided for <a href="calc_MoransI.html">calc_MoransI</a>). If <code>NULL</code> (default), this is constructed
automatically by the internal function <code>.get_Neighbours</code>.</p></dd>


<dt id="arg-str-y-def">str_y_def<a class="anchor" aria-label="anchor" href="#arg-str-y-def"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>) Calculation of y position. Defaults to <code>"mean_neighbours"</code>
which is the plain mean of all neighbour values and the most illustrative. The other option is <code>"weighted_sum"</code>,
which means the sum of the border weights times the neighbour values, which is actually closer
to the way Moran's I is by default calculated in this package.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters to be forwarded to the base R plot functions.
<code>legend</code> (<code>TRUE/FALSE</code>) to enable/disable the legend.
Note that <code>xlab</code> (x axis label), <code>ylab</code> (y axis label) and <code>cex</code> (scaling
value) are given default values. Because of sometimes large value
differences, <code>log = "x"</code>, <code>log = "y"</code> and <code>log = "xy"</code>are supported.
In case of negative values and logarithmic plotting, values are increased
so the smallest value to plot is 1. Summary elements such as means, least
square line etc. will still be based on the linear case.
<code>pch</code> accepts options "show_location_ids"<code>(plots grain location id's),</code>"show_n_neighbours"<code>(indicates numbers of neighbours) and the normal base plot</code>pch` options.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns (invisibly) a data frame with plotting coordinates and
grain location id's, for creating user-defined plots.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that this function plots on the y-axis the mean of the neighbours, while the function
<a href="calc_MoransI.html">calc_MoransI</a> by default will for its global calculation weight every border the same. So, grain locations
with 1, 2 or 3 neighbours will appear higher on the y-axis than their influence on Moran's I justify – apart
from scaling, this explains a part of the differences of Moran's scatter plots between different packages.
Also note that island' grain locations (=those not bordering other grains) are left out of these plots but
might still influence Moran's I calculations.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>de Boer, A-M., Steinbuch, L., Heuvelink, G.B.M., Wallinga, J., 2025.
A novel tool to assess crosstalk in single-grain luminescence detection.
Submitted.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Anna-Maartje de Boer, Luc Steinbuch, Wageningen University &amp; Research, 2025</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">plot_MoranScatterplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_MoranScatterplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo, Luc Steinbuch, Anna-Maartje de Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

