<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fitting Thermal Quenching Data — fit_ThermalQuenching • Luminescence</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting Thermal Quenching Data — fit_ThermalQuenching"><meta name="description" content="Applying a nls-fitting to thermal quenching data."><meta property="og:description" content="Applying a nls-fitting to thermal quenching data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fitting Thermal Quenching Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/v1.0.1/R/fit_ThermalQuenching.R" class="external-link"><code>R/fit_ThermalQuenching.R</code></a></small>
      <div class="d-none name"><code>fit_ThermalQuenching.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Applying a nls-fitting to thermal quenching data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_ThermalQuenching</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  start_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  method_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  n.MC <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<strong>required</strong>): input data with three columns, the first column contains
temperature values in deg. C, columns 2 and 3 the dependent values with its error</p></dd>


<dt id="arg-start-param">start_param<a class="anchor" aria-label="anchor" href="#arg-start-param"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> (<em>optional</em>): option to provide the start
parameters for the fitting, see details</p></dd>


<dt id="arg-method-control">method_control<a class="anchor" aria-label="anchor" href="#arg-method-control"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> (<em>optional</em>): further options to fine tune
the fitting, see details for
further information</p></dd>


<dt id="arg-n-mc">n.MC<a class="anchor" aria-label="anchor" href="#arg-n-mc"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>): number of Monte Carlo runs for the error estimation. If <code>n.MC</code> is
<code>NULL</code> or <code>&lt;=1</code>, the error estimation is skipped</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>): enable/disable output to the
terminal.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>): enable/disable the plot output.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments that can be passed to control the plotting, support are <code>main</code>, <code>pch</code>,
<code>col_fit</code>, <code>col_points</code>, <code>lty</code>, <code>lwd</code>, <code>xlab</code>, <code>ylab</code>, <code>xlim</code>, <code>ylim</code>, <code>xaxt</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns numerical output and an (<em>optional</em>) plot.</p>
<p>———————————–<br><code>[ NUMERICAL OUTPUT ]</code><br>
———————————–<br></p>
<p><strong><code>RLum.Results</code></strong>-object</p>
<p><strong>slot:</strong> <strong><code>@data</code></strong></p>
<p><code>[.. $data : data.frame]</code><br></p>
<p>A table with all fitting parameters and the number of Monte Carlo runs used for the error estimation.</p>
<p><code>[.. $fit : nls object]</code> <br></p>
<p>The nls <a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls</a> object returned by the function <a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a>. This object
can be further passed to other functions supporting an nls object (cf. details section
in <a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls</a>)</p>
<p><strong>slot:</strong> <strong><code>@info</code></strong></p>
<p><code>[.. $call : call]</code><br></p>
<p>The original function call.</p>
<p>———————————–<br><code>[ GAPHICAL OUTPUT ]</code><br>
———————————–<br></p>
<p>Plotted are temperature against the signal and their uncertainties.
The fit is shown as dashed-line (can be modified). Please note that for the fitting the absolute
temperature values are used but are re-calculated to deg. C for the plot.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Used equation</strong><br></p>
<p>The equation used for the fitting is</p>
<p>$$y = (A / (1 + C * (exp(-W / (k * x))))) + c$$</p>
<p><em>W</em> is the energy depth in eV and <em>C</em> is dimensionless constant. <em>A</em> and <em>c</em> are used to
adjust the curve for the given signal. <em>k</em> is the Boltzmann in eV/K and <em>x</em> is the absolute
temperature in K.</p>
<p><strong>Error estimation</strong><br></p>
<p>The error estimation is done be varying the input parameters using the given uncertainties in
a Monte Carlo simulation. Errors are assumed to follow a normal distribution.</p>
<p><strong><code>start_param</code></strong> <br></p>
<p>The function allows the injection of own start parameters via the argument <code>start_param</code>. The
parameters needs to be provided as names list. The names are the parameters to be optimised.
Examples: <code>start_param = list(A = 1, C = 1e+5, W = 0.5, c = 0)</code></p>
<p><strong><code>method_control</code></strong> <br></p>
<p>The following arguments can be provided via <code>method_control</code>. Please note that arguments provided
via <code>method_control</code> are not further tested, i.e., if the function crashes your input was probably
wrong.</p>
<table class="table table"><tr><td><strong>ARGUMENT</strong></td><td><strong>TYPE</strong></td><td><strong>DESCRIPTION</strong></td></tr><tr><td><code>upper</code></td><td>named <a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></td><td>sets upper fitting boundaries, if provided boundaries for all arguments
are required, e.g., <code>c(A = 0, C = 0, W = 0, c = 0)</code></td></tr><tr><td><code>lower</code></td><td>names <a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></td><td>set lower fitting boundaries (see <code>upper</code> for details)</td></tr><tr><td><code>trace</code></td><td><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></td><td>enable/disable progression trace for <a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a></td></tr><tr><td><code>weights</code></td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>option to provide own weights for the fitting, the length of this
vector needs to be equal to the number for rows of the input <code>data.frame</code>. If set to <code>NULL</code> no weights
are applied. The weights are defined by the third column of the input <code>data.frame</code>.</td></tr></table></div>
    <div class="section level2">
    <h2 id="function-version">Function version<a class="anchor" aria-label="anchor" href="#function-version"></a></h2>
    <p>0.1.0</p>
    </div>
    <div class="section level2">
    <h2 id="how-to-cite">How to cite<a class="anchor" aria-label="anchor" href="#how-to-cite"></a></h2>
    <p>Kreutzer, S., 2025. fit_ThermalQuenching(): Fitting Thermal Quenching Data. Function version 0.1.0. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., Colombo, M., Steinbuch, L., Boer, A.d., 2025. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 1.0.1. https://r-lum.github.io/Luminescence/</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Wintle, A.G., 1975. Thermal Quenching of Thermoluminescence in Quartz. Geophys. J. R. astr. Soc. 41, 107–113.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)
, RLum Developer Team</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##create short example dataset</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  T <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span>, <span class="fl">70</span>, <span class="fl">80</span>, <span class="fl">90</span>, <span class="fl">100</span>, <span class="fl">110</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.06</span>, <span class="fl">0.058</span>, <span class="fl">0.052</span>, <span class="fl">0.051</span>, <span class="fl">0.041</span>, <span class="fl">0.034</span>, <span class="fl">0.035</span>, <span class="fl">0.033</span>, <span class="fl">0.032</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  V_X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.012</span>, <span class="fl">0.009</span>, <span class="fl">0.008</span>, <span class="fl">0.008</span>, <span class="fl">0.007</span>, <span class="fl">0.006</span>, <span class="fl">0.005</span>, <span class="fl">0.005</span>, <span class="fl">0.004</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##fit</span></span></span>
<span class="r-in"><span><span class="fu">fit_ThermalQuenching</span><span class="op">(</span></span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span> n.MC <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [fit_ThermalQuenching()]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A =  0.02831547  ±  NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  C =  8.67841e+14  ±  NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  W =  0.9986941  ±  NA  eV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  c =  0.0315122  ±  NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  --------------------------------</span>
<span class="r-plt img"><img src="fit_ThermalQuenching-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [RLum.Results-class]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 originator: fit_ThermalQuenching()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 data: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  	 .. $data : data.frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 .. $fit : nls</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 additional info elements:  1 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo, Luc Steinbuch, Anna-Maartje de Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

