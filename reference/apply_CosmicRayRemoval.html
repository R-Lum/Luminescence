<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Function to remove cosmic rays from an RLum.Data.Spectrum S4 class object — apply_CosmicRayRemoval • Luminescence</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function to remove cosmic rays from an RLum.Data.Spectrum S4 class object — apply_CosmicRayRemoval"><meta name="description" content="The function provides several methods for cosmic-ray removal and spectrum
smoothing for RLum.Data.Spectrum objects, and those embedded in
list or RLum.Analysis objects."><meta property="og:description" content="The function provides several methods for cosmic-ray removal and spectrum
smoothing for RLum.Data.Spectrum objects, and those embedded in
list or RLum.Analysis objects."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Function to remove cosmic rays from an RLum.Data.Spectrum S4 class object</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/archive/dev_1.1.0/R/apply_CosmicRayRemoval.R" class="external-link"><code>R/apply_CosmicRayRemoval.R</code></a></small>
      <div class="d-none name"><code>apply_CosmicRayRemoval.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function provides several methods for cosmic-ray removal and spectrum
smoothing for <a href="RLum.Data.Spectrum-class.html">RLum.Data.Spectrum</a> objects, and those embedded in
<a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> or <a href="RLum.Analysis-class.html">RLum.Analysis</a> objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">apply_CosmicRayRemoval</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"smooth"</span>,</span>
<span>  method.Pych.smoothing <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  method.Pych.threshold_factor <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  MARGIN <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><a href="RLum.Data.Spectrum-class.html">RLum.Data.Spectrum</a> or <a href="RLum.Analysis-class.html">RLum.Analysis</a> (<strong>required</strong>): input
object to be treated. This can be also provided as <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a>. If an <a href="RLum.Analysis-class.html">RLum.Analysis</a> object
is provided, only the <a href="RLum.Data.Spectrum-class.html">RLum.Data.Spectrum</a> objects are treated. Please note: this mixing of
objects does not work for a list of <code>RLum.Data</code> objects.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
Defines method that is applied for cosmic ray removal. Allowed methods are
<code>smooth</code>, the default, (<a href="https://rdrr.io/r/stats/smooth.html" class="external-link">stats::smooth</a>), <code>smooth.spline</code> (<a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">stats::smooth.spline</a>),
<code>smooth_RLum</code> (<a href="smooth_RLum.html">smooth_RLum</a>) and <code>Pych</code>. See details for further information.</p></dd>


<dt id="arg-method-pych-smoothing">method.Pych.smoothing<a class="anchor" aria-label="anchor" href="#arg-method-pych-smoothing"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
Smoothing parameter for cosmic ray removal according to Pych (2003).
The value defines how many neighbouring values in each frame are used for smoothing
(e.g., <code>2</code> means that the two previous and two following values are used).</p></dd>


<dt id="arg-method-pych-threshold-factor">method.Pych.threshold_factor<a class="anchor" aria-label="anchor" href="#arg-method-pych-threshold-factor"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
Threshold for zero-bins in the histogram. Small values mean that more peaks
are removed, but signal might be also affected by this removal.</p></dd>


<dt id="arg-margin">MARGIN<a class="anchor" aria-label="anchor" href="#arg-margin"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
on which part the function cosmic ray removal should be applied on:</p><ul><li><p>1 = along the time axis (line by line),</p></li>
<li><p>2 = along the wavelength axis (column by column).</p></li>
</ul><p><strong>Note:</strong> This argument currently only affects the methods <code>smooth</code> and <code>smooth.spline</code></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disable output to the terminal.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
If <code>TRUE</code> the histograms used for the cosmic-ray removal are returned as plot
including the used threshold. Note: A separate plot is returned for each frame!
Currently only for <code>method = "Pych"</code> a graphical output is provided.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments and graphical parameters that will be passed
to the <a href="https://rdrr.io/r/stats/smooth.html" class="external-link">stats::smooth</a>, <a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">stats::smooth.spline</a> or <a href="smooth_RLum.html">smooth_RLum</a>. See details for more
information.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns same object as input.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong><code>method = "Pych"</code></strong></p>
<p>This method applies the cosmic-ray removal algorithm described by Pych
(2003). There are some differences with respect to the publication:</p><ul><li><p>For interpolation between neighbouring values the median is used instead
of the mean.</p></li>
<li><p>The number of breaks in the histogram is set to half the number of the
input values.</p></li>
</ul><p>For further details see references below.</p>
<p><strong>Other methods</strong>
Arguments supported through <code>...</code></p><table class="table table"><tr><td>METHOD</td><td>ARGUMENT</td><td>TYPE</td><td>REMARKS</td></tr><tr><td><code>"smooth"</code></td><td><code>kind</code></td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>see <a href="https://rdrr.io/r/stats/smooth.html" class="external-link">stats::smooth</a></td></tr><tr><td></td><td><code>twiceit</code></td><td><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></td><td>see <a href="https://rdrr.io/r/stats/smooth.html" class="external-link">stats::smooth</a></td></tr><tr><td><code>"smooth.spline"</code></td><td><code>spar</code></td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>see <a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">stats::smooth.spline</a></td></tr><tr><td><code>"smooth_RLum"</code></td><td><code>k</code></td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>see <a href="smooth_RLum.html">smooth_RLum</a></td></tr><tr><td></td><td><code>fill</code></td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>see <a href="smooth_RLum.html">smooth_RLum</a></td></tr><tr><td></td><td><code>align</code></td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>see <a href="smooth_RLum.html">smooth_RLum</a></td></tr><tr><td></td><td><code>method</code></td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>see <a href="smooth_RLum.html">smooth_RLum</a></td></tr></table><p><strong>Best practice</strong></p>
<p>There is no single silver-bullet strategy for cosmic-ray removal, as it depends
on the characteristic of the detector and the chosen settings. For instance,
high values for pixel binning will improve the light output, but also cause
multiple pixels being affected by a single cosmic-ray. The same is valid for
longer integration times. The best strategy is to combine methods and ensure
that the spectrum is not distorted on a case-to-case basis.</p>
<p><strong>How to combine methods?</strong></p>
<p>Different methods can be combined by applying the method repeatedly to the
dataset (see example).</p>
    </div>
    <div class="section level2">
    <h2 id="function-version">Function version<a class="anchor" aria-label="anchor" href="#function-version"></a></h2>
    <p>0.4.0</p>
    </div>
    <div class="section level2">
    <h2 id="how-to-cite">How to cite<a class="anchor" aria-label="anchor" href="#how-to-cite"></a></h2>
    <p>Kreutzer, S., 2025. apply_CosmicRayRemoval(): Function to remove cosmic rays from an RLum.Data.Spectrum S4 class object. Function version 0.4.0. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., Colombo, M., Steinbuch, L., Boer, A.d., 2025. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 1.1.0. https://r-lum.github.io/Luminescence/</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Pych, W., 2004. A Fast Algorithm for Cosmic-Ray Removal from
Single Images. The Astronomical Society of the Pacific 116 (816), 148-153.
<a href="https://doi.org/10.1086/381786" class="external-link">doi:10.1086/381786</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="RLum.Data.Spectrum-class.html">RLum.Data.Spectrum</a>, <a href="RLum.Analysis-class.html">RLum.Analysis</a>, <a href="https://rdrr.io/r/stats/smooth.html" class="external-link">stats::smooth</a>, <a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">stats::smooth.spline</a>,
<a href="smooth_RLum.html">smooth_RLum</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)
, RLum Developer Team</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(1) - use with your own data and combine (uncomment for usage)</span></span></span>
<span class="r-in"><span><span class="co">## run two times the default method and smooth with another method</span></span></span>
<span class="r-in"><span><span class="co">## your.spectrum &lt;- apply_CosmicRayRemoval(your.spectrum, method = "Pych")</span></span></span>
<span class="r-in"><span><span class="co">## your.spectrum &lt;- apply_CosmicRayRemoval(your.spectrum, method = "Pych")</span></span></span>
<span class="r-in"><span><span class="co">## your.spectrum &lt;- apply_CosmicRayRemoval(your.spectrum, method = "smooth")</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo, Luc Steinbuch, Anna-Maartje de Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

