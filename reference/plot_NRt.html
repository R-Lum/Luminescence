<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Visualise natural/regenerated signal ratios — plot_NRt • Luminescence</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualise natural/regenerated signal ratios — plot_NRt"><meta name="description" content="This function creates a Natural/Regenerated signal vs. time (NR(t)) plot
as shown in Steffen et al. 2009.
This function accepts the individual curve data in many different formats. If
data is a list, each element of the list must contain a two
column data.frame or matrix containing the XY data of the curves
(time and counts). Alternatively, the elements can be objects of class
RLum.Data.Curve.
Input values can also be provided as a data.frame or matrix where
the first column contains the time values and each following column contains
the counts of each curve."><meta property="og:description" content="This function creates a Natural/Regenerated signal vs. time (NR(t)) plot
as shown in Steffen et al. 2009.
This function accepts the individual curve data in many different formats. If
data is a list, each element of the list must contain a two
column data.frame or matrix containing the XY data of the curves
(time and counts). Alternatively, the elements can be objects of class
RLum.Data.Curve.
Input values can also be provided as a data.frame or matrix where
the first column contains the time values and each following column contains
the counts of each curve."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visualise natural/regenerated signal ratios</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/v1.0.0/R/plot_NRt.R" class="external-link"><code>R/plot_NRt.R</code></a></small>
      <div class="d-none name"><code>plot_NRt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates a Natural/Regenerated signal vs. time (NR(t)) plot
as shown in Steffen et al. 2009.</p>
<p>This function accepts the individual curve data in many different formats. If
<code>data</code> is a <code>list</code>, each element of the list must contain a two
column <code>data.frame</code> or <code>matrix</code> containing the <code>XY</code> data of the curves
(time and counts). Alternatively, the elements can be objects of class
<a href="RLum.Data.Curve-class.html">RLum.Data.Curve</a>.</p>
<p>Input values can also be provided as a <code>data.frame</code> or <code>matrix</code> where
the first column contains the time values and each following column contains
the counts of each curve.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_NRt</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  smooth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"spline"</span>, <span class="st">"rmean"</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legend.pos <span class="op">=</span> <span class="st">"topright"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a>, <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a>, <a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a> or <a href="RLum.Analysis-class.html">RLum.Analysis</a> (<strong>required</strong>):
X,Y data of measured values (time and counts). See details on individual data structure.</p></dd>


<dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>optional</em>):
logarithmic axes (<code>c("x", "y", "xy")</code>).</p></dd>


<dt id="arg-smooth">smooth<a class="anchor" aria-label="anchor" href="#arg-smooth"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
apply data smoothing. If <code>"none"</code> (default), no data smoothing is applied.
Use <code>"rmean"</code> to calculate the rolling mean, where <code>k</code> determines the
width of the rolling window (see <a href="https://rdrr.io/pkg/data.table/man/froll.html" class="external-link">data.table::frollmean</a>). <code>"spline"</code>
applies a smoothing spline to each curve (see <a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">stats::smooth.spline</a>)</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
integer width of the rolling window.</p></dd>


<dt id="arg-legend">legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disable the plot legend.</p></dd>


<dt id="arg-legend-pos">legend.pos<a class="anchor" aria-label="anchor" href="#arg-legend-pos"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
keyword specifying the position of the legend (see <a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a>).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further parameters passed to <a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a> (also see <a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a plot and <a href="RLum.Analysis-class.html">RLum.Analysis</a> object.</p>
    </div>
    <div class="section level2">
    <h2 id="how-to-cite">How to cite<a class="anchor" aria-label="anchor" href="#how-to-cite"></a></h2>
    <p>Burow, C., 2025. plot_NRt(): Visualise natural/regenerated signal ratios. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., Colombo, M., Steinbuch, L., Boer, A.d., 2025. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 1.0.0. https://r-lum.github.io/Luminescence/</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Steffen, D., Preusser, F., Schlunegger, F., 2009. OSL quartz underestimation due to
unstable signal components. Quaternary Geochronology, 4, 353-362.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Christoph Burow, University of Cologne (Germany)
, RLum Developer Team</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## load example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ExampleData.BINfileData"</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## EXAMPLE 1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## convert Risoe.BINfileData object to RLum.Analysis object</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="Risoe.BINfileData2RLum.Analysis.html">Risoe.BINfileData2RLum.Analysis</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">CWOSL.SAR.Data</span>, pos <span class="op">=</span> <span class="fl">8</span>, ltype <span class="op">=</span> <span class="st">"OSL"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## extract all OSL curves</span></span></span>
<span class="r-in"><span><span class="va">allCurves</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## keep only the natural and regenerated signal curves</span></span></span>
<span class="r-in"><span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">curves</span> <span class="op">&lt;-</span> <span class="va">allCurves</span><span class="op">[</span><span class="va">pos</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## plot a standard NR(t) plot</span></span></span>
<span class="r-in"><span><span class="fu">plot_NRt</span><span class="op">(</span><span class="va">curves</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_NRt-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## re-plot with rolling mean data smoothing</span></span></span>
<span class="r-in"><span><span class="fu">plot_NRt</span><span class="op">(</span><span class="va">curves</span>, smooth <span class="op">=</span> <span class="st">"rmean"</span>, k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_NRt-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## re-plot with a logarithmic x-axis</span></span></span>
<span class="r-in"><span><span class="fu">plot_NRt</span><span class="op">(</span><span class="va">curves</span>, log <span class="op">=</span> <span class="st">"x"</span>, smooth <span class="op">=</span> <span class="st">"rmean"</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_NRt-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## re-plot with custom axes ranges</span></span></span>
<span class="r-in"><span><span class="fu">plot_NRt</span><span class="op">(</span><span class="va">curves</span>, smooth <span class="op">=</span> <span class="st">"rmean"</span>, k <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>         xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">1.6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         legend.pos <span class="op">=</span> <span class="st">"bottomleft"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_NRt-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## re-plot with smoothing spline on log scale</span></span></span>
<span class="r-in"><span><span class="fu">plot_NRt</span><span class="op">(</span><span class="va">curves</span>, smooth <span class="op">=</span> <span class="st">"spline"</span>, log <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>         legend.pos <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_NRt-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## EXAMPLE 2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># you may also use this function to check whether all</span></span></span>
<span class="r-in"><span><span class="co"># TD curves follow the same shape (making it a TnTx(t) plot).</span></span></span>
<span class="r-in"><span><span class="va">posTD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">14</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">curves</span> <span class="op">&lt;-</span> <span class="va">allCurves</span><span class="op">[</span><span class="va">posTD</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_NRt</span><span class="op">(</span><span class="va">curves</span>, main <span class="op">=</span> <span class="st">"TnTx(t) Plot"</span>,</span></span>
<span class="r-in"><span>         smooth <span class="op">=</span> <span class="st">"rmean"</span>, k <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>         ylab <span class="op">=</span> <span class="st">"TD natural / TD regenerated"</span>,</span></span>
<span class="r-in"><span>         xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_NRt-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## EXAMPLE 3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># extract data from all positions</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">24</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">pos</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="Risoe.BINfileData2RLum.Analysis.html">Risoe.BINfileData2RLum.Analysis</a></span><span class="op">(</span><span class="va">CWOSL.SAR.Data</span>, pos <span class="op">=</span> <span class="va">pos</span>, ltype <span class="op">=</span> <span class="st">"OSL"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get individual curve data from each aliquot</span></span></span>
<span class="r-in"><span><span class="va">aliquot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">get_RLum</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># set graphical parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create NR(t) plots for all aliquots</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">aliquot</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="fu">plot_NRt</span><span class="op">(</span><span class="va">aliquot</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">pos</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>            main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Aliquot #"</span>, <span class="va">i</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            smooth <span class="op">=</span> <span class="st">"rmean"</span>, k <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>            xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">0.6</span>, legend.pos <span class="op">=</span> <span class="st">"bottomleft"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="plot_NRt-7.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_NRt-8.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_NRt-9.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_NRt-10.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_NRt-11.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot_NRt-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reset graphical parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo, Luc Steinbuch, Anna-Maartje de Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

