<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply the (un-)logged minimum age model (MAM) after Galbraith et al. (1999) to a given De distribution — calc_MinDose • Luminescence</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply the (un-)logged minimum age model (MAM) after Galbraith et al. (1999) to a given De distribution — calc_MinDose"><meta name="description" content="Function to fit the (un-)logged three or four parameter minimum dose model
(MAM-3/4) to De data."><meta property="og:description" content="Function to fit the (un-)logged three or four parameter minimum dose model
(MAM-3/4) to De data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Apply the (un-)logged minimum age model (MAM) after Galbraith et al. (1999) to a given De distribution</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/v1.0.1/R/calc_MinDose.R" class="external-link"><code>R/calc_MinDose.R</code></a></small>
      <div class="d-none name"><code>calc_MinDose.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to fit the (un-)logged three or four parameter minimum dose model
(MAM-3/4) to De data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_MinDose</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">sigmab</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  par <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">init.values</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  log.output <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  multicore <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><a href="RLum.Results-class.html">RLum.Results</a> or <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<strong>required</strong>):
for <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a>: two columns with De <code>(data[ ,1])</code> and De error <code>(data[ ,2])</code>.</p></dd>


<dt id="arg-sigmab">sigmab<a class="anchor" aria-label="anchor" href="#arg-sigmab"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>):
additional spread in De values.
This value represents the expected overdispersion in the data should the sample be
well-bleached (Cunningham &amp; Walling 2012, p. 100).
<strong>NOTE</strong>: For the logged model (<code>log = TRUE</code>) this value must be
a fraction, e.g. 0.2 (= 20 %). If the un-logged model is used (<code>log = FALSE</code>),
<code>sigmab</code> must be provided in the same absolute units of the De values (seconds or Gray).
See details.</p></dd>


<dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
fit the (un-)logged minimum dose model to De data.</p></dd>


<dt id="arg-par">par<a class="anchor" aria-label="anchor" href="#arg-par"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
apply the 3- or 4-parameter minimum age model (<code>par=3</code> or <code>par=4</code>). The MAM-3 is
used by default.</p></dd>


<dt id="arg-bootstrap">bootstrap<a class="anchor" aria-label="anchor" href="#arg-bootstrap"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
apply the recycled bootstrap approach of Cunningham &amp; Wallinga (2012).</p></dd>


<dt id="arg-init-values">init.values<a class="anchor" aria-label="anchor" href="#arg-init-values"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>optional</em>):
a named list with starting values for <code>gamma</code>, <code>sigma</code>, <code>p0</code> and <code>mu</code>
(e.g. <code>list(gamma=100, sigma=1.5, p0=0.1, mu=100)</code>). If no values are
provided, reasonable values will be estimated from the data.
<strong>NOTE</strong>: the initial values must always be given in the absolute units.
If a logged model is applied (<code>log = TRUE</code>), the provided <code>init.values</code>
are automatically log-transformed.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
the confidence level required (defaults to 0.95).</p></dd>


<dt id="arg-log-output">log.output<a class="anchor" aria-label="anchor" href="#arg-log-output"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
If <code>TRUE</code> the console output will also show the logged values of the final parameter estimates
and confidence intervals (only applicable if <code>log = TRUE</code>).</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disable the plot output.</p></dd>


<dt id="arg-multicore">multicore<a class="anchor" aria-label="anchor" href="#arg-multicore"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable parallel computation of the bootstrap by creating a multicore SNOW cluster. Depending
on the number of available logical CPU cores this may drastically reduce
the computation time. Note that this option is highly experimental and may not
work on all machines. (<code>TRUE</code>/<code>FALSE</code>)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>(<em>optional</em>) further arguments for bootstrapping
(<code>bs.M</code>, <code>bs.N</code>, <code>bs.h</code>, <code>sigmab.sd</code>). See details for their usage.
Further arguments are</p><ul><li><p><code>verbose</code> to de-/activate console output (logical),</p></li>
<li><p><code>debug</code> for extended console output (logical) and</p></li>
<li><p><code>cores</code> (integer) to manually specify the number of cores to be used when <code>multicore=TRUE</code>.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a plot (<em>optional</em>) and terminal output. In addition an
<a href="RLum.Results-class.html">RLum.Results</a> object is returned containing the
following elements:</p>
<dl><dt>$summary</dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> summary of all relevant model results.</p></dd>

<dt>$data</dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> original input data</p></dd>

<dt>$args</dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> used arguments</p></dd>

<dt>$call</dt>
<dd><p><a href="https://rdrr.io/r/base/call.html" class="external-link">call</a> the function call</p></dd>

<dt>$mle</dt>
<dd><p><a href="https://rdrr.io/pkg/bbmle/man/mle2.html" class="external-link">bbmle::mle2</a> object containing the maximum log likelihood functions for all parameters</p></dd>

<dt>$BIC</dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> BIC score</p></dd>

<dt>$confint</dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> confidence intervals for all parameters</p></dd>

<dt>$profile</dt>
<dd><p><a href="https://rdrr.io/r/stats/profile.html" class="external-link">stats::profile</a> the log likelihood profiles</p></dd>

<dt>$bootstrap</dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> bootstrap results</p></dd>


</dl><p>The output should be accessed using the function <a href="get_RLum.html">get_RLum</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Parameters</strong></p>
<p>This model has four parameters:</p><table class="table table"><tr><td><code>gamma</code>:</td><td>minimum dose on the log scale</td></tr><tr><td><code>mu</code>:</td><td>mean of the non-truncated normal distribution</td></tr><tr><td><code>sigma</code>:</td><td>spread in ages above the minimum</td></tr><tr><td><code>p0</code>:</td><td>proportion of grains at gamma</td></tr></table><p>If <code>par=3</code> (default) the 3-parameter minimum age model is applied,
where <code>gamma=mu</code>. For <code>par=4</code> the 4-parameter model is applied instead.</p>
<p><strong>(Un-)logged model</strong></p>
<p>In the original version of the minimum dose model, the basic data are the natural
logarithms of the De estimates and relative standard errors of the De
estimates. The value for <code>sigmab</code> must be provided as a ratio
(e.g, 0.2 for 20 %). This model will be applied if <code>log = TRUE</code>.</p>
<p>If <code>log=FALSE</code>, the modified un-logged model will be applied instead. This
has essentially the same form as the original version.  <code>gamma</code> and
<code>sigma</code> are in Gy and <code>gamma</code> becomes the minimum true dose in the
population.
<strong>Note</strong> that the un-logged model requires <code>sigmab</code> to be in the same
absolute unit as the provided De values (seconds or Gray).</p>
<p>While the original (logged) version of the minimum dose
model may be appropriate for most samples (i.e. De distributions), the
modified (un-logged) version is specially designed for modern-age and young
samples containing negative, zero or near-zero De estimates (Arnold et al.
2009, p. 323).</p>
<p><strong>Initial values &amp; boundaries</strong></p>
<p>The log likelihood calculations use the <a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a> function for box-constrained
optimisation using PORT routines.  Accordingly, initial values for the four
parameters can be specified via <code>init.values</code>. If no values are
provided for <code>init.values</code>, reasonable starting values are estimated
from the input data.  If the final estimates of <em>gamma</em>, <em>mu</em>,
<em>sigma</em> and <em>p0</em> are totally off target, consider providing custom
starting values via <code>init.values</code>.
In contrast to previous versions of this function, the boundaries for the
individual model parameters are no longer required to be explicitly specified.
If you want to override the default boundary values use arguments
<code>gamma.lower</code>, <code>gamma.upper</code>, <code>sigma.lower</code>, <code>sigma.upper</code>, <code>p0.lower</code>, <code>p0.upper</code>,
<code>mu.lower</code> and <code>mu.upper</code>.</p>
<p><strong>Bootstrap</strong></p>
<p>When <code>bootstrap=TRUE</code> the function applies the bootstrapping method as
described in Wallinga &amp; Cunningham (2012). By default, the minimum age model
produces 1000 first level and 3000 second level bootstrap replicates
(actually, the number of second level bootstrap replicates is three times
the number of first level replicates unless specified otherwise).  The
uncertainty on <code>sigmab</code> is 0.04 by default. These values can be changed by
using the arguments <code>bs.M</code> (first level replicates), <code>bs.N</code>
(second level replicates) and <code>sigmab.sd</code> (error on <code>sigmab</code>). With
<code>bs.h</code> the bandwidth of the kernel density estimate can be specified.
By default, <code>h</code> is calculated as</p>
<p>$$h = (2*\sigma_{DE})/\sqrt{n}$$</p>
<p><strong>Multicore support</strong></p>
<p>This function supports parallel computing and can be activated by <code>multicore=TRUE</code>.
By default, the number of available logical CPU cores is determined
automatically, but can be changed with <code>cores</code>. The multicore support
is only available when <code>bootstrap=TRUE</code> and spawns <code>n</code> R instances
for each core to get MAM estimates for each of the N and M bootstrap
replicates. Note that this option is highly experimental and may or may not
work for your machine. The performance gain increases for larger number
of bootstrap replicates. However, note that with each additional core (and
hence R instance) the memory usage can significantly increase and depending
on the number of bootstrap replicates. When insufficient memory is available,
there will be a massive performance hit.</p>
<p><strong>Likelihood profiles</strong></p>
<p>The likelihood profiles are generated and plotted by the <code>bbmle</code> package.
The profile likelihood plots look different to ordinary profile likelihood as</p>
<p>"<code>[...]</code> the plot method for likelihood profiles displays the square root of
the deviance difference (twice the difference in negative log-likelihood from
the best fit), so it will be V-shaped for cases where the quadratic approximation
works well <code>[...]</code>." (Bolker 2016).</p>
<p>For more details on the profile likelihood
calculations and plots please see the vignettes of the <code>bbmle</code> package
(also available here: <a href="https://CRAN.R-project.org/package=bbmle" class="external-link">https://CRAN.R-project.org/package=bbmle</a>).</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The default starting values for <em>gamma</em>, <em>mu</em>, <em>sigma</em>
and <em>p0</em> may only be appropriate for some De data sets and may need to
be changed for other data. This is especially true when the un-logged
version is applied. <br>
Also note that all R warning messages are suppressed
when running this function. If the results seem odd consider re-running the
model with <code>debug=TRUE</code> which provides extended console output and
forwards all internal warning messages.</p>
    </div>
    <div class="section level2">
    <h2 id="function-version">Function version<a class="anchor" aria-label="anchor" href="#function-version"></a></h2>
    <p>0.4.4</p>
    </div>
    <div class="section level2">
    <h2 id="how-to-cite">How to cite<a class="anchor" aria-label="anchor" href="#how-to-cite"></a></h2>
    <p>Burow, C., 2025. calc_MinDose(): Apply the (un-)logged minimum age model (MAM) after Galbraith et al. (1999) to a given De distribution. Function version 0.4.4. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., Colombo, M., Steinbuch, L., Boer, A.d., 2025. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 1.0.1. https://r-lum.github.io/Luminescence/</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Arnold, L.J., Roberts, R.G., Galbraith, R.F. &amp; DeLong, S.B.,
2009. A revised burial dose estimation procedure for optical dating of young
and modern-age sediments. Quaternary Geochronology 4, 306-325.</p>
<p>Galbraith, R.F. &amp; Laslett, G.M., 1993. Statistical models for mixed fission
track ages. Nuclear Tracks Radiation Measurements 4, 459-470.</p>
<p>Galbraith, R.F., Roberts, R.G., Laslett, G.M., Yoshida, H. &amp; Olley, J.M.,
1999. Optical dating of single grains of quartz from Jinmium rock shelter,
northern Australia. Part I: experimental design and statistical models.
Archaeometry 41, 339-364.</p>
<p>Galbraith, R.F., 2005. Statistics for
Fission Track Analysis, Chapman &amp; Hall/CRC, Boca Raton.</p>
<p>Galbraith, R.F. &amp; Roberts, R.G., 2012. Statistical aspects of equivalent dose and error
calculation and display in OSL dating: An overview and some recommendations.
Quaternary Geochronology 11, 1-27.</p>
<p>Olley, J.M., Roberts, R.G., Yoshida, H., Bowler, J.M., 2006. Single-grain optical dating of grave-infill
associated with human burials at Lake Mungo, Australia. Quaternary Science
Reviews 25, 2469-2474.</p>
<p><strong>Further reading</strong></p>
<p>Arnold, L.J. &amp; Roberts, R.G., 2009. Stochastic modelling of multi-grain equivalent dose
(De) distributions: Implications for OSL dating of sediment mixtures.
Quaternary Geochronology 4, 204-230.</p>
<p>Bolker, B., 2016. Maximum likelihood estimation analysis with the bbmle package.
In: Bolker, B., R Development Core Team, 2016. bbmle: Tools for General Maximum Likelihood Estimation.
R package version 1.0.18. <a href="https://CRAN.R-project.org/package=bbmle" class="external-link">https://CRAN.R-project.org/package=bbmle</a></p>
<p>Bailey, R.M. &amp; Arnold, L.J., 2006. Statistical modelling of single grain quartz De distributions and an
assessment of procedures for estimating burial dose. Quaternary Science
Reviews 25, 2475-2502.</p>
<p>Cunningham, A.C. &amp; Wallinga, J., 2012. Realizing the potential of fluvial archives using robust OSL chronologies.
Quaternary Geochronology 12, 98-106.</p>
<p>Rodnight, H., Duller, G.A.T., Wintle, A.G. &amp; Tooth, S., 2006. Assessing the reproducibility and accuracy
of optical dating of fluvial deposits.  Quaternary Geochronology 1, 109-120.</p>
<p>Rodnight, H., 2008. How many equivalent dose values are needed to
obtain a reproducible distribution?. Ancient TL 26, 3-10.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="calc_CentralDose.html">calc_CentralDose</a>, <a href="calc_CommonDose.html">calc_CommonDose</a>, <a href="calc_FiniteMixture.html">calc_FiniteMixture</a>,
<a href="calc_FuchsLang2001.html">calc_FuchsLang2001</a>, <a href="calc_MaxDose.html">calc_MaxDose</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Christoph Burow, University of Cologne (Germany) <br>
Based on a rewritten S script of Rex Galbraith, 2010 <br>
The bootstrap approach is based on a rewritten MATLAB script of Alastair Cunningham. <br>
Alastair Cunningham is thanked for his help in implementing and cross-checking the code.
, RLum Developer Team</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.DeValues</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (1) Apply the minimum age model with minimum required parameters.</span></span></span>
<span class="r-in"><span><span class="co"># By default, this will apply the un-logged 3-parameter MAM.</span></span></span>
<span class="r-in"><span><span class="fu">calc_MinDose</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span><span class="op">$</span><span class="va">CA1</span>, sigmab <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------- meta data -----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n par sigmab logged      Lmax      BIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  62   3    0.1   TRUE -43.57969 106.4405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- final parameter estimates ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  gamma sigma   p0 mu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  34.32  2.07 0.01  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------ confidence intervals -----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       2.5 % 97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma 29.37  39.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma  1.77   2.56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p0       NA   0.11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------ De (asymmetric error) -----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     De lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  34.32 29.38 39.38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------ De (symmetric error) -----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     De error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  34.32  2.55</span>
<span class="r-plt img"><img src="calc_MinDose-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># (2) Re-run the model, but save results to a variable and turn</span></span></span>
<span class="r-in"><span><span class="co"># plotting of the log-likelihood profiles off.</span></span></span>
<span class="r-in"><span><span class="va">mam</span> <span class="op">&lt;-</span> <span class="fu">calc_MinDose</span><span class="op">(</span></span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="va">ExampleData.DeValues</span><span class="op">$</span><span class="va">CA1</span>,</span></span>
<span class="r-in"><span> sigmab <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span> plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show structure of the RLum.Results object</span></span></span>
<span class="r-in"><span><span class="va">mam</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show summary table that contains the most relevant results</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">mam</span>, <span class="st">"summary"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the log likelihood profiles retroactively, because before</span></span></span>
<span class="r-in"><span><span class="co"># we set plot = FALSE</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_RLum.html">plot_RLum</a></span><span class="op">(</span><span class="va">mam</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the dose distribution in an abanico plot and draw a line</span></span></span>
<span class="r-in"><span><span class="co"># at the minimum dose estimate</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_AbanicoPlot.html">plot_AbanicoPlot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span><span class="op">$</span><span class="va">CA1</span>,</span></span>
<span class="r-in"><span>                 main <span class="op">=</span> <span class="st">"3-parameter Minimum Age Model"</span>,</span></span>
<span class="r-in"><span>                 line <span class="op">=</span> <span class="va">mam</span>,polygon.col <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>                 hist <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                 rug <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                 summary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"mean"</span>, <span class="st">"mean.weighted"</span>, <span class="st">"median"</span>, <span class="st">"in.ci"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 centrality <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">de</span>,</span></span>
<span class="r-in"><span>                 line.col <span class="op">=</span> <span class="st">"red"</span>,</span></span>
<span class="r-in"><span>                 grid.col <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>                 line.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">de</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\U00B1"</span>,</span></span>
<span class="r-in"><span>                                     <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">de_err</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">" Gy"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 bw <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                 ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25</span>, <span class="fl">18</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 summary.pos <span class="op">=</span> <span class="st">"topleft"</span>,</span></span>
<span class="r-in"><span>                 mtext <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="st">"Parameters: "</span> <span class="op">~</span></span></span>
<span class="r-in"><span>                                  <span class="va">sigma</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">==</span> <span class="fu">.</span><span class="op">(</span><span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">mam</span>, <span class="st">"args"</span><span class="op">)</span><span class="op">$</span><span class="va">sigmab</span><span class="op">)</span> <span class="op">~</span> <span class="st">", "</span> <span class="op">~</span></span></span>
<span class="r-in"><span>                                  <span class="va">gamma</span> <span class="op">==</span> <span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">de</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="st">", "</span> <span class="op">~</span></span></span>
<span class="r-in"><span>                                  <span class="va">sigma</span> <span class="op">==</span> <span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">sig</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="st">", "</span> <span class="op">~</span></span></span>
<span class="r-in"><span>                                  <span class="va">rho</span> <span class="op">==</span> <span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">p0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3) Run the minimum age model with bootstrap</span></span></span>
<span class="r-in"><span><span class="co"># NOTE: Bootstrapping is computationally intensive</span></span></span>
<span class="r-in"><span><span class="co"># (3.1) run the minimum age model with default values for bootstrapping</span></span></span>
<span class="r-in"><span><span class="fu">calc_MinDose</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span><span class="op">$</span><span class="va">CA1</span>,</span></span>
<span class="r-in"><span>             sigmab <span class="op">=</span> <span class="fl">0.15</span>,</span></span>
<span class="r-in"><span>             bootstrap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3.2) Bootstrap control parameters</span></span></span>
<span class="r-in"><span><span class="va">mam</span> <span class="op">&lt;-</span> <span class="fu">calc_MinDose</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ExampleData.DeValues</span><span class="op">$</span><span class="va">CA1</span>,</span></span>
<span class="r-in"><span>                    sigmab <span class="op">=</span> <span class="fl">0.15</span>,</span></span>
<span class="r-in"><span>                    bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                    bs.M <span class="op">=</span> <span class="fl">300</span>,</span></span>
<span class="r-in"><span>                    bs.N <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>                    bs.h <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                    sigmab.sd <span class="op">=</span> <span class="fl">0.06</span>,</span></span>
<span class="r-in"><span>                    plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_RLum.html">plot_RLum</a></span><span class="op">(</span><span class="va">mam</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># save bootstrap results in a separate variable</span></span></span>
<span class="r-in"><span><span class="va">bs</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_RLum.html">get_RLum</a></span><span class="op">(</span><span class="va">mam</span>, <span class="st">"bootstrap"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># show structure of the bootstrap results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">bs</span>, max.level <span class="op">=</span> <span class="fl">2</span>, give.attr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># print summary of minimum dose and likelihood pairs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bs</span><span class="op">$</span><span class="va">pairs</span><span class="op">$</span><span class="va">gamma</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show polynomial fits of the bootstrap pairs</span></span></span>
<span class="r-in"><span><span class="va">bs</span><span class="op">$</span><span class="va">poly.fits</span><span class="op">$</span><span class="va">poly.three</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot various statistics of the fit using the generic plot() function</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bs</span><span class="op">$</span><span class="va">poly.fits</span><span class="op">$</span><span class="va">poly.three</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show the fitted values of the polynomials</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bs</span><span class="op">$</span><span class="va">poly.fits</span><span class="op">$</span><span class="va">poly.three</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo, Luc Steinbuch, Anna-Maartje de Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

