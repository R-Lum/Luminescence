<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate the Average Dose and the dose rate dispersion — calc_AverageDose • Luminescence</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate the Average Dose and the dose rate dispersion — calc_AverageDose"><meta name="description" content="This functions calculates the Average Dose and its extrinsic dispersion,
estimating the standard errors by bootstrapping based on the Average
Dose Model by Guerin et al., 2017.
sigma_m
The program requires the input of a known value of sigma_m,
which corresponds to the intrinsic overdispersion, as determined
by a dose recovery experiment. Then the dispersion in doses (sigma_d)
will be that over and above sigma_m (and individual uncertainties sigma_wi)."><meta property="og:description" content="This functions calculates the Average Dose and its extrinsic dispersion,
estimating the standard errors by bootstrapping based on the Average
Dose Model by Guerin et al., 2017.
sigma_m
The program requires the input of a known value of sigma_m,
which corresponds to the intrinsic overdispersion, as determined
by a dose recovery experiment. Then the dispersion in doses (sigma_d)
will be that over and above sigma_m (and individual uncertainties sigma_wi)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate the Average Dose and the dose rate dispersion</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/v1.1.1/R/calc_AverageDose.R" class="external-link"><code>R/calc_AverageDose.R</code></a></small>
      <div class="d-none name"><code>calc_AverageDose.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This functions calculates the Average Dose and its extrinsic dispersion,
estimating the standard errors by bootstrapping based on the Average
Dose Model by Guerin et al., 2017.</p>
<p><strong><code>sigma_m</code></strong><br></p>
<p>The program requires the input of a known value of <code>sigma_m</code>,
which corresponds to the intrinsic overdispersion, as determined
by a dose recovery experiment. Then the dispersion in doses (<code>sigma_d</code>)
will be that over and above <code>sigma_m</code> (and individual uncertainties <code>sigma_wi</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_AverageDose</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">sigma_m</span>,</span>
<span>  Nb_BE <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><a href="RLum.Results-class.html">RLum.Results</a> or <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<strong>required</strong>):
for <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a>: two columns with <code>De</code> <code>(data[,1])</code> and <code>De error</code> <code>(values[,2])</code></p></dd>


<dt id="arg-sigma-m">sigma_m<a class="anchor" aria-label="anchor" href="#arg-sigma-m"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>):
the overdispersion resulting from a dose recovery
experiment, i.e. when all grains have  received the same dose. Indeed in such a case, any
overdispersion (i.e. dispersion on top of analytical uncertainties) is, by definition, an
unrecognised measurement uncertainty.</p></dd>


<dt id="arg-nb-be">Nb_BE<a class="anchor" aria-label="anchor" href="#arg-nb-be"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
sample size used for the bootstrapping</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
exclude NA values from the data set prior to any further operation.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disable the plot output.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disable output to the terminal.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments that can be passed to <a href="https://rdrr.io/r/graphics/hist.html" class="external-link">graphics::hist</a>. As three plots
are returned all arguments need to be provided as <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a>,
e.g., <code>main = list("Plot 1", "Plot 2", "Plot 3")</code>.
Note: not all arguments of <code>hist</code> are
supported, but the output of <code>hist</code> is returned and can be used of own plots. <br></p>
<p>Further supported arguments: <code>mtext</code> (<a href="https://rdrr.io/r/base/character.html" class="external-link">character</a>), <code>rug</code> (<code>TRUE/FALSE</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns numerical output and an (<em>optional</em>) plot.</p>
<p>———————————–<br><code>[ NUMERICAL OUTPUT ]</code> <br>
———————————–<br><strong><code>RLum.Results</code></strong>-object<br></p>
<p><strong>slot:</strong> <strong><code>@data</code></strong> <br></p>
<p><code>[.. $summary : data.frame]</code><br></p>
<table class="table table"><tr><td><strong>Column</strong></td><td><strong>Type</strong></td><td><strong>Description</strong></td></tr><tr><td>AVERAGE_DOSE</td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>the obtained average dose</td></tr><tr><td>AVERAGE_DOSE.SE</td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>the average dose error</td></tr><tr><td>SIGMA_D</td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>sigma</td></tr><tr><td>SIGMA_D.SE</td><td><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></td><td>standard error of the sigma</td></tr><tr><td>IC_AVERAGE_DOSE.LEVEL</td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>confidence level average dose</td></tr><tr><td>IC_AVERAGE_DOSE.LOWER</td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>lower quantile of average dose</td></tr><tr><td>IC_AVERAGE_DOSE.UPPER</td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>upper quantile of average dose</td></tr><tr><td>IC_SIGMA_D.LEVEL</td><td><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></td><td>confidence level sigma</td></tr><tr><td>IC_SIGMA_D.LOWER</td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>lower sigma quantile</td></tr><tr><td>IC_SIGMA_D.UPPER</td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>upper sigma quantile</td></tr><tr><td>L_MAX</td><td><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></td><td>maximum likelihood value</td></tr></table><p><code>[.. $dstar : matrix]</code> <br></p>
<p>Matrix with bootstrap values<br></p>
<p><code>[.. $hist : list]</code><br></p>
<p>Object as produced by the function histogram</p>
<p>————————<br><code>[ PLOT OUTPUT ]</code><br>
————————<br></p>
<p>The function returns two different plot panels.</p>
<p>(1) An abanico plot with the dose values</p>
<p>(2) A histogram panel comprising 3 histograms with the equivalent dose and the bootstrapped average
dose and the sigma values.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function has beta status!</p>
    </div>
    <div class="section level2">
    <h2 id="function-version">Function version<a class="anchor" aria-label="anchor" href="#function-version"></a></h2>
    <p>0.1.6</p>
    </div>
    <div class="section level2">
    <h2 id="how-to-cite">How to cite<a class="anchor" aria-label="anchor" href="#how-to-cite"></a></h2>
    <p>Christophe, C., Philippe, A., Kreutzer, S., 2025. calc_AverageDose(): Calculate the Average Dose and the dose rate dispersion. Function version 0.1.6. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., Colombo, M., Steinbuch, L., Boer, A.d., 2025. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 1.1.1. https://r-lum.github.io/Luminescence/</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Guerin, G., Christophe, C., Philippe, A., Murray, A.S., Thomsen, K.J., Tribolo, C., Urbanova, P.,
Jain, M., Guibert, P., Mercier, N., Kreutzer, S., Lahaye, C., 2017. Absorbed dose, equivalent dose,
measured dose rates, and implications for OSL age estimates: Introducing the Average Dose Model.
Quaternary Geochronology 1-32. doi:10.1016/j.quageo.2017.04.002</p>
<p><strong>Further reading</strong><br></p>
<p>Efron, B., Tibshirani, R., 1986. Bootstrap Methods for Standard Errors, Confidence Intervals,
and Other Measures of Statistical Accuracy. Statistical Science 1, 54-75.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a>, <a href="https://rdrr.io/r/graphics/hist.html" class="external-link">graphics::hist</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Claire Christophe, IRAMAT-CRP2A, Université de Nantes (France),
Anne Philippe, Université de Nantes, (France),
Guillaume Guérin, IRAMAT-CRP2A, Université Bordeaux Montaigne, (France),
Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)
, RLum Developer Team</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Example 01 using package example data</span></span></span>
<span class="r-in"><span><span class="co">##load example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.DeValues</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##calculate Average dose</span></span></span>
<span class="r-in"><span><span class="co">##(use only the first 56 values here)</span></span></span>
<span class="r-in"><span><span class="va">AD</span> <span class="op">&lt;-</span> <span class="fu">calc_AverageDose</span><span class="op">(</span><span class="va">ExampleData.DeValues</span><span class="op">$</span><span class="va">CA1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">56</span>,<span class="op">]</span>, sigma_m <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [calc_AverageDose()]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;&gt; Initialisation &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n:		 56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:		 65.79393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma_m:	 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma_d:	 0.2861594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;&gt; Calculation &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log likelihood:	 -19.251 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> confidence intervals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          IC_delta      IC_sigma_d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> level                        0.95          0.9500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CredibleIntervalInf         60.40          0.2077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CredibleIntervalSup         69.74          0.3860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;&gt; Results &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average dose:	  65.3597 	se(Aver. dose):	 2.4669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma_d:	  0.3092 	se(sigma_d):	 0.0476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------------------</span>
<span class="r-plt img"><img src="calc_AverageDose-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##plot De and set Average dose as central value</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_AbanicoPlot.html">plot_AbanicoPlot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="va">ExampleData.DeValues</span><span class="op">$</span><span class="va">CA1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">56</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span> z.0 <span class="op">=</span> <span class="va">AD</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">AVERAGE_DOSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="calc_AverageDose-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo, Luc Steinbuch, Anna-Maartje de Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

