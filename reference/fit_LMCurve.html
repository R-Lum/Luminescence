<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Non-linear Least Squares Fit for LM-OSL curves — fit_LMCurve • Luminescence</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Non-linear Least Squares Fit for LM-OSL curves — fit_LMCurve"><meta name="description" content="The function determines weighted non-linear least-squares estimates of the
component parameters of an LM-OSL curve (Bulur 1996) for a given number of
components and returns various component parameters. The fitting procedure
uses the Levenberg-Marquardt algorithm as implemented in function nlsLM
from package minpack.lm."><meta property="og:description" content="The function determines weighted non-linear least-squares estimates of the
component parameters of an LM-OSL curve (Bulur 1996) for a given number of
components and returns various component parameters. The fitting procedure
uses the Levenberg-Marquardt algorithm as implemented in function nlsLM
from package minpack.lm."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luminescence</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/Luminescence"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Non-linear Least Squares Fit for LM-OSL curves</h1>
      <small class="dont-index">Source: <a href="https://github.com/R-Lum/Luminescence/blob/v1.1.1/R/fit_LMCurve.R" class="external-link"><code>R/fit_LMCurve.R</code></a></small>
      <div class="d-none name"><code>fit_LMCurve.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function determines weighted non-linear least-squares estimates of the
component parameters of an LM-OSL curve (Bulur 1996) for a given number of
components and returns various component parameters. The fitting procedure
uses the Levenberg-Marquardt algorithm as implemented in function <code>nlsLM</code>
from package <code>minpack.lm</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_LMCurve</span><span class="op">(</span></span>
<span>  <span class="va">values</span>,</span>
<span>  <span class="va">values.bg</span>,</span>
<span>  n.components <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  <span class="va">start_values</span>,</span>
<span>  input.dataType <span class="op">=</span> <span class="st">"LM"</span>,</span>
<span>  sample_code <span class="op">=</span> <span class="st">""</span>,</span>
<span>  sample_ID <span class="op">=</span> <span class="st">""</span>,</span>
<span>  LED.power <span class="op">=</span> <span class="fl">36</span>,</span>
<span>  LED.wavelength <span class="op">=</span> <span class="fl">470</span>,</span>
<span>  fit.trace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fit.calcError <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  bg.subtraction <span class="op">=</span> <span class="st">"polynomial"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot.BG <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot.residuals <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot.contribution <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legend.pos <span class="op">=</span> <span class="st">"topright"</span>,</span>
<span>  method_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-values">values<a class="anchor" aria-label="anchor" href="#arg-values"></a></dt>
<dd><p><a href="RLum.Data.Curve-class.html">RLum.Data.Curve</a> or <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<strong>required</strong>):
x,y data of measured values (time and counts).</p></dd>


<dt id="arg-values-bg">values.bg<a class="anchor" aria-label="anchor" href="#arg-values-bg"></a></dt>
<dd><p><a href="RLum.Data.Curve-class.html">RLum.Data.Curve</a> or <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<em>optional</em>):
x,y data of measured values (time and counts) for background subtraction.</p></dd>


<dt id="arg-n-components">n.components<a class="anchor" aria-label="anchor" href="#arg-n-components"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (<em>with default</em>):
fixed number of components that are to be recognised during fitting
(min = 1, max = 7).</p></dd>


<dt id="arg-start-values">start_values<a class="anchor" aria-label="anchor" href="#arg-start-values"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (<em>optional</em>):
start parameters for <code>lm</code> and <code>xm</code> data for the fit. If no start values are given,
an automatic start value estimation is attempted (see details).</p></dd>


<dt id="arg-input-datatype">input.dataType<a class="anchor" aria-label="anchor" href="#arg-input-datatype"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
alter the plot output depending on the input data: <code>"LM"</code> or <code>"pLM"</code> (pseudo-LM).
See: <a href="convert_CW2pLM.html">convert_CW2pLM</a></p></dd>


<dt id="arg-sample-code">sample_code<a class="anchor" aria-label="anchor" href="#arg-sample-code"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>optional</em>):
sample code used for the plot and the optional output table (mtext).</p></dd>


<dt id="arg-sample-id">sample_ID<a class="anchor" aria-label="anchor" href="#arg-sample-id"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>optional</em>):
additional identifier used as column header for the table output.</p></dd>


<dt id="arg-led-power">LED.power<a class="anchor" aria-label="anchor" href="#arg-led-power"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
LED power (max.) used for intensity ramping in mW/cm².
<strong>Note:</strong> This value is used for the calculation of the absolute
photoionisation cross section.</p></dd>


<dt id="arg-led-wavelength">LED.wavelength<a class="anchor" aria-label="anchor" href="#arg-led-wavelength"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<em>with default</em>):
LED wavelength in nm used for stimulation.
<strong>Note:</strong> This value is used for the calculation of the absolute
photoionisation cross section.</p></dd>


<dt id="arg-fit-trace">fit.trace<a class="anchor" aria-label="anchor" href="#arg-fit-trace"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
traces the fitting process on the terminal.</p></dd>


<dt id="arg-fit-calcerror">fit.calcError<a class="anchor" aria-label="anchor" href="#arg-fit-calcerror"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
calculate 1-sigma error range of components using <a href="https://rdrr.io/r/stats/confint.html" class="external-link">stats::confint</a>.</p></dd>


<dt id="arg-bg-subtraction">bg.subtraction<a class="anchor" aria-label="anchor" href="#arg-bg-subtraction"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
specifies method for background subtraction (one of <code>"polynomial"</code>,
<code>"linear"</code>, <code>"channel"</code>, or <code>"none"</code>, see Details). Only considered if
<code>values.bg</code> is specified.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disable output to the terminal.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disable the plot output.</p></dd>


<dt id="arg-plot-bg">plot.BG<a class="anchor" aria-label="anchor" href="#arg-plot-bg"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disable a plot of the background values with the fit used for the
background subtraction.</p></dd>


<dt id="arg-plot-residuals">plot.residuals<a class="anchor" aria-label="anchor" href="#arg-plot-residuals"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disable the plot of the residuals.</p></dd>


<dt id="arg-plot-contribution">plot.contribution<a class="anchor" aria-label="anchor" href="#arg-plot-contribution"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disable the plot of the component contribution.</p></dd>


<dt id="arg-legend">legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (<em>with default</em>):
enable/disable the plot legend.</p></dd>


<dt id="arg-legend-pos">legend.pos<a class="anchor" aria-label="anchor" href="#arg-legend-pos"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<em>with default</em>):
keyword specifying the position of the legend.</p></dd>


<dt id="arg-method-control">method_control<a class="anchor" aria-label="anchor" href="#arg-method-control"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> (<em>optional</em>): options to control the output
produced. Currently only the 'export.comp.contrib.matrix' (logical) option
is supported, to enable/disable export of the component contribution
matrix.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments that may be passed to the plot output, e.g.
<code>main</code>, <code>xlab</code>, <code>xlab</code>, <code>xlim</code>, <code>ylim</code>, <code>cex</code>, <code>log</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Various types of plots are returned. For details see above. Furthermore an
<code>RLum.Results</code> object is returned with the following structure:</p>
<p><strong><code>@data:</code></strong></p>
<p><code>.. $data</code> : <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> with fitting results<br><code>.. $fit</code> : nls (<a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a> object)<br><code>.. $component_matrix</code> : <a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a> with numerical xy-values of the single fitted components with the resolution of the input data
<code>.. $component.contribution.matrix</code> : <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> component distribution matrix
(produced only if <code>method_control$export.comp.contrib.matrix = TRUE</code>)</p>
<p><strong><code>info:</code></strong></p>
<p><code>.. $call</code> : <a href="https://rdrr.io/r/base/call.html" class="external-link">call</a> the original function call</p>
<p>Matrix structure for the distribution matrix:</p>
<p>Column 1 and 2: time and <code>rev(time)</code> values<br>
Additional columns are used for the components, two for each component,
containing I0 and n0. The last columns <code>cont.</code> provide information on
the relative component contribution for each time interval including the row
sum for this values.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Fitting function</strong></p>
<p>The function for the fitting has the general
form:</p>
<p>$$y = (exp(0.5)*Im_1*x/xm_1)*exp(-x^2/(2*xm_1^2)) + ,\ldots, + exp(0.5)*Im_i*x/xm_i)*exp(-x^2/(2*xm_i^2))$$</p>
<p>where \(1 &lt; i &lt; 8\)</p>
<p>This function and the equations for the conversion to b (detrapping probability)
and n0 (proportional to initially trapped charge) have been taken from Kitis
et al. (2008):</p>
<p>$$xm_i=\sqrt{max(t)/b_i}$$
$$Im_i=exp(-0.5)n0/xm_i$$</p>
<p><strong>Background subtraction</strong></p>
<p>When a background signal is provided with the <code>values.bg</code> argument, the
user can choose among three methods for background subtraction by setting
the <code>bg.subtraction</code> argument to one of these:</p><ul><li><p><code>"polynomial"</code> (default): a polynomial function is fitted using <a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a>
and the resulting function is used for background subtraction:
$$y = a*x^4 + b*x^3 + c*x^2 + d*x + e$$</p></li>
<li><p><code>"linear"</code>: a linear function is fitted using <a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a> and the resulting
function is used for background subtraction:
$$y = a*x + b$$</p></li>
<li><p><code>"channel"</code>: the measured background signal is subtracted channel-wise
from the measured signal.</p></li>
<li><p><code>"none"</code>: this disables background subtraction even if <code>values.bg</code> is
provided.</p></li>
</ul><p><strong>Start values</strong></p>
<p>The choice of the initial parameters for the <code>nls</code>-fitting is a crucial
point and the fitting procedure may mainly fail due to ill chosen start
parameters. Here, three options are provided:</p>
<p><strong>(a)</strong>
If <code>start_values</code> is not provided by the user, a cheap guess is made
by using the detrapping values found by Jain et al. (2003) for quartz for a
maximum of 7 components. Based on these values, the pseudo start parameters
<code>xm</code> and <code>Im</code> are recalculated for the given data set. In all cases, fitting
starts with the ultra-fast component and (depending on <code>n.components</code>)
steps through the following values. If no fit could be achieved, an error
plot (for <code>plot = TRUE</code>) with the pseudo curve (based on the
pseudo start parameters) is provided. This may give the opportunity to
identify appropriate start parameters visually.</p>
<p><strong>(b)</strong>
If start values are provided, the function works like a simple <a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a>
fitting approach.</p>
<p><strong>Goodness of fit</strong></p>
<p>The goodness of the fit is given by a pseudo-R² value (pseudo coefficient of
determination). According to Lave (1970), the value is calculated as:</p>
<p>$$pseudoR^2 = 1 - RSS/TSS$$</p>
<p>where \(RSS = Residual~Sum~of~Squares\)
and \(TSS = Total~Sum~of~Squares\)</p>
<p><strong>Error of fitted component parameters</strong></p>
<p>The 1-sigma error for the components is calculated using
the function <a href="https://rdrr.io/r/stats/confint.html" class="external-link">stats::confint</a>. Due to considerable calculation time, this
option is disabled by default. In addition, the error for the components
can be estimated by using internal R functions like <a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a>. See the
<a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a> help page for more information.</p>
<p><em>For more details on the nonlinear regression in R, see Ritz &amp; Streibig (2008).</em></p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The pseudo-R² may not be the best parameter to describe the goodness
of the fit. The trade off between the <code>n.components</code> and the pseudo-R²
value currently remains unconsidered.</p>
<p>The function <strong>does not</strong> ensure that the fitting procedure has reached a
global minimum rather than a local minimum! In any case of doubt, the use of
manual start values is highly recommended.</p>
    </div>
    <div class="section level2">
    <h2 id="function-version">Function version<a class="anchor" aria-label="anchor" href="#function-version"></a></h2>
    <p>0.3.6</p>
    </div>
    <div class="section level2">
    <h2 id="how-to-cite">How to cite<a class="anchor" aria-label="anchor" href="#how-to-cite"></a></h2>
    <p>Kreutzer, S., 2025. fit_LMCurve(): Non-linear Least Squares Fit for LM-OSL curves. Function version 0.3.6. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., Galharret, J., Colombo, M., Steinbuch, L., Boer, A.d., 2025. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 1.1.1. https://r-lum.github.io/Luminescence/</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bulur, E., 1996. An Alternative Technique For Optically
Stimulated Luminescence (OSL) Experiment. Radiation Measurements, 26, 5,
701-709.</p>
<p>Jain, M., Murray, A.S., Boetter-Jensen, L., 2003. Characterisation of
blue-light stimulated luminescence components in different quartz samples:
implications for dose measurement. Radiation Measurements, 37 (4-5),
441-449.</p>
<p>Kitis, G. &amp; Pagonis, V., 2008. Computerized curve deconvolution analysis for
LM-OSL. Radiation Measurements, 43, 737-741.</p>
<p>Lave, C.A.T., 1970. The Demand for Urban Mass Transportation. The Review of
Economics and Statistics, 52 (3), 320-323.</p>
<p>Ritz, C. &amp; Streibig, J.C., 2008. Nonlinear Regression with R. R. Gentleman,
K. Hornik, &amp; G. Parmigiani, eds., Springer, p. 150.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="fit_CWCurve.html">fit_CWCurve</a>, <a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a>, <a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a>, <a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">minpack.lm::nlsLM</a>, <a href="get_RLum.html">get_RLum</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)
, RLum Developer Team</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(1) fit LM data without background subtraction</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.FittingLM</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fit_LMCurve</span><span class="op">(</span>values <span class="op">=</span> <span class="va">values.curve</span>, n.components <span class="op">=</span> <span class="fl">3</span>, log <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [fit_LMCurve()]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting was done using a 3-component function:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       xm.1       xm.2       xm.3       Im.1       Im.2       Im.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   56.18245 1449.72375 7878.17948  202.76713  367.30183  639.20939 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (equation used for fitting according to Kitis &amp; Pagonis, 2008)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (1) Corresponding values according to the equation in Bulur, 1996 for b and n0:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b1 = 1.267239e+00 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n01 = 1.878216e+04 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b2 = 1.903222e-03 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n02 = 8.779213e+05 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b3 = 6.444782e-05 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n03 = 8.302641e+06 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cs from component.1 = 1.488e-17 cm^2	 &gt;&gt; relative:  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cs from component.2 = 2.234e-20 cm^2	 &gt;&gt; relative:  0.0015 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cs from component.3 = 7.566e-22 cm^2	 &gt;&gt; relative:  1e-04 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (stimulation intensity value used for calculation:  8.517725e+16  1/s 1/cm^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (errors quoted as 1-sigma uncertainties)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pseudo-R^2 = 0.9557 </span>
<span class="r-plt img"><img src="fit_LMCurve-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(2) fit LM data with background subtraction and export as JPEG</span></span></span>
<span class="r-in"><span><span class="co">## -alter file path for your preferred system</span></span></span>
<span class="r-in"><span><span class="co">##jpeg(file = "~/Desktop/Fit_Output\%03d.jpg", quality = 100,</span></span></span>
<span class="r-in"><span><span class="co">## height = 3000, width = 3000, res = 300)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.FittingLM</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fit_LMCurve</span><span class="op">(</span>values <span class="op">=</span> <span class="va">values.curve</span>, values.bg <span class="op">=</span> <span class="va">values.curveBG</span>,</span></span>
<span class="r-in"><span>            n.components <span class="op">=</span> <span class="fl">2</span>, log <span class="op">=</span> <span class="st">"x"</span>, plot.BG <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_LMCurve-2.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [fit_LMCurve()] &gt;&gt; Background subtracted (method = 'polynomial')</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [fit_LMCurve()]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting was done using a 2-component function:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       xm.1       xm.2       Im.1       Im.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   53.32213 1587.57212  176.74173  406.89921 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (equation used for fitting according to Kitis &amp; Pagonis, 2008)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (1) Corresponding values according to the equation in Bulur, 1996 for b and n0:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b1 = 1.406841e+00 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n01 = 1.553795e+04 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b2 = 1.587059e-03 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n02 = 1.065044e+06 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cs from component.1 = 1.652e-17 cm^2	 &gt;&gt; relative:  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cs from component.2 = 1.863e-20 cm^2	 &gt;&gt; relative:  0.0011 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (stimulation intensity value used for calculation:  8.517725e+16  1/s 1/cm^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (errors quoted as 1-sigma uncertainties)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pseudo-R^2 = 0.9417 </span>
<span class="r-plt img"><img src="fit_LMCurve-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">##dev.off()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##(3) fit LM data with manual start parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData.FittingLM</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fit_LMCurve</span><span class="op">(</span>values <span class="op">=</span> <span class="va">values.curve</span>,</span></span>
<span class="r-in"><span>            values.bg <span class="op">=</span> <span class="va">values.curveBG</span>,</span></span>
<span class="r-in"><span>            n.components <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>            log <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>            start_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Im <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">170</span>,<span class="fl">25</span>,<span class="fl">400</span><span class="op">)</span>, xm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">56</span>,<span class="fl">200</span>,<span class="fl">1500</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [fit_LMCurve()] &gt;&gt; Background subtracted (method = 'polynomial')</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [fit_LMCurve()]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting was done using a 3-component function:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       xm.1       xm.2       xm.3       Im.1       Im.2       Im.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   49.00545  204.36331 1591.66339  169.43746   23.01060  405.46209 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (equation used for fitting according to Kitis &amp; Pagonis, 2008)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (1) Corresponding values according to the equation in Bulur, 1996 for b and n0:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b1 = 1.665602e+00 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n01 = 1.368992e+04 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b2 = 9.577543e-02 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n02 = 7.753149e+03 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b3 = 1.578911e-03 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n03 = 1.064017e+06 ± NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cs from component.1 = 1.955e-17 cm^2	 &gt;&gt; relative:  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cs from component.2 = 1.124e-18 cm^2	 &gt;&gt; relative:  0.0575 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cs from component.3 = 1.854e-20 cm^2	 &gt;&gt; relative:  9e-04 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (stimulation intensity value used for calculation:  8.517725e+16  1/s 1/cm^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (errors quoted as 1-sigma uncertainties)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pseudo-R^2 = 0.9437 </span>
<span class="r-plt img"><img src="fit_LMCurve-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Kreutzer, Christoph Burow, Michael Dietze, Margret C. Fuchs, Christoph Schmidt, Manfred Fischer, Johannes Friedrich, Norbert Mercier, Anne Philippe, Svenja Riedesel, Martin Autzen, Dirk Mittelstrass, Harrison J. Gray, Jean-Michel Galharret, Marco Colombo, Luc Steinbuch, Anna-Maartje de Boer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

